This section contains detailed info about Legato\textquotesingle{}s ready-\/built services available for commonly needed features. The Services \hyperlink{legatoServicesOverview}{Overview} page has high-\/level info.

This table lists Legato\textquotesingle{}s Services --- multi-\/app safe means arbitration is fully managed among apps so multiple apps can share the same resources.

\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{legatoServicesAirVantage}{Air\+Vantage} &Air\+Vantage server for communication and data &\PBS\centering  \\\cline{1-3}
\hyperlink{c_audio}{Audio} &Control audio features &\PBS\centering \\\cline{1-3}
\hyperlink{c_le_cellnet}{Cellular Network} &Register and manage modems &\PBS\centering  \\\cline{1-3}
\hyperlink{legatoServicesConfigTree}{Config Tree} &Target configuration database &\PBS\centering  \\\cline{1-3}
\hyperlink{c_le_data}{Data Connection} &Request data connection &\PBS\centering  \\\cline{1-3}
\hyperlink{c_gpio}{G\+P\+I\+O A\+P\+I} &Configure general purpose input/output &\PBS\centering \\\cline{1-3}
\hyperlink{c_limit}{Limit Definitions} &Limits for A\+P\+Is &\PBS\centering \\\cline{1-3}
\hyperlink{legatoServicesModem}{Modem} &modem services &\PBS\centering  \\\cline{1-3}
\hyperlink{legatoServicesPositioning}{Positioning} &posititioning services &\PBS\centering  \\\cline{1-3}
\hyperlink{c_pm}{Power Manager} &Device power management &\PBS\centering \\\cline{1-3}
\hyperlink{c_secStore}{Secure Storage} &Secure storage for sensitive data &\PBS\centering  \\\cline{1-3}
\hyperlink{legatoServicesSMS}{S\+M\+S} &S\+M\+S and S\+M\+S Inbox &\PBS\centering  \\\cline{1-3}
\hyperlink{legatoServicesSupervisor}{Supervisor} &Control framework and apps &\PBS\centering  \\\cline{1-3}
\hyperlink{legatoServicesUpdate}{Update} &update modem firmware and apps &\PBS\centering  \\\cline{1-3}
\hyperlink{c_le_voicecall}{Voice Call Service} &Voice communications &\PBS\centering  \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesOverview}{}\section{Overview}\label{legatoServicesOverview}
Legato\textquotesingle{}s Services A\+P\+Is are pre-\/built I\+P\+C interfaces designed to create and run multiple apps in different ways\+:
\begin{DoxyItemize}
\item O\+E\+M\textquotesingle{}s can create Legato apps to run on their specific hardware.
\item 3rd party software providers can create apps for different hardware.
\end{DoxyItemize}



Many Services A\+P\+Is provided are {\itshape multi-\/app} {\itshape safe\+:} 


\begin{DoxyItemize}
\item A\+P\+Is can be used by several apps.
\item arbitration fully managed among apps so multiple apps can share the same resources.
\end{DoxyItemize}

Other Services provide full-\/featured interface access to system and modem resources\+:


\begin{DoxyItemize}
\item thread safe functions like {\ttfamily get()can} be called from any app.
\item command and response functions like {\ttfamily startaction()} or {\ttfamily set()are} thread safe; a single app can call them, or they can manage their own resource arbitration between selected apps.
\end{DoxyItemize}

Legato also provides a simple interface definition language (I\+D\+L) similar to C. It helps define A\+P\+Is so they can be used in multiple, different programming languages. See \hyperlink{interfaceDefLang}{Interface Definition Language}.

\begin{DoxyWarning}{Warning}
Some Services shouldn\textquotesingle{}t be used together in the same app (e.\+g., if you use a muli-\/app safe service like Data Connection, you can\textquotesingle{}t also use the Modem Data Control service).
\end{DoxyWarning}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesAirVantage}{}\section{Air\+Vantage}\label{legatoServicesAirVantage}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{c_le_avc}{Air\+Vantage Connector} &Air\+Vantage server communication &\PBS\centering  \\\cline{1-3}
\hyperlink{c_le_avdata}{Air\+Vantage Data} &Air\+Vantage server data &\PBS\centering  \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_avc}{}\subsection{Air\+Vantage Connector}\label{c_le_avc}
\hyperlink{le__avc__interface_8h}{A\+P\+I Reference}





The Air\+Vantage connector service provides an A\+P\+I to communicate with the Air\+Vantage server.\hypertarget{c_le_avc_c_le_avc_update}{}\subsubsection{Firmware/\+Application Update}\label{c_le_avc_c_le_avc_update}
The A\+P\+I for firmware/application update is divided into two parts\+:
\begin{DoxyItemize}
\item Allow a control app to contact the server for pending updates. If available, can select to download or install the update. ~\newline

\item Allow an app to block an update from being installed. An app may need this if it\textquotesingle{}s performing a critical operation that can\textquotesingle{}t be interrupted (e.\+g., e\+Call). This is necessary as installing an update will cause the app to restart (either the app itself needs to restart or a firmware change causes the modem to reset).
\end{DoxyItemize}\hypertarget{c_le_avc_c_le_avc_update_control}{}\paragraph{Update Control}\label{c_le_avc_c_le_avc_update_control}
A control app can start a session with an Air\+Vantage server to determine if there is a pending update. This is done with \hyperlink{le__avc__interface_8h_aee17b1de43cf946b59a965e6077e7b03}{le\+\_\+avc\+\_\+\+Start\+Session()}. The current session can be stopped using \hyperlink{le__avc__interface_8h_a5b3e21858181bb972e982046bced1182}{le\+\_\+avc\+\_\+\+Stop\+Session()}. This cancels any query for pending update, or suspends a download in progress; however, it {\bfseries won\textquotesingle{}t stop} an install in progress.

The status of a pending update is sent to the control app using a notification. The control app can use \hyperlink{le__avc__interface_8h_ac5443791a6e4b8db75342f45fa2f91dc}{le\+\_\+avc\+\_\+\+Add\+Status\+Event\+Handler()} to register a handler function to receive this notification. The notification will be received after a session is started using \hyperlink{le__avc__interface_8h_aee17b1de43cf946b59a965e6077e7b03}{le\+\_\+avc\+\_\+\+Start\+Session()}. Sometimes, the modem firmware may decide to start a session with the Air\+Vantage server. In this case, the notification could also be received, even if the control app has not explicitly called \hyperlink{le__avc__interface_8h_aee17b1de43cf946b59a965e6077e7b03}{le\+\_\+avc\+\_\+\+Start\+Session()}.

There can only be one pending update. To query the type of update, use \hyperlink{le__avc__interface_8h_a1f085c5986e7c473ed70cff32320ce11}{le\+\_\+avc\+\_\+\+Get\+Update\+Type()}. If it\textquotesingle{}s an app update, then \hyperlink{le__avc__interface_8h_abf50df00e1df25c4eabfc6b3a004280a}{le\+\_\+avc\+\_\+\+Get\+App\+Update\+Name()} can be used to get the name of the app.

If a download is pending, then \hyperlink{le__avc__interface_8h_a3f7dea04dd1e9c456fe24a5eb98d2592}{le\+\_\+avc\+\_\+\+Accept\+Download()} can be used to allow the update to be downloaded. To defer the decision, \hyperlink{le__avc__interface_8h_a0c50c8ce89e21cbd9d0bfa431389b780}{le\+\_\+avc\+\_\+\+Defer\+Download()} can be used to defer the download for the specified number of minutes. After the defer time has elapsed, the pending download notification will be re-\/sent, to allow the control app to make a new decision, or again defer.

If an uninstall is pending, then \hyperlink{le__avc__interface_8h_aa5b34a29de899b0f333769cd86078e9e}{le\+\_\+avc\+\_\+\+Accept\+Uninstall()} can be used to allow the uninstall to proceed. To defer the decision, \hyperlink{le__avc__interface_8h_a4da465033b4438cdc75fdba894fd890f}{le\+\_\+avc\+\_\+\+Defer\+Uninstall()} can be used to defer the uninstall for the specified number of minutes. In case of an upgrade, the existing application will not be uninstalled after \hyperlink{le__avc__interface_8h_aa5b34a29de899b0f333769cd86078e9e}{le\+\_\+avc\+\_\+\+Accept\+Uninstall()} is called. \hyperlink{le__avc__interface_8h_aa5b34a29de899b0f333769cd86078e9e}{le\+\_\+avc\+\_\+\+Accept\+Uninstall()} is only used to signal the server to start downloading the new application. During an upgrade process the control app has to accept the uninstall of the existing version followed by accepting the download and install of the new version.

Once an update has been downloaded, a new notification will be received to indicate that an install is pending. The control app can then use \hyperlink{le__avc__interface_8h_ab3ff8076bb7b36ca58efc0ae240efedb}{le\+\_\+avc\+\_\+\+Accept\+Install()} to allow the install to proceed. Note that even if the control app calls \hyperlink{le__avc__interface_8h_ab3ff8076bb7b36ca58efc0ae240efedb}{le\+\_\+avc\+\_\+\+Accept\+Install()}, the install may still be blocked by an app using the \hyperlink{c_le_avc_c_le_avc_update_app}{Application Blocking} functions. To defer the decision, the control app can use \hyperlink{le__avc__interface_8h_a068f714a110bfa4cac179731a17798f3}{le\+\_\+avc\+\_\+\+Defer\+Install()} to defer the install for the specified number of minutes. After the defer time has elapsed, the pending install notification will be re-\/sent to allow the control app to make a new decision, or again defer.

If a control app doesn\textquotesingle{}t register for notifications using \hyperlink{le__avc__interface_8h_ac5443791a6e4b8db75342f45fa2f91dc}{le\+\_\+avc\+\_\+\+Add\+Status\+Event\+Handler()}, then any pending downloads and installs will happen automatically, subject to any restrictions imposed by app using the \hyperlink{c_le_avc_c_le_avc_update_app}{Application Blocking} functions. Only one control app will be allowed to register for notifications. Any subsequent attempts will be rejected. Also, only the control app registered for notifications will be allowed to use the other update control A\+P\+I functions.\hypertarget{c_le_avc_c_le_avc_update_app}{}\paragraph{Application Blocking}\label{c_le_avc_c_le_avc_update_app}
When an app is about to perform a critical operation, it can block the installation of an update with \hyperlink{le__avc__interface_8h_a4d298bc6d814481205c4db5d24812694}{le\+\_\+avc\+\_\+\+Block\+Install()}, and after it\textquotesingle{}s finished with the critical operation, it can unblock the install with \hyperlink{le__avc__interface_8h_af5b3dffdd29b7de3288ea1a88c0ecd4e}{le\+\_\+avc\+\_\+\+Unblock\+Install()}.

What constitutes a critical operation depends on the app. An e\+Call app might block installs for the duration that it runs. A data collection app that wakes up once an hour might block installs while it collects and stores and/or transmits a new data sample, and then unblock installs just before it goes to sleep again.

If an install can\textquotesingle{}t be applied because it\textquotesingle{}s blocked, another attempt to apply the install will be made at a later time.\hypertarget{c_le_avc_le_avcService_configdb}{}\subsubsection{Air\+Vantage service configuration tree}\label{c_le_avc_le_avcService_configdb}
The configuration database path for the modem\+Activity\+Timeout is\+: \begin{DoxyVerb}/
    apps/
        avcService/
                 modemActivityTimeout
\end{DoxyVerb}


After an Air\+Vantage session is started, if there\textquotesingle{}s no activity from the modem within the timer interval, then L\+E\+\_\+\+A\+V\+C\+\_\+\+N\+O\+\_\+\+U\+P\+D\+A\+T\+E state will be returned to the app. However, this modem activity timeout can be overridden by setting an integer value at /apps/avc\+Service/modem\+Activity\+Timeout. The modem activity timer is initialized only when the avc\+Service starts. If a valid entry $>$0 is found, then it will be used instead of the default value of 20 seconds. The following steps should be used to set the modem\+Activty\+Timeout.

\begin{DoxyVerb}config set /apps/avcService/modemActivityTimeout xx
app restart avcService
\end{DoxyVerb}


\begin{DoxyNote}{Note}
Everytime a new value is written to modem\+Activity\+Timeout, the avc\+Service needs to be restarted to read the new value.
\end{DoxyNote}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_avdata}{}\subsection{Air\+Vantage Data}\label{c_le_avdata}
\hyperlink{le__avdata__interface_8h}{A\+P\+I Reference}





This A\+P\+I provides a data service to allow apps to manage app-\/specific data on the Air\+Vantage server.

Data is setup as {\bfseries assets} --- a collection of fields that can be managed by the Air\+Vantage server.

An asset field is a single piece of information that can be managed by the Air Vantage server. There can be multiple fields in an asset.

A field can be\+:
\begin{DoxyItemize}
\item {\ttfamily variable} allows an app to set the value, and can be read from the A\+V server.
\item {\ttfamily setting} allows the A\+V server to set the value, and can be read by an app.
\item {\ttfamily command} allows the A\+V server to invoke a command or function in the app.
\end{DoxyItemize}

Currently, only variable and setting fields are supported; command fields will be supported in the future.

All fields have names. Variable and setting fields also have a type. The possible field types, along with the default value are\+:
\begin{DoxyItemize}
\item string (empty string)
\item integer (0)
\item float (0.\+0)
\item boolean (false)
\item binary (zero-\/length block).
\end{DoxyItemize}

Default values can be overwritten in the asset definition. Currently, only string, integer and boolean fields are supported; float and binary fields will be supported in the future.\hypertarget{c_le_avdata_le_avdata_instance}{}\subsubsection{Asset Data Instances}\label{c_le_avdata_le_avdata_instance}
An app that needs to send data to the Air\+Vantage server must first create an asset instance using le\+\_\+avc\+\_\+\+Create() with the name of the asset definition. Once an asset instance is created, the app can begin accessing the instance\textquotesingle{}s fields.

Multiple instances of the same asset can be created, as well as multiple instances of different assets.

Asset definitions are specified in the \hyperlink{def_files_cdef_defFilesCdef_assets}{Assets} section of the app\textquotesingle{}s {\ttfamily cdef} file.\hypertarget{c_le_avdata_le_avdata_field}{}\subsubsection{Field Values and Activity}\label{c_le_avdata_le_avdata_field}
Set functions are available to set variable field values. Get functions are available to get settings fields\textquotesingle{} values.

An app can register a handler so that it can be called when activity occurs on a field. This is optional for variable and setting fields, but is required for command fields.
\begin{DoxyItemize}
\item {\ttfamily variable} called when the field is read by the A\+V server. The app can then call the appropriate set function to provide a new value for the field.
\item {\ttfamily setting} called when the field has been updated by the A\+V server with a new value. The app can use the appropriate get function to retrieve the new value.
\item {\ttfamily command} called when the A\+V server wants to invoke a command. The app should perform an appropriate action or call a function to execute this command. Currently, registering a handler is only supported for setting fields; variable and command fields will be added in the future.
\end{DoxyItemize}

Leaving it optional to register handlers for variable and setting fields allows an app to decide how it wants to access variable and setting fields. It can decide to only do something in response to the A\+V server, or it can work independently of the A\+V server updating variables when it has a new value, and reading settings only when it needs the value.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_audio}{}\section{Audio}\label{c_audio}
\hyperlink{le__audio__interface_8h}{A\+P\+I Reference}





The Audio A\+P\+I handles audio interfaces including play and record supported formats.

A Legato device can use several audio interfaces. You choose the input and output interfaces to tie together. The Audio stream related to a particular interface is represented with an \textquotesingle{}Audio Stream Reference\textquotesingle{}.

You can create your own audio path by connecting several audio streams together using audio connectors.

An audio path can support more than two audio interfaces. You can have a basic output audio path of a voice call to connect the Modem Voice Received interface with the Speaker interface, and at the same time, the Modem Voice Received interface can be also connected to a Recorder Device interface.\hypertarget{c_audio_le_audio_binding}{}\subsection{I\+P\+C interfaces binding}\label{c_audio_le_audio_binding}
All the functions of this A\+P\+I are provided by the {\bfseries audio\+Service}.

Here\textquotesingle{}s a code sample binding to audio services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_audio -> audioService.le_audio
}
\end{DoxyVerb}
\hypertarget{c_audio_le_audio_configuration}{}\subsection{Configure the Audio}\label{c_audio_le_audio_configuration}
The audio profile can be set with the \hyperlink{le__audio__interface_8h_ae2e6553f8125a30676d31f5cbd43a3b8}{le\+\_\+audio\+\_\+\+Set\+Profile()} function. The pre-\/configured profiles are defined with {\ttfamily le\+\_\+audio\+\_\+\+Profile\+\_\+t} enumeration type.

\begin{DoxyWarning}{Warning}
Ensure to check the list of supported audio profiles for your specific platform.
\end{DoxyWarning}
An audio profile can be retrieved with \hyperlink{le__audio__interface_8h_a1bf9091e0068a75a34fdf638ce0f2bc3}{le\+\_\+audio\+\_\+\+Get\+Profile()} and set with \hyperlink{le__audio__interface_8h_ae2e6553f8125a30676d31f5cbd43a3b8}{le\+\_\+audio\+\_\+\+Set\+Profile()}.

Then, the following functions let you enable or disable the audio settings on the selected audio interface\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_ac1af23c9febed1378620370a6961ce89}{le\+\_\+audio\+\_\+\+Enable\+Noise\+Suppressor()}/le\+\_\+audio\+\_\+\+Disable\+Noise\+Suppressor()\+: Noise Suppressor.
\item \hyperlink{le__audio__interface_8h_a54df27e4ab733a1f50e17903d7a9ae88}{le\+\_\+audio\+\_\+\+Enable\+Echo\+Canceller()}/ \hyperlink{le__audio__interface_8h_afc413a569b1e7eb877a3f98c2b52b05d}{le\+\_\+audio\+\_\+\+Disable\+Echo\+Canceller()}\+: Echo Canceller.
\item \hyperlink{le__audio__interface_8h_adedb3bb7e372fffa406f001bdb353e96}{le\+\_\+audio\+\_\+\+Enable\+Fir\+Filter()}/ \hyperlink{le__audio__interface_8h_ae5be820a7a167c307d64ea2c15b0abb4}{le\+\_\+audio\+\_\+\+Disable\+Fir\+Filter()}\+: downlink F\+I\+R Filter (Finite Impulse Response).
\item \hyperlink{le__audio__interface_8h_ad5eee81a34cc554ddef8a29c64bcd498}{le\+\_\+audio\+\_\+\+Enable\+Iir\+Filter()}/ \hyperlink{le__audio__interface_8h_af7958cd14c83c479ede6ae7a7953461b}{le\+\_\+audio\+\_\+\+Disable\+Iir\+Filter()}\+: downlink I\+I\+R Filter (Infinite Impulse Response).
\item \hyperlink{le__audio__interface_8h_ac4978d8d632269730c67e27d66fba818}{le\+\_\+audio\+\_\+\+Enable\+Automatic\+Gain\+Control()}/ \hyperlink{le__audio__interface_8h_a364cdff3d9fa7b2ced00ef92c0c4e9f7}{le\+\_\+audio\+\_\+\+Disable\+Automatic\+Gain\+Control()}\+: automatic gain on the selected audio stream.
\end{DoxyItemize}

To configure the encoding format, use \hyperlink{le__audio__interface_8h_a62e45a441a7d7ab5b7d20b41849331a2}{le\+\_\+audio\+\_\+\+Get\+Encoding\+Format()} and \hyperlink{le__audio__interface_8h_aead87ec16d317bb4e4a8e7e9ea37550b}{le\+\_\+audio\+\_\+\+Set\+Encoding\+Format()}.

To configure gain settings, use \hyperlink{le__audio__interface_8h_a51a86829cdd6f27234f482e5dbb6c933}{le\+\_\+audio\+\_\+\+Get\+Gain()} and \hyperlink{le__audio__interface_8h_ad62587dacf0cb087697a62fb9f41d938}{le\+\_\+audio\+\_\+\+Set\+Gain()}.

P\+C\+M has the following configuration get/set functions\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_a36779982278d3f965286582f38917247}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Sampling\+Rate()} and \hyperlink{le__audio__interface_8h_ae7c9d76c5377ad5fae13b24477827f45}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Sampling\+Rate()} for Hz rate.
\item \hyperlink{le__audio__interface_8h_a70fbe5e1ae02033e89ad04bbf1ed2b39}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Sampling\+Resolution()} and \hyperlink{le__audio__interface_8h_ab3678e77c8d69f248cd339042bd824cc}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Sampling\+Resolution()} for bit/sample settings.
\item \hyperlink{le__audio__interface_8h_aab9a28f3c695b90f8b9f622eb401f6cf}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Companding()} and \hyperlink{le__audio__interface_8h_a593682daa95aec349e48144f5b46c658}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Companding()} for signal settings.
\item \hyperlink{le__audio__interface_8h_a40bf3633c3050a7526a100562edc97f9}{le\+\_\+audio\+\_\+\+Get\+Sample\+Pcm\+Channel\+Number()} and \hyperlink{le__audio__interface_8h_aae7db9f0933119fb5a61162722b3274a}{le\+\_\+audio\+\_\+\+Set\+Sample\+Pcm\+Channel\+Number()} for channel numbers.
\end{DoxyItemize}\hypertarget{c_audio_le_audio_interfaces}{}\subsection{Open/\+Close an Audio Interface}\label{c_audio_le_audio_interfaces}
The following functions let you select the desired interface attributes\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_a74f1ef979329f6c2bd56ea622f4d05b2}{le\+\_\+audio\+\_\+\+Open\+Mic()}\+: returns an Audio Stream Reference of the analog audio signal coming from the microphone input.
\item \hyperlink{le__audio__interface_8h_a5c19afce44021c4abf6193707317f8de}{le\+\_\+audio\+\_\+\+Open\+Speaker()}\+: returns an Audio Stream Reference of the analog audio signal routed to the Speaker output.
\item \hyperlink{le__audio__interface_8h_acd8be89289067cef9441a8ed1d891146}{le\+\_\+audio\+\_\+\+Open\+Usb\+Rx()}\+: returns an Audio Stream Reference of the digitized audio signal coming from an external device connected via U\+S\+B Audio Class.
\item \hyperlink{le__audio__interface_8h_adb38f11ac78cf99160c19f69b4db0eb8}{le\+\_\+audio\+\_\+\+Open\+Usb\+Tx()}\+: returns an Audio Stream Reference of the digitized audio signal routed to an external device connected via U\+S\+B Audio Class.
\item \hyperlink{le__audio__interface_8h_aa0f0b5fcab8844c67a936d88fa050cf5}{le\+\_\+audio\+\_\+\+Open\+Pcm\+Rx()}\+: it returns an Audio Stream Reference of the digitized audio signal coming from an external device connected via the P\+C\+M interface.
\item \hyperlink{le__audio__interface_8h_a5e112543e8525775aa670dc71b320766}{le\+\_\+audio\+\_\+\+Open\+Pcm\+Tx()}\+: it returns an Audio Stream Reference of the digitized audio signal routed to an external device connected via the P\+C\+M interface.
\item \hyperlink{le__audio__interface_8h_a9e7d0042c4f422554eb10d64535608e5}{le\+\_\+audio\+\_\+\+Open\+I2s\+Rx()}\+: it returns an Audio Stream Reference of the digitized audio signal coming from an external device connected via the I2\+S interface.
\item \hyperlink{le__audio__interface_8h_a2633c1368adf60e342d7cadbbfa6278b}{le\+\_\+audio\+\_\+\+Open\+I2s\+Tx()}\+: it returns an Audio Stream Reference of the digitized audio signal routed to an external device connected via the I2\+S interface.
\item \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\+\_\+audio\+\_\+\+Open\+Modem\+Voice\+Rx()}\+: returns an Audio Stream Reference of the digitized audio signal coming from a voice call. The audio format is negotiated with the network when the call is established.
\item \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\+\_\+audio\+\_\+\+Open\+Modem\+Voice\+Tx()}\+: returns an Audio Stream Reference of the digitized audio signal routed to a voice call. The audio format is negotiated with the network when the call is established.
\end{DoxyItemize}

Multiple users can own the same stream at the same time.

\hyperlink{le__audio__interface_8h_a3f87e41dabde5bfb1170df527c380b9d}{le\+\_\+audio\+\_\+\+Get\+Default\+Pcm\+Time\+Slot()} can be called to get the default P\+C\+M time slot used on the current platform.

\hyperlink{le__audio__interface_8h_a0b727e15c16fffe10cdd5d345b297194}{le\+\_\+audio\+\_\+\+Get\+Default\+I2s\+Mode()} can be called to get the default I2s channel mode slot used on the current platform.

Call \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\+\_\+audio\+\_\+\+Close()} to release it. If several users own the same, corresponding stream reference, the interface will close only after the last user releases the audio stream.

You can configure the P\+C\+M interface with the \hyperlink{le__audio__interface_8h_ae7c9d76c5377ad5fae13b24477827f45}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Sampling\+Rate()}, \hyperlink{le__audio__interface_8h_ab3678e77c8d69f248cd339042bd824cc}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Sampling\+Resolution()} and \hyperlink{le__audio__interface_8h_a593682daa95aec349e48144f5b46c658}{le\+\_\+audio\+\_\+\+Set\+Pcm\+Companding()} functions. This function must be called before activating an audio path with the P\+C\+M interface, in other words you must call this function before connecting the P\+C\+M Stream to a connector.

In addition, the \hyperlink{le__audio__interface_8h_a36779982278d3f965286582f38917247}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Sampling\+Rate()}, \hyperlink{le__audio__interface_8h_a70fbe5e1ae02033e89ad04bbf1ed2b39}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Sampling\+Resolution()} and \hyperlink{le__audio__interface_8h_aab9a28f3c695b90f8b9f622eb401f6cf}{le\+\_\+audio\+\_\+\+Get\+Pcm\+Companding()} functions allows you to retrieve the P\+C\+M interface configuration.\hypertarget{c_audio_le_audio_streams}{}\subsection{Control an Audio Stream}\label{c_audio_le_audio_streams}
Once the users get an Audio Stream reference, they can control it with the following functions\+:


\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_ad62587dacf0cb087697a62fb9f41d938}{le\+\_\+audio\+\_\+\+Set\+Gain()}\+: adjust the gain of an audio stream (0 means \textquotesingle{}muted\textquotesingle{}, 100 is the maximum gain value).
\item \hyperlink{le__audio__interface_8h_a51a86829cdd6f27234f482e5dbb6c933}{le\+\_\+audio\+\_\+\+Get\+Gain()}\+: retrieve the gain of an audio stream (0 means \textquotesingle{}muted\textquotesingle{}, 100 is the maximum gain value).
\item \hyperlink{le__audio__interface_8h_a147e97c49dbc003f63df78f97d5fca32}{le\+\_\+audio\+\_\+\+Mute()}\+: mute an audio stream.
\item \hyperlink{le__audio__interface_8h_adad24547293481964039efe56bc14e2b}{le\+\_\+audio\+\_\+\+Unmute()}\+: unmute an audio stream.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
Multimedia (playback and recording) must be controled separatly from the main audio path (Microphone/\+Speaker, I2\+S, P\+C\+M, U\+S\+B). Muting/\+Unmuting a multimedia is done by muting/unmuting the multimedia stream, and not the other connected stream. For example, in case of playback + voice on the speaker, if the user wants to mute all the audio outcoming to the speaker, it must mute both the Speaker stream and the playback stream.

The hardware may or may not support the full 0-\/100 resolution, and if you want to see what was actually set call \hyperlink{le__audio__interface_8h_a51a86829cdd6f27234f482e5dbb6c933}{le\+\_\+audio\+\_\+\+Get\+Gain()} after \hyperlink{le__audio__interface_8h_ad62587dacf0cb087697a62fb9f41d938}{le\+\_\+audio\+\_\+\+Set\+Gain()} to get the real value.
\end{DoxyNote}
\begin{DoxyWarning}{Warning}
Ensure to check the list of supported audio streams for these functions on your specific platform.
\end{DoxyWarning}
In the case your platform can support other gains in your audio subsystem, you can set or get the value of them with the following functions\+:


\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_ad9235b668cc80f33bc5045327be8bffb}{le\+\_\+audio\+\_\+\+Set\+Platform\+Specific\+Gain()}\+: adjust the value of a platform specific gain in the audio subsystem. (0 means \textquotesingle{}muted\textquotesingle{}, 100 is the maximum gain value).
\item \hyperlink{le__audio__interface_8h_a56269b13844a1e90be4e4c86f50bed5a}{le\+\_\+audio\+\_\+\+Get\+Platform\+Specific\+Gain()}\+: retrieve the value of a platform specific gain in the audio subsystem. (0 means \textquotesingle{}muted\textquotesingle{}, 100 is the maximum gain value).
\end{DoxyItemize}

\begin{DoxyWarning}{Warning}
Ensure to check the names of supported gains for your specific platform.
\end{DoxyWarning}
\hypertarget{c_audio_le_audio_connectors}{}\subsection{Create Audio connectors}\label{c_audio_le_audio_connectors}
You can create your own audio path by connecting several audio streams together.

\hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\+\_\+audio\+\_\+\+Create\+Connector()} function creates a reference to an audio connector.

You can tie an audio stream to a connector by calling the \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\+\_\+audio\+\_\+\+Connect()} function.

You can remove an audio stream from a connector by calling the \hyperlink{le__audio__interface_8h_a6b88df9301038375701e4c15a4c8aaf0}{le\+\_\+audio\+\_\+\+Disconnect()} function.

When finished with it, delete it using the \hyperlink{le__audio__interface_8h_a3f40b13ff980040503927f59bb3e86a9}{le\+\_\+audio\+\_\+\+Delete\+Connector()} function.\hypertarget{c_audio_le_audio_pb_playback}{}\subsection{Playback}\label{c_audio_le_audio_pb_playback}
An audio file can be played to any active output interfaces.

Open a player interface by calling\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_a92eb1b6377f50ff07b97c5b8546f01ec}{le\+\_\+audio\+\_\+\+Open\+Player()}\+: returns an Audio Stream Reference for file playback. An audio file can be played on the local audio interface like Speaker, U\+S\+B Tx, P\+C\+M Tx, I2\+S Tx or on the remote audio interface Modem Voice Tx depending the kind of connector (input or output) is tied to.
\item \hyperlink{le__audio__interface_8h_aea2c5d0b394cfab87503639c534300c9}{le\+\_\+audio\+\_\+\+Play\+File()}\+: plays a specified file. W\+A\+V\+E (Waveform audio file) and A\+M\+R (Adaptive Multi Rate) are supported. A\+M\+R is an audio compression format optimized for speech coding. Two codecs are supported\+:
\begin{DoxyItemize}
\item A\+M\+R\+\_\+\+N\+B (A\+M\+R Narrowband) codec that encodes narrowband (200–3400 Hz) signals at variable bit rates ranging from 4.\+75 to 12.\+2 kbit/s. It was adopted as the standard speech codec by 3\+G\+P\+P.
\item A\+M\+R-\/\+W\+B (A\+M\+R Wideband) is an I\+T\+U-\/\+T standard speech codec which improved speech quality due to a wider speech bandwidth of 50–7000 Hz.
\end{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_afd37d59ab8207338da197554f49d7ff0}{le\+\_\+audio\+\_\+\+Play\+Samples()}\+: initiates a playback using an audio flow. A pipe has to be opened first, then the P\+C\+M samples are sent throught the opened pipe. A play can be done only on a connected stream. For instance, the \char`\"{}\+I2\+S Tx\char`\"{}, \char`\"{}\+Modem Voice Rx\char`\"{} and \char`\"{}\+Player\char`\"{} must be previously connected before playing a file.
\end{DoxyItemize}\hypertarget{c_audio_le_audio_pb_rec}{}\subsection{Record}\label{c_audio_le_audio_pb_rec}
Audio file recording can be done from any active input interface.

Open a \char`\"{}\+File Recording\char`\"{} interface by calling\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_aeac35459c36748a4471b6d45f1ebeb24}{le\+\_\+audio\+\_\+\+Open\+Recorder()}\+: returns an Audio Stream Reference for file recording. The local audio interface like Microphone, U\+S\+B Rx, P\+C\+M Rx, I2\+S Rx is recorded into an audio file; or the Modem Voice Rx remote audio interface is recorded into an audio file, depending the kind of connector (input or output) is tied to.
\item \hyperlink{le__audio__interface_8h_a393a26f6cff7fe05c1813fcafeef50f3}{le\+\_\+audio\+\_\+\+Record\+File()}\+: records in a specified file.
\item \hyperlink{le__audio__interface_8h_aead87ec16d317bb4e4a8e7e9ea37550b}{le\+\_\+audio\+\_\+\+Set\+Encoding\+Format()}\+: sets the encoding format. The same formats as the player are supported.
\item \hyperlink{le__audio__interface_8h_a62e45a441a7d7ab5b7d20b41849331a2}{le\+\_\+audio\+\_\+\+Get\+Encoding\+Format()}\+: gets the encoding format.
\item \hyperlink{le__audio__interface_8h_a9c55a59849afcbb2ccef88cd4265782e}{le\+\_\+audio\+\_\+\+Get\+Samples()}\+: gets the audio P\+C\+M samples. A pipe has to be opened first, then the P\+C\+M samples are sent throught the opened pipe. Recording can only be done on a connected stream. For example, the \char`\"{}\+I2\+S Rx\char`\"{}, \char`\"{}\+Modem Voice Tx\char`\"{} and \char`\"{}\+Recorder\char`\"{} must be previously connected before recording a file.
\end{DoxyItemize}

A P\+C\+M configuration must be set with\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_aae7db9f0933119fb5a61162722b3274a}{le\+\_\+audio\+\_\+\+Set\+Sample\+Pcm\+Channel\+Number()}\+: sets the channel number of a P\+C\+M sample.
\item \hyperlink{le__audio__interface_8h_a04adfcc0e8f5796eca53c31cd5dd6528}{le\+\_\+audio\+\_\+\+Set\+Sample\+Pcm\+Sampling\+Rate()}\+: sets the sampling rate of a P\+C\+M sample.
\item \hyperlink{le__audio__interface_8h_aae37b46c13f76144dd94c48bfe94998b}{le\+\_\+audio\+\_\+\+Set\+Sample\+Pcm\+Sampling\+Resolution()}\+: sets the sampling resolution (in bits per sample) of a P\+C\+M sample.
\end{DoxyItemize}

The P\+C\+M samples configuration can be retrieved with\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_a40bf3633c3050a7526a100562edc97f9}{le\+\_\+audio\+\_\+\+Get\+Sample\+Pcm\+Channel\+Number()}\+: gets the channel number of a P\+C\+M sample.
\item \hyperlink{le__audio__interface_8h_a80fb48632ce8f638cea4a3e5d333d66f}{le\+\_\+audio\+\_\+\+Get\+Sample\+Pcm\+Sampling\+Rate()}\+: gets the sampling rate of a P\+C\+M sample.
\item \hyperlink{le__audio__interface_8h_a70b9f904ce225aad4fb80b8b24a1f92a}{le\+\_\+audio\+\_\+\+Get\+Sample\+Pcm\+Sampling\+Resolution()}\+: can be called to get the sampling resolution (in bits per sample) of a P\+C\+M sample. The default configuration is P\+C\+M 16-\/bit audio @ 8\+K\+Hz one channel.
\end{DoxyItemize}

An A\+M\+R configuration must be set with\+:
\begin{DoxyItemize}
\item \hyperlink{le__audio__interface_8h_a18600cdbd3995c9c2ca24f9b15991f7d}{le\+\_\+audio\+\_\+\+Set\+Sample\+Amr\+Mode()}\+: sets the A\+M\+R mode (N\+B/\+W\+B, bitrate).
\item \hyperlink{le__audio__interface_8h_a5932f51fb1398cc2442c8bb765ca4071}{le\+\_\+audio\+\_\+\+Set\+Sample\+Amr\+Dtx()}\+: can be called to activate/deactivate the Discontinuous Transmission (D\+T\+X) to reduce bandwidth usage during silence periods. The A\+M\+R configuration can be retrieved with\+:
\item \hyperlink{le__audio__interface_8h_aa293e15d41f7c1c384053947b5a4dbea}{le\+\_\+audio\+\_\+\+Get\+Sample\+Amr\+Mode()}\+: gets the A\+M\+R mode.
\item \hyperlink{le__audio__interface_8h_ab26d633ee83aed52dae838cb9d721f87}{le\+\_\+audio\+\_\+\+Get\+Sample\+Amr\+Dtx()}\+: gets the Discontinuous Transmission (D\+T\+X).
\end{DoxyItemize}

To stop a play/record call \hyperlink{le__audio__interface_8h_a4aebc6e8cdc4389c375e93418823af71}{le\+\_\+audio\+\_\+\+Stop()}\+:
\begin{DoxyItemize}
\item The playback/record stops playing/recording, and the read/write position indicator associated with the file stream is rewound to the beginning of the file. A new file can be played/recorded using \hyperlink{le__audio__interface_8h_aea2c5d0b394cfab87503639c534300c9}{le\+\_\+audio\+\_\+\+Play\+File()}/le\+\_\+audio\+\_\+\+Play\+Samples()/le\+\_\+audio\+\_\+\+Record\+File()/le\+\_\+audio\+\_\+\+Get\+Samples().
\item \hyperlink{le__audio__interface_8h_a80343ca9800ab80f818bbe0361bb226b}{le\+\_\+audio\+\_\+\+Pause()}\+: can be called to pause a play/record. The file playing/recording is put on hold, the read/write position indicator of the file is not moved.
\item \hyperlink{le__audio__interface_8h_a1dba6618bd8fc9835869ee72c3fbd850}{le\+\_\+audio\+\_\+\+Resume()}\+: can be called to resume a paused play/record. The file playing/recording continues at the file\textquotesingle{}s position indicator held after the pause.
\item \hyperlink{le__audio__interface_8h_a7a5855b7be77110eaca1846b17792597}{le\+\_\+audio\+\_\+\+Flush()}\+: can be called to flush the remaining audio samples before sending them to the audio driver.
\end{DoxyItemize}

Here\textquotesingle{}s a code sample showing how to play a file to the Modem Voice Tx output interface. The audio of the voice call is redirected to the I2\+S interfaces. This function simply plays a voice prompt to the remote party when the voice call is established.


\begin{DoxyCode}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} ConnectAudioAndPlayVoicePromptToRemoteParty
(
    \textcolor{keywordtype}{void}
)
\{
    \textcolor{comment}{// I get the audio from the voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} mdmRxAudioRef = 
      \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\_audio\_OpenModemVoiceRx}();
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} mdmTxAudioRef = 
      \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\_audio\_OpenModemVoiceTx}();

    \textcolor{comment}{// I get the I2S interface references.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} i2sTxRef = \hyperlink{le__audio__interface_8h_a2633c1368adf60e342d7cadbbfa6278b}{le\_audio\_OpenI2sTx}(
      \hyperlink{le__audio__interface_8h_a0b727e15c16fffe10cdd5d345b297194}{le\_audio\_GetDefaultI2sMode}());
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} i2sRxRef = \hyperlink{le__audio__interface_8h_a9e7d0042c4f422554eb10d64535608e5}{le\_audio\_OpenI2sRx}(
      \hyperlink{le__audio__interface_8h_a0b727e15c16fffe10cdd5d345b297194}{le\_audio\_GetDefaultI2sMode}());

    \textcolor{comment}{// I create the audio connectors.}
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t} audioInputConnectorRef = 
      \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t} audioOutputConnectorRef = 
      \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();

    \textcolor{comment}{// The voice call's audio is redirected to I2S interfaces.}
    \textcolor{keywordflow}{if} (mdmRxAudioRef && mdmTxAudioRef && i2sTxRef && i2sRxRef &&
        audioInputConnectorRef && audioOutputConnectorRef)
    \{
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioInputConnectorRef, i2sRxRef);
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioInputConnectorRef, mdmTxAudioRef);
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioOutputConnectorRef, i2sTxRef);
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioOutputConnectorRef, mdmRxAudioRef);
    \}

    \textcolor{comment}{// I get the interface reference for file playback.}
    \textcolor{keywordtype}{int} fd = open(\textcolor{stringliteral}{"/myvoiceprompt.wav"}, O\_RDONLY));
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} fileAudioRef = \hyperlink{le__audio__interface_8h_a92eb1b6377f50ff07b97c5b8546f01ec}{le\_audio\_OpenPlayer}();

    \textcolor{comment}{// The audio file is played on the input connector, the remote party can now hear the voice}
    \textcolor{comment}{// prompt.}
    \textcolor{keywordflow}{if} (fileAudioRef && audioInputConnectorRef)
    \{
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioInputConnectorRef, fileAudioRef);
        \hyperlink{le__audio__interface_8h_aea2c5d0b394cfab87503639c534300c9}{le\_audio\_PlayFile}(fileAudioRef, fd);
    \}
\}
\end{DoxyCode}


You can also register a handler function for media-\/related notifications like errors or audio events.

\hyperlink{le__audio__interface_8h_a9996ac9d23333cf8219f28b69cac4f81}{le\+\_\+audio\+\_\+\+Add\+Media\+Handler()} function installs a handler for player/recorder stream notifications.

\hyperlink{le__audio__interface_8h_a60442c840a69155110ae878e03e16059}{le\+\_\+audio\+\_\+\+Remove\+Media\+Handler()} function removes the player/recorder handler function.

\begin{DoxyNote}{Note}
The {\ttfamily L\+E\+\_\+\+A\+U\+D\+I\+O\+\_\+\+M\+E\+D\+I\+A\+\_\+\+N\+O\+\_\+\+M\+O\+R\+E\+\_\+\+S\+A\+M\+P\+L\+E\+S} event indicates when all samples put into the pipe by the user\textquotesingle{}s app have been sent to the audio driver (see \hyperlink{le__audio__interface_8h_afd37d59ab8207338da197554f49d7ff0}{le\+\_\+audio\+\_\+\+Play\+Samples()}).
\end{DoxyNote}
Here\textquotesingle{}s a code sample on how to install a file\textquotesingle{}s event handler\+: 
\begin{DoxyCode}
\textcolor{comment}{// Handler function for Stream Event Notifications.}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} MyMediaHandler
(
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}          streamRef,
    \hyperlink{le__audio__interface_8h_aaf870f5f30f4f6f65efb873c5d0cb5f1}{le\_audio\_MediaEvent\_t}         event,
    \textcolor{keywordtype}{void}*                         contextPtr
)
\{
    \textcolor{keywordflow}{switch}(event)
    \{
        \textcolor{keywordflow}{case} \hyperlink{le__audio__interface_8h_aaf870f5f30f4f6f65efb873c5d0cb5f1a7dbc0c9a2c3839d3db974c5aa5be344d}{LE\_AUDIO\_MEDIA\_ENDED}:
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"File event is LE\_AUDIO\_MEDIA\_ENDED."});
            \textcolor{keywordflow}{break};

        \textcolor{keywordflow}{case} \hyperlink{le__audio__interface_8h_aaf870f5f30f4f6f65efb873c5d0cb5f1a5f7de6714ea54f09d036a87dd1c63a50}{LE\_AUDIO\_MEDIA\_ERROR}:
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"File event is LE\_AUDIO\_MEDIA\_ERROR."});
            \textcolor{keywordflow}{break};
    \}
\}


\textcolor{comment}{// I must install my audio media event handler as follows:}
[...]

\textcolor{keywordtype}{int} myAudioFileFd = -1;
\hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} fileAudioRef = NULL;
\hyperlink{le__audio__interface_8h_a390b011cbb6f745c46e861d315af0bbe}{le\_audio\_MediaHandlerRef\_t} mediaHandlerRef = NULL;

myAudioFileFd=open(\textcolor{stringliteral}{"/myAudioFile.wav"}, O\_RDONLY);

fileAudioRef = \hyperlink{le__audio__interface_8h_a92eb1b6377f50ff07b97c5b8546f01ec}{le\_audio\_OpenPlayer}();
\hyperlink{le__log_8h_aceaf11a11691d6c676e36dd317b38dbd}{LE\_ERROR\_IF}((fileAudioRef==NULL), \textcolor{stringliteral}{"le\_audio\_OpenPlayer returns NULL!"});

mediaHandlerRef = \hyperlink{le__audio__interface_8h_a9996ac9d23333cf8219f28b69cac4f81}{le\_audio\_AddMediaHandler}(fileAudioRef,
                                           MyMediaEventHandler,
                                           NULL);

\hyperlink{le__log_8h_aceaf11a11691d6c676e36dd317b38dbd}{LE\_ERROR\_IF}((mediaHandlerRef==NULL), \textcolor{stringliteral}{"AddMediaHandler returns NULL!"});


\hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(audioInputConnectorRef, fileAudioRef);

\textcolor{comment}{// Play the file}
le\_audio\_Play(fileAudioRef, myAudioFileFd);

[...]
\end{DoxyCode}
\hypertarget{c_audio_le_audio_dtmf}{}\subsection{D\+T\+M\+F}\label{c_audio_le_audio_dtmf}
The \hyperlink{le__audio__interface_8h_a8b1546842a6e917db9a9458aceb77c82}{le\+\_\+audio\+\_\+\+Play\+Dtmf()} function allows the application to play one or several D\+T\+M\+F on a playback stream. The duration and the pause of the D\+T\+M\+Fs must also be specified with the input parameters.

The \hyperlink{le__audio__interface_8h_a852728586cacfcbf63ae59b6f80847eb}{le\+\_\+audio\+\_\+\+Play\+Signalling\+Dtmf()} function allows the application to ask the Mobile Network to generate on the remote audio party the D\+T\+M\+Fs. Compared with \hyperlink{le__audio__interface_8h_a8b1546842a6e917db9a9458aceb77c82}{le\+\_\+audio\+\_\+\+Play\+Dtmf()}, \hyperlink{le__audio__interface_8h_a852728586cacfcbf63ae59b6f80847eb}{le\+\_\+audio\+\_\+\+Play\+Signalling\+Dtmf()} function may offer a better signal quality, but the the duration and the pause timings may be less accurate.

The application must register a handler function to detect incoming D\+T\+M\+F characters on a specific input audio stream. The \hyperlink{le__audio__interface_8h_a6e65275798c0db287fc1b540cdc0db8b}{le\+\_\+audio\+\_\+\+Add\+Dtmf\+Detector\+Handler()} function installs a handler for D\+T\+M\+F detection.

The \hyperlink{le__audio__interface_8h_a7fd6191ed6ff512407bfe01d20a51459}{le\+\_\+audio\+\_\+\+Remove\+Dtmf\+Detector\+Handler()} function uninstalls the handler function.

The D\+T\+M\+Fs are\+: 0, 1, 2, 3, 4, 5, 6, 7, 8, 9, $\ast$, \#, A, B, C, D. Not case sensitive.

\begin{DoxyNote}{Note}
The D\+T\+M\+F decoding works only on an active audio path.
\end{DoxyNote}
\hypertarget{c_audio_le_audio_samples}{}\subsection{Code samples}\label{c_audio_le_audio_samples}
The following two code samples show how to create different audio paths for an incoming voice call.

The first example has the audio path depending on an U\+S\+B Audio handset. The {\bfseries Connect\+Voice\+Call\+Audio()} function creates this audio path. A U\+S\+B Audio handset plugged in and fully operationnal, will redirect the call audio to the handset; otherwise, it will redirect the call to the default microphone and speaker.

Use Disconnect\+Voice\+Call\+Audio() to delete the audio path.


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} ConnectVoiceCallAudio
(
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}*  audioInputConnectorRefPtr,  \textcolor{comment}{// [OUT] Input connector.}
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}*  audioOutputConnectorRefPtr, \textcolor{comment}{// [OUT] Output connector.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     mdmRxAudioRefPtr,           \textcolor{comment}{// [OUT] Received voice call
       audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     mdmTxAudioRefPtr,           \textcolor{comment}{// [OUT] Transmitted voice
       call audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     deviceRxAudioRefPtr,        \textcolor{comment}{// [OUT] Received device
       audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     deviceTxAudioRefPtr         \textcolor{comment}{// [OUT] Transmitted device
       audio stream.}
)
\{
    \textcolor{comment}{// I get the audio from the voice call.}
    *mdmRxAudioRefPtr = \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\_audio\_OpenModemVoiceRx}();
    *mdmTxAudioRefPtr = \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\_audio\_OpenModemVoiceTx}();

    \textcolor{comment}{// If I cannot get the audio from the voice call, I return an error.}
    \textcolor{keywordflow}{if} ((*mdmRxAudioRefPtr == NULL) || (*mdmTxAudioRefPtr == NULL))
    \{
            \textcolor{comment}{// I close the audio interfaces that have failed to open.}
            \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*mdmRxAudioRefPtr);
            \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*mdmTxAudioRefPtr);
            \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    \textcolor{comment}{// I create the audio connectors.}
    *audioInputConnectorRefPtr = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();
    *audioOutputConnectorRefPtr = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();

    \textcolor{comment}{// I verify if my Audio USB handset is plugged and operational before trying to use it.}
    \textcolor{keywordflow}{if}(IsMyUSBHandsetPlugged() == TRUE)
    \{
        \textcolor{comment}{// I can redirect the audio to my USB handset using linear PCM audio format (PCM 16bits @ 16KHz)}
        *deviceRxAudioRefPtr = \hyperlink{le__audio__interface_8h_acd8be89289067cef9441a8ed1d891146}{le\_audio\_OpenUsbRx}();
        *deviceTxAudioRefPtr = \hyperlink{le__audio__interface_8h_adb38f11ac78cf99160c19f69b4db0eb8}{le\_audio\_OpenUsbTx}();

        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioInputConnectorRefPtr, *deviceRxAudioRefPtr);
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioOutputConnectorRefPtr, *deviceTxAudioRefPtr);
    \}
    \textcolor{keywordflow}{else}
    \{
        \textcolor{comment}{// There is no USB Audio handset, I redirect the audio to the in-built Microphone and Speaker.}
        *deviceRxAudioRefPtr = \hyperlink{le__audio__interface_8h_a74f1ef979329f6c2bd56ea622f4d05b2}{le\_audio\_OpenMic}();
        *deviceTxAudioRefPtr = \hyperlink{le__audio__interface_8h_a5c19afce44021c4abf6193707317f8de}{le\_audio\_OpenSpeaker}();

        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioInputConnectorRefPtr, *deviceRxAudioRefPtr);
        \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioOutputConnectorRefPtr, *deviceTxAudioRefPtr);
    \}

    \textcolor{comment}{// I tie the audio from the voice call to the connectors.}
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (*audioInputConnectorRefPtr, *mdmTxAudioRefPtr);
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (*audioOutputConnectorRefPtr, *mdmRxAudioRefPtr);

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}


\textcolor{keywordtype}{void} DisconnectVoiceCallAudio
(
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}  audioInputConnectorRef,  \textcolor{comment}{// [IN] Input connector.}
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}  audioOutputConnectorRef, \textcolor{comment}{// [IN] Output connector.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     mdmRxAudioRef,           \textcolor{comment}{// [IN] Received voice call audio
       stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     mdmTxAudioRef,           \textcolor{comment}{// [IN] Transmitted voice call
       audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     deviceRxAudioRef,        \textcolor{comment}{// [IN] Received device audio
       stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     deviceTxAudioRef         \textcolor{comment}{// [IN] Transmitted device audio
       stream.}
)
\{
    \textcolor{comment}{// The call is terminated, I can close its audio interfaces.}
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(mdmRxAudioRef);
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(mdmTxAudioRef);

    \textcolor{comment}{// I close all the device interfaces.}
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(deviceRxAudioRef);
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(deviceTxAudioRef);

    \textcolor{comment}{// I delete the Audio connector references.}
    \hyperlink{le__audio__interface_8h_a3f40b13ff980040503927f59bb3e86a9}{le\_audio\_DeleteConnector}(audioInputConnectorRef);
    \hyperlink{le__audio__interface_8h_a3f40b13ff980040503927f59bb3e86a9}{le\_audio\_DeleteConnector}(audioOutputConnectorRef);
\}
\end{DoxyCode}


The next code sample uses specific functions to deal with a new \textquotesingle{}Incoming call\textquotesingle{} event during a call already in progress.

If no call is in progress, use the Connect\+Voice\+Call\+Audio() function to redirect the call audio to the in-\/built Microphone and Speaker.

If a new call is incoming, and considered a high priority call, you must mute the audio of the first call, and then connect the new call to your current audio path. Use Switch\+Voice\+Call\+Audio() for these actions.

\begin{DoxyWarning}{Warning}
Duration and pause can be dependent on the platform and/or network capabilities.
\end{DoxyWarning}
When the high priority call terminates, you can return back to your previous call and reactivate its audio with the Switch\+Back\+Voice\+Call\+Audio() function.


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} ConnectVoiceCallAudio
(
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}*  audioInputConnectorRefPtr,  \textcolor{comment}{// [OUT] Input connector.}
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}*  audioOutputConnectorRefPtr, \textcolor{comment}{// [OUT] Output connector.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     mdmRxAudioRefPtr,           \textcolor{comment}{// [OUT] Received voice call
       audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     mdmTxAudioRefPtr,           \textcolor{comment}{// [OUT] Transmitted voice
       call audio stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     micRefPtr,                  \textcolor{comment}{// [OUT] Microphone stream.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*     speakerRefPtr               \textcolor{comment}{// [OUT] Speaker stream.}
)
\{
    *mdmRxAudioRefPtr = \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\_audio\_OpenModemVoiceRx}();
    *mdmTxAudioRefPtr = \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\_audio\_OpenModemVoiceTx}();

    \textcolor{comment}{// If I cannot get the audio from the voice call, I return an error.}
    \textcolor{keywordflow}{if} ((*mdmRxAudioRefPtr == NULL) || (*mdmTxAudioRefPtr == NULL))
    \{
            \textcolor{comment}{// I close the audio interfaces that  have failed to open.}
            \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*mdmRxAudioRefPtr);
            \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*mdmTxAudioRefPtr);
            \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    *audioInputConnectorRefPtr = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();
    *audioOutputConnectorRefPtr = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();

    \textcolor{comment}{// Redirect audio to the in-built Microphone and Speaker.}
    *speakerRefPtr = \hyperlink{le__audio__interface_8h_a5c19afce44021c4abf6193707317f8de}{le\_audio\_OpenSpeaker}();
    *micRefPtr = \hyperlink{le__audio__interface_8h_a74f1ef979329f6c2bd56ea622f4d05b2}{le\_audio\_OpenMic}();

    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioInputConnectorRefPtr, *micRefPtr);
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (*audioInputConnectorRefPtr, *mdmTxAudioRefPtr);
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(*audioOutputConnectorRefPtr, *speakerRefPtr);
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (*audioOutputConnectorRefPtr, *mdmRxAudioRefPtr);

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}


\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} SwitchVoiceCallAudio
(
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}  audioInputConnectorRef,  \textcolor{comment}{// [IN] Input connector.}
    \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t}  audioOutputConnectorRef, \textcolor{comment}{// [IN] Output connector.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     oldMdmRxAudioRef,        \textcolor{comment}{// [IN] Received audio stream of
       the previous voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}     oldMdmTxAudioRef,        \textcolor{comment}{// [IN] Transmitted audio stream
       of the previous voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*    newMdmRxAudioRefPtr,     \textcolor{comment}{// [OUT] Received audio stream of
       the new voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}*    newMdmTxAudioRefPtr      \textcolor{comment}{// [OUT] Transmitted audio stream
       of the new voice call.}
)
\{
    \textcolor{keywordflow}{if} ((newMdmRxAudioRefPtr == NULL)     ||
        (newMdmTxAudioRefPtr == NULL))
    \{
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cabe505065132f6e8850da6f476d8fb783}{LE\_BAD\_PARAMETER};
    \}

    *newMdmRxAudioRefPtr = \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\_audio\_OpenModemVoiceRx}();
    *newMdmTxAudioRefPtr = \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\_audio\_OpenModemVoiceTx}();

    \textcolor{comment}{// If I cannot get the audio from the voice call, I return an error.}
    \textcolor{keywordflow}{if} ((*newMdmRxAudioRefPtr == NULL) || (*newMdmTxAudioRefPtr == NULL))
    \{
        \textcolor{comment}{// I close the audio interfaces that have failed to open.}
        \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*newMdmRxAudioRefPtr);
        \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(*newMdmTxAudioRefPtr);
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    \textcolor{comment}{// I mute the previous call.}
    \hyperlink{le__audio__interface_8h_a147e97c49dbc003f63df78f97d5fca32}{le\_audio\_Mute}(oldMdmRxAudioRef);
    \hyperlink{le__audio__interface_8h_a147e97c49dbc003f63df78f97d5fca32}{le\_audio\_Mute}(oldMdmTxAudioRef);

    \textcolor{comment}{// I connect the new incoming call.}
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (audioInputConnectorRef, *newMdmTxAudioRefPtr);
    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (audioOutputConnectorRef, *newMdmRxAudioRefPtr);

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}


\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} SwitchBackVoiceCallAudio
(
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}  oldMdmRxAudioRef, \textcolor{comment}{// [IN] Received audio stream of the
       previous voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}  oldMdmTxAudioRef, \textcolor{comment}{// [IN] Transmitted audio stream of the
       previous voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}  newMdmRxAudioRef, \textcolor{comment}{// [IN] Received audio stream of the new
       voice call.}
    \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t}  newMdmTxAudioRef  \textcolor{comment}{// [IN] Transmitted audio stream  of the
       new voice call.}
)
\{
    \textcolor{comment}{// I can delete the new call audio interfaces.}
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(newMdmRxAudioRef);
    \hyperlink{le__audio__interface_8h_abafeb411da7b1a14b2d5777fc1d3e394}{le\_audio\_Close}(newMdmTxAudioRef);

    \textcolor{comment}{// I can re-open the previous call streaming.}
    \textcolor{keywordflow}{if} (\hyperlink{le__audio__interface_8h_adad24547293481964039efe56bc14e2b}{le\_audio\_Unmute}(oldMdmRxAudioRef) != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}
    \textcolor{keywordflow}{if} (\hyperlink{le__audio__interface_8h_adad24547293481964039efe56bc14e2b}{le\_audio\_Unmute}(oldMdmTxAudioRef) != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}
\end{DoxyCode}






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_cellnet}{}\section{Cellular Network}\label{c_le_cellnet}
\hyperlink{le__cellnet__interface_8h}{A\+P\+I Reference}





The Cellular Network service ensures that the modem is registered on the network when an user application makes a request for network access. This includes\+:
\begin{DoxyItemize}
\item ensuring that the radio is turned on.
\item ensuring that there is a valid S\+I\+M, and it is unlocked.
\item ensuring that the modem is registered on the network.
\end{DoxyItemize}

If all of the above conditions are met, then the service indicates that the network is available.\hypertarget{c_le_cellnet_le_cellnet_binding}{}\subsection{I\+P\+C interfaces binding}\label{c_le_cellnet_le_cellnet_binding}
All the functions of this A\+P\+I are provided by the {\bfseries cell\+Net\+Service} application service.

Here\textquotesingle{}s a code sample binding to Cellular Network services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_cellnet -> cellNetService.le_cellnet
}
\end{DoxyVerb}
\hypertarget{c_le_cellnet_c_le_cellnet_requesting}{}\subsection{Requesting the Cellular Network}\label{c_le_cellnet_c_le_cellnet_requesting}
The Cellular Network can be requested using \hyperlink{le__cellnet__interface_8h_adc6770a47ed109a77ae44241a953da5f}{le\+\_\+cellnet\+\_\+\+Request()}. The le\+\_\+cellnet\+\_\+\+Request function will turn on the radio if it is switched off and it will unlock the S\+I\+M if a P\+I\+N code is required (it will retrieve the needed information from the config D\+B, cf. \hyperlink{c_le_cellnet_c_le_cellnet_configdb}{Cellular Network configuration tree}). Before the cellular network is requested, an application should register a network state handler using \hyperlink{le__cellnet__interface_8h_aa3106518be8b38d94265574736769b6a}{le\+\_\+cellnet\+\_\+\+Add\+State\+Event\+Handler()}. Once the cellular network becomes available, the handler will be called to indicate that the modem is now registered on the network.

If the state of the network changes, then the handler will be called with the new state.

To release the cellular network, an application can use \hyperlink{le__cellnet__interface_8h_ae3387759b2ae9ecf0992ac685cec5bcd}{le\+\_\+cellnet\+\_\+\+Release()}. Once all user applications release the cellular network access, then the service will turn off the radio.

All configuration data required for a network registration, such as the P\+I\+N code of the S\+I\+M, will be stored in the Config D\+B.\hypertarget{c_le_cellnet_c_le_cellnet_options}{}\subsection{Network Options}\label{c_le_cellnet_c_le_cellnet_options}
\begin{DoxyNote}{Note}
The functionaliy described in this section is not currently implemented; this description is provided to outline future functionality.
\end{DoxyNote}
Some applications may have network requirements that are not met by the default cellular network service. For example, it would specify the S\+I\+M on which it wants to operate.

In this case, an application can create a request object using le\+\_\+cellnet\+\_\+\+Create\+Request(), set optional values on that request object, using le\+\_\+cellnet\+\_\+\+Select\+Sim() and then submits that object to a cellular network request, using le\+\_\+cellnet\+\_\+\+Submit\+Request().\hypertarget{c_le_cellnet_c_le_cellnet_configdb}{}\subsection{Cellular Network configuration tree}\label{c_le_cellnet_c_le_cellnet_configdb}
The configuration database path for the S\+I\+M is\+: \begin{DoxyVerb} /
     modemServices/
         sim/
             1/
                 pin<string> == <PIN_CODE>\end{DoxyVerb}



\begin{DoxyItemize}
\item \textquotesingle{}1\textquotesingle{} is the sim slot number that \hyperlink{le__sim__interface_8h_a4c9e3ded0485f14c66e4d51763f2de57}{le\+\_\+sim\+\_\+\+Get\+Selected\+Card()} is returning.
\item \textquotesingle{}P\+I\+N\+\_\+\+C\+O\+D\+E\textquotesingle{} is the P\+I\+N code for the S\+I\+M card.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
when a new S\+I\+M is inserted and \+:
\begin{DoxyItemize}
\item is locked, Cellular Network Service will read automatically the config D\+B in order to try to enter the pin for the S\+I\+M card.
\item is blocked, Cellular Network Service just log an error and did not try to enter the puk code.
\end{DoxyItemize}
\end{DoxyNote}
Copyright (C) Sierra Wireless Inc. Use of this work is subject to license.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesConfigTree}{}\section{Config Tree}\label{legatoServicesConfigTree}
Configuration tree services provide an easy way to manage target\textquotesingle{}s configuration database.

\hyperlink{c_config}{Config Tree A\+P\+I} ~\newline
 \hyperlink{configTreePage}{Config Tree Entries} ~\newline
 \hyperlink{c_configAdmin}{Config Tree Admin A\+P\+I}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_config}{}\subsection{Config Tree A\+P\+I}\label{c_config}
\hyperlink{le__cfg__interface_8h}{A\+P\+I Reference}





The Config Tree A\+P\+I is used by apps to read and write their specific configurations. Each app is given an isolated tree. The system utilities store their configuration in the {\ttfamily root} tree.

Paths in the tree look like traditional Unix style paths like this\+:


\begin{DoxyCode}
/path/to/my/value 
\end{DoxyCode}


The path root is the root of the tree where the app has been given access. If the app has permission to access another tree, the path can also include the name of the other tree, followed by a colon.


\begin{DoxyCode}
secondTree:/path/to/my/value 
\end{DoxyCode}


In this case, a value named {\ttfamily value} is read from the tree named {\ttfamily second\+Tree} 

The tree is broken down into stems and leaves.

A stem is a node that has at least one child node. A leaf has no children, but can hold a value.

The config tree supports string, signed integer, boolean, floating point, and empty values. It\textquotesingle{}s recommended to store anything more complex using stems and leaves, which enhances readablity and debugging. It also sidesteps nasty cross platform alignment issues.\hypertarget{c_config_cfg_transaction}{}\subsubsection{Read and Write Transactions}\label{c_config_cfg_transaction}
The config tree uses simple transactions to work with its data. Both read and write transactions are supported. Use read transactions to ensure you can atomically read multiple values from your configuration while keeping consistency with third parties trying to write data.

To prevent a single client from locking out other clients, read and write transactions have their own configurable timeout.

During a write transaction, both reading and writing are allowed. If you write a value during a transaction and read from that value again, you will get the same value you wrote. Third party clients will continue to see the old value. It\textquotesingle{}s not until you commit your transaction that third parties will begin to see your updated value.

During read transactions, writes are not permitted and are thrown away.

Transactions are started by creating an iterator. Either a read or write iterator can be created. To end the transaction, you can delete the iterator, cancelling the transaction. Or,for write transactions, you can commit the iterator.

You can have multiple read transactions against the tree. They won\textquotesingle{}t block other transactions from being creating. A read transaction won\textquotesingle{}t block creating a write transaction either. A read transaction only blocks a write transaction from being comitted to the tree.

A write transaction in progress will also block creating another write transaction. If a write transaction is in progress when the request for another write transaction comes in, the secondary request will be blocked. This secondary request will remain blocked until the first transaction has been comitted or has timed out. The transaction timeout default is 30 seconds. You can extend the timeout by setting a value (in seconds) in {\ttfamily config\+Tree/transaction\+Timeout}.\hypertarget{c_config_cfg_iteration}{}\subsubsection{Iterating the Tree}\label{c_config_cfg_iteration}
This code sample shows how to iterate a specified node and print its contents\+:


\begin{DoxyCode}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} PrintNode(\hyperlink{le__cfg__interface_8h_a646829934bb23a878e19ade2c3e01eba}{le\_cfg\_IteratorRef\_t} iteratorRef)
\{
    \textcolor{keywordflow}{do}
    \{
        \textcolor{keywordtype}{char} stringBuffer[MAX\_CFG\_STRING] = \{ 0 \};

        \hyperlink{le__cfg__interface_8h_a02c84283bc9c62a490e9c7cf3f3d5598}{le\_cfg\_GetNodeName}(iteratorRef, \textcolor{stringliteral}{""}, stringBuffer, \textcolor{keyword}{sizeof}(stringBuffer));

        \textcolor{keywordflow}{switch} (\hyperlink{le__cfg__interface_8h_a31df1f796da5a18a74de1110c549d6f8}{le\_cfg\_GetNodeType}(iteratorRef, \textcolor{stringliteral}{""}))
        \{
            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57dab720da857c99845f5fac9499b3bfed4e}{LE\_CFG\_TYPE\_STEM}:
                \{
                    printf(\textcolor{stringliteral}{"%s/\(\backslash\)n"}, stringBuffer);

                    \textcolor{keywordflow}{if} (\hyperlink{le__cfg__interface_8h_abb7ab8d52ca9bf5e0977341e18740079}{le\_cfg\_GoToFirstChild}(iteratorRef) == 
      \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
                    \{
                        PrintNode(iteratorRef);
                        \hyperlink{le__cfg__interface_8h_a3a8519b471bc6f4a5fea3716636dc607}{le\_cfg\_GoToNode}(iteratorRef, \textcolor{stringliteral}{".."});
                    \}
                \}
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57da545f7e9317020efc82e268c2c08b7e4b}{LE\_CFG\_TYPE\_EMPTY}:
                printf(\textcolor{stringliteral}{"%s = *empty*\(\backslash\)n"}, stringBuffer);
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57dafe64ea58a518cef6fbeefe9ee8fea944}{LE\_CFG\_TYPE\_BOOL}:
                printf(\textcolor{stringliteral}{"%s = %s\(\backslash\)n"},
                       stringBuffer,
                       (\hyperlink{le__cfg__interface_8h_aa3898fcb0d62b03c9a238d36b42d7a63}{le\_cfg\_GetBool}(iteratorRef, \textcolor{stringliteral}{""}, \textcolor{keyword}{false}) ? \textcolor{stringliteral}{"true"} : \textcolor{stringliteral}{"false"}));
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57dae15135ce3aea7925fba96a16eefd7d01}{LE\_CFG\_TYPE\_INT}:
                printf(\textcolor{stringliteral}{"%s = %d\(\backslash\)n"}, stringBuffer, \hyperlink{le__cfg__interface_8h_ada4b5ea73868f3d00701d7e76c2e6f38}{le\_cfg\_GetInt}(iteratorRef, \textcolor{stringliteral}{""}, 0));
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57da51f9f84c78b8ce049f85f28da0d3596b}{LE\_CFG\_TYPE\_FLOAT}:
                printf(\textcolor{stringliteral}{"%s = %f\(\backslash\)n"}, stringBuffer, \hyperlink{le__cfg__interface_8h_aeb213c2fbf840931ec8c1427ef6b317e}{le\_cfg\_GetFloat}(iteratorRef, \textcolor{stringliteral}{""}, 0.0));
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57da7f65f22b4f8a8baca2f3ac4087a09730}{LE\_CFG\_TYPE\_STRING}:
                printf(\textcolor{stringliteral}{"%s = "}, stringBuffer);
                \hyperlink{le__log_8h_ac0dbbef91dc0fed449d0092ff0557b39}{LE\_ASSERT}(\hyperlink{le__cfg__interface_8h_aabb24e6c90309be03ce5a285d5849658}{le\_cfg\_GetString}(iteratorRef,
                                           \textcolor{stringliteral}{""},
                                           stringBuffer,
                                           \textcolor{keyword}{sizeof}(stringBuffer),
                                           \textcolor{stringliteral}{""}) == \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK});
                printf(\textcolor{stringliteral}{"%s\(\backslash\)n"}, stringBuffer);
                \textcolor{keywordflow}{break};

            \textcolor{keywordflow}{case} \hyperlink{le__cfg__interface_8h_a29c8480b3310d1235487d7ea96d8b57da2eaa4a8ac9d9b37b4cdd9b43c0168d17}{LE\_CFG\_TYPE\_DOESNT\_EXIST}:
                printf(\textcolor{stringliteral}{"%s = ** DENIED **\(\backslash\)n"}, stringBuffer);
                \textcolor{keywordflow}{break};
        \}
    \}
    \textcolor{keywordflow}{while} (\hyperlink{le__cfg__interface_8h_aafcdb4bf55c14d960b7d16bb05af4bbe}{le\_cfg\_GoToNextSibling}(iteratorRef) == \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK});
\}


\hyperlink{le__cfg__interface_8h_a646829934bb23a878e19ade2c3e01eba}{le\_cfg\_IteratorRef\_t} iteratorRef = \hyperlink{le__cfg__interface_8h_aa766bff3a3ddbd2769b903fc56f6d9d2}{le\_cfg\_CreateReadTxn}(\textcolor{stringliteral}{"
      /path/to/my/location"});

PrintNode(iteratorRef);
\hyperlink{le__cfg__interface_8h_af5f10497ed85d2e647b41ca460228483}{le\_cfg\_CancelTxn}(iteratorRef);
\end{DoxyCode}
\hypertarget{c_config_cfg_transactWrite}{}\subsubsection{Writing Configuration Data}\label{c_config_cfg_transactWrite}
This code sample uses a write transaction to update a target\textquotesingle{}s I\+P address so the data is written atomically.


\begin{DoxyCode}
\textcolor{keywordtype}{void} SetIp4Static
(
    \hyperlink{le__cfg__interface_8h_a646829934bb23a878e19ade2c3e01eba}{le\_cfg\_IteratorRef\_t} iteratorRef,
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* interfaceNamePtr,
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* ipAddrPtr,
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* netMaskPtr
)
\{
    \textcolor{comment}{// Change current tree position to the base ip4 node.}
    \textcolor{keywordtype}{char} nameBuffer[MAX\_CFG\_STRING] = \{ 0 \};

    sprintf(nameBuffer, \textcolor{stringliteral}{"/system/%s/ip4"}, interfaceNamePtr);

    \hyperlink{le__cfg__interface_8h_a3a8519b471bc6f4a5fea3716636dc607}{le\_cfg\_GoToNode}(iteratorRef, nameBuffer);

    \hyperlink{le__cfg__interface_8h_a741ade500cc7b10070e45065740d6980}{le\_cfg\_SetString}(iteratorRef, \textcolor{stringliteral}{"addr"}, ipAddrPtr);
    \hyperlink{le__cfg__interface_8h_a741ade500cc7b10070e45065740d6980}{le\_cfg\_SetString}(iteratorRef, \textcolor{stringliteral}{"mask"}, netMaskPtr);

    \hyperlink{le__cfg__interface_8h_a9825af4d2e007d82f4385ee444a348ef}{le\_cfg\_CommitTxn}(iteratorRef);
\}
\end{DoxyCode}
\hypertarget{c_config_cfg_transactRead}{}\subsubsection{Reading Configuration Data}\label{c_config_cfg_transactRead}
This is a code sample of a read transaction.


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} GetIp4Static
(
    \hyperlink{le__cfg__interface_8h_a646829934bb23a878e19ade2c3e01eba}{le\_cfg\_IteratorRef\_t} iteratorRef,
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* interfaceNamePtr,
    \textcolor{keywordtype}{char}* ipAddrPtr,
    \textcolor{keywordtype}{size\_t} ipAddrSize,
    \textcolor{keywordtype}{char}* netMaskPtr,
    \textcolor{keywordtype}{size\_t} netMaskSize
)
\{
    \textcolor{comment}{// Change current tree position to the base ip4 node.}
    \textcolor{keywordtype}{char} nameBuffer[MAX\_CFG\_STRING] = \{ 0 \};

    sprintf(nameBuffer, \textcolor{stringliteral}{"/system/%s/ip4"}, interfaceNamePtr);

    \textcolor{keywordflow}{if} (\hyperlink{le__cfg__interface_8h_a33d4fbe741e6a6ff5377f60e8754d1e4}{le\_cfg\_NodeExists}(iteratorRef, nameBuffer) == \textcolor{keyword}{false})
    \{
        \hyperlink{le__log_8h_a0201b2f60ee0e945479f91e181bf04b6}{LE\_WARN}(\textcolor{stringliteral}{"Configuration not found."});
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca77a7505b0443df2fa1bab375c7267637}{LE\_NOT\_FOUND};
    \}

    \hyperlink{le__cfg__interface_8h_a3a8519b471bc6f4a5fea3716636dc607}{le\_cfg\_GoToNode}(iteratorRef, nameBuffer);

    \hyperlink{le__cfg__interface_8h_aabb24e6c90309be03ce5a285d5849658}{le\_cfg\_GetString}(iteratorRef, \textcolor{stringliteral}{"addr"}, ipAddrPtr, ipAddrSize, \textcolor{stringliteral}{""});
    \hyperlink{le__cfg__interface_8h_aabb24e6c90309be03ce5a285d5849658}{le\_cfg\_GetString}(iteratorRef, \textcolor{stringliteral}{"mask"}, netMaskPtr, netMaskSize, \textcolor{stringliteral}{""});

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}
\end{DoxyCode}
\hypertarget{c_config_cfg_quick}{}\subsubsection{Working without Transactions}\label{c_config_cfg_quick}
It\textquotesingle{}s possible to ignore iterators and transactions entirely (e.\+g., if all you need to do is read or write some simple values in the tree).

The non-\/transactional reads and writes work almost identically to the transactional versions. They just don\textquotesingle{}t explictly take an iterator object. The \char`\"{}quick\char`\"{} functions internally use an implicit transaction. This implicit transaction wraps one get or set, and does not protect your code from other activity in the system.

Because these functions don\textquotesingle{}t take an explicit transaction, they can\textquotesingle{}t work with relative paths. If a relative path is given, the path will be considered relative to the tree\textquotesingle{}s root.

Translating this to a \char`\"{}quick\char`\"{} (non-\/transactional) example looks like this\+:


\begin{DoxyCode}
\textcolor{keywordtype}{void} ClearIpInfo
(
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* interfaceNamePtr
)
\{
    \textcolor{keywordtype}{char} pathBuffer[MAX\_CFG\_STRING] = \{ 0 \};

    sprintf(pathBuffer, \textcolor{stringliteral}{"/system/%s/ip4/"}, interfaceNamePtr);
    \hyperlink{le__cfg__interface_8h_a95f44c1e0d16eb48475465af63300a75}{le\_cfg\_QuickDeleteNode}(pathBuffer);
\}
\end{DoxyCode}


\begin{DoxyNote}{Note}
Because each read is independant, there\textquotesingle{}s no guarantee of consistency between them. If another process changes one of the values while you read/write the other, the two values could be read out of sync.
\end{DoxyNote}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{configTreePage}{}\subsection{Config Tree Entries}\label{configTreePage}
~\newline


Here are some parameters for modem services config trees\+:\hypertarget{config_tree_page_cellnetConfigTree}{}\subsubsection{Cellular Network Service}\label{config_tree_page_cellnetConfigTree}
Configuration for the \hyperlink{c_le_cellnet}{Cellular Network} Service. The configuration database path for the S\+I\+M is\+: \begin{DoxyVerb} /
     modemServices/
         sim/
             1/
                 pin<string> == <PIN_CODE>\end{DoxyVerb}



\begin{DoxyItemize}
\item \textquotesingle{}1\textquotesingle{} is the sim slot number that \hyperlink{le__sim__interface_8h_a4c9e3ded0485f14c66e4d51763f2de57}{le\+\_\+sim\+\_\+\+Get\+Selected\+Card()} is returning.
\item \textquotesingle{}P\+I\+N\+\_\+\+C\+O\+D\+E\textquotesingle{} is the P\+I\+N code for the S\+I\+M card.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
when a new S\+I\+M is inserted and \+:
\begin{DoxyItemize}
\item is locked, Cellular Network Service will read automatically the config D\+B in order to try to enter the pin for the S\+I\+M card.
\item is blocked, Cellular Network Service just log an error and did not try to enter the puk code.
\end{DoxyItemize}
\end{DoxyNote}
Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. ~\newline
\hypertarget{config_tree_page_mbxConfigTree}{}\subsubsection{S\+M\+S Inbox Service}\label{config_tree_page_mbxConfigTree}
Configuration for the \hyperlink{c_smsInbox}{S\+M\+S Inbox Service} Service. ~\newline
 The configuration database path for the S\+M\+S Inbox Service is\+: \begin{DoxyVerb}/
    smsInbox/
        apps/
            appA<uint> = <# of messages>
            appB<uint> = <# of messages>
\end{DoxyVerb}


Each app have its own inbox, containing its own list of messages. The maximum number of messages is specified for each inbox. If the message box is not configured, a default number of 10 messages is applied (only for message boxes configured in le\+\_\+sms\+Inbox\+\_\+mbox\+Name\mbox{[}\mbox{]} area).

The application name is given by the A\+P\+I name provided into the Components.\+cdef, both must be the same.

~\newline
\hypertarget{config_tree_page_ecallConfigTree}{}\subsubsection{e\+Call}\label{config_tree_page_ecallConfigTree}
Configuration for the \hyperlink{c_ecall}{e\+Call} Service. ~\newline
 The configuration database path for the e\+Call is\+: \begin{DoxyVerb}/
    modemServices/
        eCall/
            systemStandard<string> = <eCall system>
            msdVersion<int> = <MSD value>
            vehicleType<string> = <vehicle type>
            vin<string> = <VIN>
            propulsionType/
                0<string> = <propulsion type>
                1<string> = <propulsion type>
                ...
\end{DoxyVerb}


The \textquotesingle{}system\+Standard\textquotesingle{} is the kind of e\+Call system\+:
\begin{DoxyItemize}
\item P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N
\item E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S
\end{DoxyItemize}

If no value or a bad entry is filled, the default value is \textquotesingle{}P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N\textquotesingle{}.

The \textquotesingle{}msd\+Version\textquotesingle{} field is the M\+S\+D format version. If the field is not present, the default M\+S\+D version is version 1.

The \textquotesingle{}vehicle\+Type\textquotesingle{} field can be set with the following choices (string type)\+:
\begin{DoxyItemize}
\item \char`\"{}\+Passenger-\/\+M1\char`\"{} (Passenger vehicle, Class M1)
\item \char`\"{}\+Bus-\/\+M2\char`\"{} (Buses and coaches, Class M2)
\item \char`\"{}\+Bus-\/\+M3\char`\"{} (Buses and coaches, Class M3)
\item \char`\"{}\+Commercial-\/\+N1\char`\"{} (Light commercial vehicles, Class N1)
\item \char`\"{}\+Heavy-\/\+N2\char`\"{} (Heavy duty vehicles, Class N2)
\item \char`\"{}\+Heavy-\/\+N3\char`\"{} (Heavy duty vehicles, Class N3)
\item \char`\"{}\+Motorcycle-\/\+L1e\char`\"{} (Motorcycles, Class L1e)
\item \char`\"{}\+Motorcycle-\/\+L2e\char`\"{} (Motorcycles, Class L2e)
\item \char`\"{}\+Motorcycle-\/\+L3e\char`\"{} (Motorcycles, Class L3e)
\item \char`\"{}\+Motorcycle-\/\+L4e\char`\"{} (Motorcycles, Class L4e)
\item \char`\"{}\+Motorcycle-\/\+L5e\char`\"{} (Motorcycles, Class L5e)
\item \char`\"{}\+Motorcycle-\/\+L6e\char`\"{} (Motorcycles, Class L6e)
\item \char`\"{}\+Motorcycle-\/\+L7e\char`\"{} (Motorcycles, Class L7e)
\end{DoxyItemize}

The \textquotesingle{}vin\textquotesingle{} is the vehicle identification number (string type).

The \textquotesingle{}propulsion\+Type\textquotesingle{} field can be set with the following choices (string type)\+:
\begin{DoxyItemize}
\item \char`\"{}\+Gasoline\char`\"{} (Gasoline propulsion)
\item \char`\"{}\+Diesel\char`\"{} (Diesel propulsion)
\item \char`\"{}\+Natural\+Gas\char`\"{} (Compressed natural gas propulsion)
\item \char`\"{}\+Propane\char`\"{} (Liquid propane gas propulsion)
\item \char`\"{}\+Electric\char`\"{} (Electric propulsion)
\item \char`\"{}\+Hydrogen\char`\"{} (Hydrogen propulsion)
\item \char`\"{}\+Other\char`\"{} (Other type of propulsion)
\end{DoxyItemize}

Several \textquotesingle{}propulsion\+Type\textquotesingle{} can be applied.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. ~\newline
\hypertarget{config_tree_page_posConfigTree}{}\subsubsection{Positioning}\label{config_tree_page_posConfigTree}
Configuration for the \hyperlink{c_pos}{Positioning} Service. ~\newline
 The configuration database path for Positioning is\+: \begin{DoxyVerb}/
    positioning/
        acquisitionRate<int> == 5
\end{DoxyVerb}



\begin{DoxyItemize}
\item \textquotesingle{}acquisition\+Rate\textquotesingle{} is the fix acquisition rate in seconds.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
If there is no configuration for \textquotesingle{}acquisition\+Rate\textquotesingle{}, it will be automatically set to 5 seconds. ~\newline

\end{DoxyNote}
\hypertarget{config_tree_page_avcServiceConfigTree}{}\subsubsection{Air\+Vantage Service}\label{config_tree_page_avcServiceConfigTree}
Configuration for the \hyperlink{c_le_avc}{Air\+Vantage Connector} Service. ~\newline
 The configuration database path for the modem\+Activity\+Timeout is\+: \begin{DoxyVerb}/
    apps/
        avcService/
                 modemActivityTimeout
\end{DoxyVerb}


After an Air\+Vantage session is started, if there\textquotesingle{}s no activity from the modem within the timer interval, then L\+E\+\_\+\+A\+V\+C\+\_\+\+N\+O\+\_\+\+U\+P\+D\+A\+T\+E state will be returned to the app. However, this modem activity timeout can be overridden by setting an integer value at /apps/avc\+Service/modem\+Activity\+Timeout. The modem activity timer is initialized only when the avc\+Service starts. If a valid entry $>$0 is found, then it will be used instead of the default value of 20 seconds. The following steps should be used to set the modem\+Activty\+Timeout.

\begin{DoxyVerb}config set /apps/avcService/modemActivityTimeout xx
app restart avcService
\end{DoxyVerb}


\begin{DoxyNote}{Note}
Everytime a new value is written to modem\+Activity\+Timeout, the avc\+Service needs to be restarted to read the new value. ~\newline

\end{DoxyNote}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_configAdmin}{}\subsection{Config Tree Admin A\+P\+I}\label{c_configAdmin}
\hyperlink{le__cfg_admin__interface_8h}{A\+P\+I Reference}

This A\+P\+I includes functions for importing and exporting subsections of the config tree to and from a file.

This A\+P\+I also includes an iterator object that can be used to iterate over the list of trees currently known by the system.

An example of printing the list of trees in a system\+:


\begin{DoxyCode}
\hyperlink{le__cfg_admin__interface_8h_a4349aae258f9dcf1fe96729dc2800157}{le\_cfgAdmin\_IteratorRef\_t} iteratorRef = 
      \hyperlink{le__cfg_admin__interface_8h_a3c6027ce6449d80b4136397109f174f8}{le\_cfgAdmin\_CreateTreeIterator}();

\textcolor{keywordflow}{while} (\hyperlink{le__cfg_admin__interface_8h_a4309cd7fd95b7ea95a4bea40bee7fdf7}{le\_cfgAdmin\_NextTree}(iteratorRef) == \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
\{
   \textcolor{keywordtype}{char} treeName[MAX\_TREE\_NAME] = \{ 0 \};

   \textcolor{keywordflow}{if} (\hyperlink{le__cfg_admin__interface_8h_add1f28ab26d32028bf2e63c8a050f78b}{le\_cfgAdmin\_GetTreeName}(iteratorRef, treeName, \textcolor{keyword}{sizeof}(treeName)) == 
      \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
   \{
       printf(\textcolor{stringliteral}{"Tree: \(\backslash\)"%s\(\backslash\)"\(\backslash\)n"}, treeName);
   \}
   \textcolor{keywordflow}{else}
   \{
       printf(\textcolor{stringliteral}{"Tree: \(\backslash\)"%s\(\backslash\)", truncated.\(\backslash\)n"}, treeName);
   \}
\}

\hyperlink{le__cfg_admin__interface_8h_a9077c6fe37d2bff7414f7a4f49c17158}{le\_cfgAdmin\_ReleaseTreeIterator}(iteratorRef);
\end{DoxyCode}






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_data}{}\section{Data Connection}\label{c_le_data}
\hyperlink{le__data__interface_8h}{A\+P\+I Reference}





A data connection is needed for applications that exchange data with devices where S\+M\+S messages are insufficient or not possible. The data connection can be over a mobile network, over Wi-\/\+Fi, or over a fixed link (e.\+g., Ethernet).

The data connection service provides a basic A\+P\+I for requesting and releasing a data connection.\hypertarget{c_le_data_le_data_binding}{}\subsection{I\+P\+C interfaces binding}\label{c_le_data_le_data_binding}
All the functions of this A\+P\+I are provided by the {\bfseries data\+Connection\+Service} application service.

Here\textquotesingle{}s a code sample binding to Data Connection services\+: \begin{DoxyVerb} bindings:
 {
    clientExe.clientComponent.le_data -> dataConnectionService.le_data
 }\end{DoxyVerb}
\hypertarget{c_le_data_c_le_data_default}{}\subsection{Default Data Connection}\label{c_le_data_c_le_data_default}
Default data connection is obtained using \hyperlink{le__data__interface_8h_afb9db0acdd98620cb0cd303bee8a817c}{le\+\_\+data\+\_\+\+Request()}. Before the data connection is requested, an application registers a connection state handler using \hyperlink{le__data__interface_8h_aebd3fc58774ed3f5a11f70d2317837dd}{le\+\_\+data\+\_\+\+Add\+Connection\+State\+Handler()}. Once the data connection is established, the handler will be called indicating it\textquotesingle{}s now connected. If the state of the data connection changes, then the handler will be called with the new state. To release a data connection, an application can use \hyperlink{le__data__interface_8h_a1dc7cd8faed6b1ee02ea947cf02b8ee7}{le\+\_\+data\+\_\+\+Release()}.

If the default data connection is not currently available when \hyperlink{le__data__interface_8h_afb9db0acdd98620cb0cd303bee8a817c}{le\+\_\+data\+\_\+\+Request()} is called, the data connection service first ensures all pre-\/conditions are satisfied (e.\+g., modem is registered on the network), before trying to start the data connection.

If the default data connection is already available when \hyperlink{le__data__interface_8h_afb9db0acdd98620cb0cd303bee8a817c}{le\+\_\+data\+\_\+\+Request()} is called, a new connection will not be started. Instead, the existing data connection will be used. This happens if another application also requested the default data connection. This is how multiple applications can share the same data connection.

Once an application makes a data connection request, it should monitor the connection state reported to the registered connection state handler. The application should only try transmitting data when the state is connected, and should stop transmitting data when the state is not connected. If the state is not connected, the data connection service will try to re-\/establish the connection. There\textquotesingle{}s no need for an application to issue a new connection request.

The default data connection will not necessarily be released when an application calls \hyperlink{le__data__interface_8h_a1dc7cd8faed6b1ee02ea947cf02b8ee7}{le\+\_\+data\+\_\+\+Release()}. The data connection will be released only after le\+\_\+data\+\_\+\+Release is called by all applications that previously called \hyperlink{le__data__interface_8h_afb9db0acdd98620cb0cd303bee8a817c}{le\+\_\+data\+\_\+\+Request()}.

All configuration data required for the default data connection, like the Access Point Name (A\+P\+N), will be stored in the Config database.\hypertarget{c_le_data_c_le_data_configdb}{}\subsection{Configuration tree}\label{c_le_data_c_le_data_configdb}
The configuration database path for the Data Connection Service is\+: \begin{DoxyVerb} /
     dataConnectionService/
         prefTech<string> == <technology>\end{DoxyVerb}


\textquotesingle{}pref\+Tech\textquotesingle{} is the preferred technology used for the data connection service. It can be set with the following choices (string type)\+:
\begin{DoxyItemize}
\item \char`\"{}wifi\char`\"{}
\item \char`\"{}ethernet\char`\"{}
\item \char`\"{}cellular\char`\"{}
\end{DoxyItemize}

For example, with \char`\"{}cellular\char`\"{}, the D\+C\+S will load a profile regarding a policy. If the A\+P\+N is empty the D\+C\+S will read a configuration file (Containing all A\+P\+N for M\+C\+C/\+M\+N\+C) to fill the A\+P\+N regarding the M\+C\+C,M\+N\+C (provided by the I\+M\+S\+I code).

\begin{DoxyNote}{Note}
Only \char`\"{}cellular\char`\"{} choice is available in the present version.

Profile selection policy is not yet implemented. The first found profile of the selected technology is loaded in the present version.
\end{DoxyNote}
\hypertarget{c_le_data_c_le_data_options}{}\subsection{Data Connection Options}\label{c_le_data_c_le_data_options}
\begin{DoxyNote}{Note}
Functionality described in this section is not currently implemented; this description is provided to outline future functionality.
\end{DoxyNote}
Some applications may have data connection requirements that are not met by the default data connection (e.\+g., use a least cost data link or disable roaming on mobile networks). You can do this by\+:
\begin{DoxyItemize}
\item creating a request object using le\+\_\+data\+\_\+\+Create\+Request(),
\item setting optional values on that request object using le\+\_\+data\+\_\+\+Select\+Least\+Cost() or le\+\_\+data\+\_\+\+Disable\+Roaming(),
\item and then submitting that object to a data connection request using le\+\_\+data\+\_\+\+Submit\+Request
\end{DoxyItemize}

\hyperlink{le__data__interface_8h_aebd3fc58774ed3f5a11f70d2317837dd}{le\+\_\+data\+\_\+\+Add\+Connection\+State\+Handler()} and \hyperlink{le__data__interface_8h_a1dc7cd8faed6b1ee02ea947cf02b8ee7}{le\+\_\+data\+\_\+\+Release()} A\+P\+Is can continue to be used, as described above.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_gpio}{}\section{G\+P\+I\+O A\+P\+I}\label{c_gpio}
\hyperlink{le__gpio__interface_8h}{A\+P\+I Reference}





Used by apps to control general-\/purpose digital input/output pins.

A G\+P\+I\+O pin typically has one or more of the following features\+:
\begin{DoxyItemize}
\item Can be configured as an input pin or an output pin.
\item Can have an internal pull-\/up resistor or pull-\/down resistor enabled, or neither.
\item If an output, can be push-\/pull or open-\/drain.
\item If an input, can trigger an \char`\"{}interrupt\char`\"{} (asynchronous notification of state change).
\end{DoxyItemize}

Output pins can be driven in three different modes\+:
\begin{DoxyItemize}
\item Push-\/pull\+: A transistor connects to the supply and another transistor connects to ground (only one is operated at a time)
\item Tri-\/state\+: Same as push-\/pull, with an added high-\/impedance (high Z) state, in which the pin is essentially disconnected from both ground and supply.
\item Open drain\+: A transistor connects to ground and nothing else. Can only be used to pull low.
\end{DoxyItemize}

In addition, pins have a \char`\"{}polarity\char`\"{}.
\begin{DoxyItemize}
\item An {\bfseries  active-\/high } polarity pin is read/written as a digital 1 (true) when its voltage is \char`\"{}high\char`\"{} and 0 (false) when its voltage is \char`\"{}low\char`\"{} (grounded).
\item An {\bfseries  active-\/low } pin is read/written as a digital 1 (true) when its voltage is \char`\"{}low\char`\"{} (grounded) and 0 (false) when its voltage is \char`\"{}high\char`\"{}.
\end{DoxyItemize}

The following functions are used to configure the G\+P\+I\+O pin\+:
\begin{DoxyItemize}
\item Set\+Input() -\/ Configure as an input pin.
\item Set\+Push\+Pull\+Output() -\/ Configure as push-\/pull output pin (can drive high or low).
\item Set\+Tri\+State\+Output() -\/ Configure as tri-\/state output pin (can drive high or low or neither).
\item Set\+Open\+Drain\+Output() -\/ Configure as open-\/drain output pin (only pulls low).
\item Enable\+Pull\+Up() -\/ Enables the internal pull-\/up resistor (and disables the pull-\/down).
\item Enable\+Pull\+Down() -\/ Enables the internal pull-\/down resistor (and disables the pull-\/up).
\item Disable\+Resistors() -\/ Disables the internal pull-\/up/down resistors.
\end{DoxyItemize}

To set the level of an output pin, call Activate(), Deactivate(), or Set\+High\+Z().

To poll the value of an input pin, call Read().

Use Set\+Change\+Callback() to register a notification callback function to be called when the state of an input pin changes.

Each G\+P\+I\+O pin is accessed through a single I\+P\+C service. This makes it possible to use bindings to control which G\+P\+I\+O pins each app is allowed to access. It also simplifies the A\+P\+I by removing the need to specify which pin is desired and allows the pins to be named differently in the client and the server, so the client can be more portable.

Binding example\+:

\begin{DoxyVerb}bindings:
{
    ui.frontPanel.powerLed -> cf3.pin22
}
\end{DoxyVerb}






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_limit}{}\section{Limit Definitions}\label{c_limit}
\hyperlink{le__limit__interface_8h}{A\+P\+I Reference}

This file defines limit definitions used by other A\+P\+Is.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesModem}{}\section{Modem}\label{legatoServicesModem}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{c_adc}{A\+D\+C Channel A\+P\+I} &Analog to digital converter &\PBS\centering \\\cline{1-3}
\hyperlink{c_antenna}{Antenna Monitoring} &Antenna diagnostics &\PBS\centering \\\cline{1-3}
\hyperlink{c_ecall}{e\+Call} &E\+U auto accident assistance program &\PBS\centering \\\cline{1-3}
\hyperlink{c_ips}{Input Power Supply Monitoring A\+P\+I} &Input voltage data &\PBS\centering  \\\cline{1-3}
\hyperlink{c_mcc}{Modem Call Control} &Control voice calls &\PBS\centering \\\cline{1-3}
\hyperlink{c_mdc}{Modem Data Control} &Control modem data connections &\PBS\centering \\\cline{1-3}
\hyperlink{c_info}{Modem Information} &Retrieve modem data information &\PBS\centering \\\cline{1-3}
\hyperlink{c_mrc}{Modem Radio Control} &Modem radio controls &\PBS\centering \\\cline{1-3}
\hyperlink{c_riPin}{Ring Indicator Signal} &Ring indicator for host wakeup &\PBS\centering \\\cline{1-3}
\hyperlink{c_rtc}{User Timebase} &Set user timebase for R\+T\+C &\PBS\centering \\\cline{1-3}
\hyperlink{c_sim}{S\+I\+M} &S\+I\+M access &\PBS\centering \\\cline{1-3}
\hyperlink{c_temp}{Temperature Monitoring} &Platform/radio temperature data &\PBS\centering \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_adc}{}\subsection{A\+D\+C Channel A\+P\+I}\label{c_adc}
\hyperlink{le__adc__interface_8h}{A\+P\+I Reference}





This A\+P\+I provides definitions for reading A\+D\+C inputs.

\hyperlink{le__adc__interface_8h_a9ba93ebff4dbb6f387bfe9567f65ec46}{le\+\_\+adc\+\_\+\+Read\+Value()} returns the value read from an A\+D\+C channel. It takes two arguments\+:
\begin{DoxyItemize}
\item The first is the number of the A\+D\+C channel to read.
\item The second is used to return the value read.
\end{DoxyItemize}

The A\+D\+C channels are multiplexed to a single Analog to Digital Converter. A call to \hyperlink{le__adc__interface_8h_a9ba93ebff4dbb6f387bfe9567f65ec46}{le\+\_\+adc\+\_\+\+Read\+Value()} will cause the associated channel to be connected to the input of the A\+D\+C, trigger a conversion and return the value read.

At this time it is not possible to change the scaling factor, sample time or reference voltage. Channels E\+X\+T\+\_\+\+A\+D\+C1 and E\+X\+T\+\_\+\+A\+D\+C2 are externally available for general use and by default use 1.\+8\+V reference and return results in m\+V.

\begin{DoxyWarning}{Warning}
Ensure to check the list of supported A\+D\+C channels on your specific platform before calling the \hyperlink{le__adc__interface_8h_a9ba93ebff4dbb6f387bfe9567f65ec46}{le\+\_\+adc\+\_\+\+Read\+Value()} function.
\end{DoxyWarning}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_antenna}{}\subsection{Antenna Monitoring}\label{c_antenna}
\hyperlink{le__antenna__interface_8h}{A\+P\+I Reference}





This file contains prototype definitions for the antenna diagnosis A\+P\+Is.\hypertarget{c_antenna_le_antenna_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_antenna_le_antenna_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service}.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}  bindings:
  {
     clientExe.clientComponent.le_antenna -> modemService.le_antenna
  }\end{DoxyVerb}
\hypertarget{c_antenna_le_antenna_cell_section}{}\subsubsection{Cellular or Diversity antenna}\label{c_antenna_le_antenna_cell_section}
\hypertarget{c_antenna_le_antenna_cell_diag_subsection}{}\paragraph{Diagnostics principle}\label{c_antenna_le_antenna_cell_diag_subsection}
This functionality allows to detect or not the presence of an antenna or to detect a defective antenna.

Antenna diagnosis is based on the following principle \+:

A very small D.\+C. current goes through the coaxial cable to the antenna. A resistive bridge is realized to provide different voltages depending on the antenna state.

It is mandatory to use a specific antenna. The antenna used have to be built with a resistor between radiating element and ground.

The states to diagnose are listed here\+:
\begin{DoxyItemize}
\item Antenna in open circuit\+: there is no antenna but R\+F open circuit
\item Antenna in close circuit\+: presence of antenna
\item Antenna in short circuit\+: with or without antenna, short circuit for R\+F path.
\end{DoxyItemize}\hypertarget{c_antenna_le_antenna_cell_thres_subsection}{}\paragraph{Thresholds}\label{c_antenna_le_antenna_cell_thres_subsection}
Configurable thresholds are compared to the A\+D\+C (Analog to Digital Converter) reading from the antenna diagnostic voltage to determine in which state the R\+F (Radio Frequency) is.

Two thresholds are set to decide the state\+: \begin{DoxyVerb}                          short limit                   open limit
  ---- short circuit ----|---- close circuit ----|---- open circuit ----
         unknown state      |   presence of antenna  |        no antenna
\end{DoxyVerb}


A short event is reported for the Cellular or Diversity antenna if the A\+D\+C value is lower than the corresponding short limit. An open event is reported for the Cellular or Diversity antenna if the A\+D\+C value is higher than the corresponding open limit.

\begin{DoxyNote}{Note}
The open threshold is always H\+I\+G\+H\+E\+R than the short threshold.
\end{DoxyNote}
\hypertarget{c_antenna_le_antenna_gnss_section}{}\subsubsection{G\+N\+S\+S antenna}\label{c_antenna_le_antenna_gnss_section}
\begin{DoxyWarning}{Warning}
Ensure to check the supported antenna diagnosis for your specific platform.
\end{DoxyWarning}
\hypertarget{c_antenna_le_antenna_gnss_diag_subsection}{}\paragraph{Diagnostics principle}\label{c_antenna_le_antenna_gnss_diag_subsection}
This functionality allows to detect or not the presence of an antenna or to detect a defective antenna.

The antenna diagnosis is based on the measurement of the current consumption for a G\+N\+S\+S active antenna. Moreover a current hardware protection circuitry is able to protect the power supply of that active antenna.

The states to diagnose are listed here\+:
\begin{DoxyItemize}
\item Antenna in short circuit\+: with or without antenna, short circuit for R\+F path.
\item Antenna in open circuit\+: there is no antenna but R\+F open circuit.
\item Antenna in close circuit\+: presence of antenna.
\item Antenna in over current \+: with or without antenna, short circuit for R\+F path and current hardware protection circuitry has tripped.
\end{DoxyItemize}\hypertarget{c_antenna_le_antenna_gnss_thre_subsection}{}\paragraph{Thresholds}\label{c_antenna_le_antenna_gnss_thre_subsection}
Configurable thresholds are compared to the A\+D\+C (Analog to Digital Converter) reading from the antenna diagnostic hardware design measuring the current to determine in which state the antenna is.

The following status are reported for the G\+N\+S\+S antenna if the A\+D\+C value is\+:
\begin{DoxyItemize}
\item S\+H\+O\+R\+T\+\_\+\+C\+I\+R\+C\+U\+I\+T\+: A\+D\+C value $>$ short limit, but over current H\+W not tripped.
\item C\+L\+O\+S\+E\+\_\+\+C\+I\+R\+C\+U\+I\+T\+: short limit $>$= A\+D\+C value $>$= open limit.
\item O\+P\+E\+N\+\_\+\+C\+I\+R\+C\+U\+I\+T\+: A\+D\+C value $<$ open limit.
\item O\+V\+E\+R\+\_\+\+C\+U\+R\+R\+E\+N\+T\+: antenna is shorted and current H\+W protection circuitry has tripped.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
The open threshold is always L\+O\+W\+E\+R than the short threshold.
\end{DoxyNote}
\hypertarget{c_antenna_le_antenna_gnss_diag_adc_selection}{}\subsubsection{Antenna diagnostic A\+D\+C selection}\label{c_antenna_le_antenna_gnss_diag_adc_selection}
\begin{DoxyWarning}{Warning}
Ensure to check the supported antenna diagnosis for your specific platform.
\end{DoxyWarning}
By default, the antenna diagnostics use an internal A\+D\+C for reading the voltage from the integrated antenna diagnosis circuit if any.

An antenna design that makes use of an external antenna diagnosis circuit can still take advantage of the antenna monitoring service. Using the function \hyperlink{le__antenna__interface_8h_a691370edf658b655a0f72b285dc5d00a}{le\+\_\+antenna\+\_\+\+Set\+External\+Adc()}, the module can be instructed to monitor one of the external A\+D\+C’s to read the voltage from an external antenna diagnosis circuit rather than the internal A\+D\+C. Moreover, the \hyperlink{le__antenna__interface_8h_a095510ac1da6efaf15db134321a012b3}{le\+\_\+antenna\+\_\+\+Get\+External\+Adc()} function reads the external A\+D\+C used to monitor the requested antenna.\hypertarget{c_antenna_API_desc}{}\subsubsection{A\+P\+I description}\label{c_antenna_API_desc}
\hyperlink{le__antenna__interface_8h_af768fcc154de42aecd549ff10e600a65}{le\+\_\+antenna\+\_\+\+Request()} A\+P\+I allows the application to monitor the requested antenna.

\hyperlink{le__antenna__interface_8h_a7df2d56b7f495fa32ed3fd2063ae0f9e}{le\+\_\+antenna\+\_\+\+Get\+Type()} A\+P\+I retrieves the antenna type from an antenna reference.

\hyperlink{le__antenna__interface_8h_a0ccc004b9cd6927614b5b37565117f7a}{le\+\_\+antenna\+\_\+\+Set\+Short\+Limit()} A\+P\+I sets the A\+D\+C value used to detect a short circuit.

\hyperlink{le__antenna__interface_8h_ade26bb9f34339b6fbd392460069bc8bc}{le\+\_\+antenna\+\_\+\+Get\+Short\+Limit()} A\+P\+I gets the A\+D\+C value used to detect a short circuit.

\hyperlink{le__antenna__interface_8h_a436108eac97dbe9b6857ddc364243a9f}{le\+\_\+antenna\+\_\+\+Set\+Open\+Limit()} A\+P\+I sets the A\+D\+C value used to detect an open circuit.

\hyperlink{le__antenna__interface_8h_a79a575dbf942be4830cb87ce15853c2b}{le\+\_\+antenna\+\_\+\+Get\+Open\+Limit()} A\+P\+I gets the A\+D\+C value used to detect an open circuit.

\hyperlink{le__antenna__interface_8h_af45f8554ec619e0bea2e17cc8ab5d348}{le\+\_\+antenna\+\_\+\+Add\+Status\+Event\+Handler()} A\+P\+I adds a handler to be notified when the requested antenna status changed.

\hyperlink{le__antenna__interface_8h_a76157a271abcca5197656077cddf24ea}{le\+\_\+antenna\+\_\+\+Remove\+Status\+Event\+Handler()} removes the antenna status handler.

\hyperlink{le__antenna__interface_8h_a8d183e0c6168566527bd233f3fb07802}{le\+\_\+antenna\+\_\+\+Get\+Status()} A\+P\+I gets the current antenna status.

\hyperlink{le__antenna__interface_8h_a691370edf658b655a0f72b285dc5d00a}{le\+\_\+antenna\+\_\+\+Set\+External\+Adc()} A\+P\+I sets the external A\+D\+C used to monitor the requested antenna.

\hyperlink{le__antenna__interface_8h_a095510ac1da6efaf15db134321a012b3}{le\+\_\+antenna\+\_\+\+Get\+External\+Adc()} A\+P\+I gets the external A\+D\+C used to monitor the requested antenna.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_ecall}{}\subsection{e\+Call}\label{c_ecall}
\hyperlink{le__ecall__interface_8h}{A\+P\+I Reference} ~\newline
 \hyperlink{howToEcall}{Manage e\+Call} ~\newline
 \hyperlink{sampleApps_eCall}{e\+Call} sample app





e\+Call is a technology initiative intended to bring rapid assistance to auto accidents anywhere in the European Union. When a serious vehicle accident occurs, sensors automatically trigger an e\+Call. When activated, the in-\/vehicle system (I\+V\+S) establishes a 112-\/voice connection.

The Mobile Network Operator handles the e\+Call like any other 112 call and routes the call to the most appropriate emergency response centre -\/ Public Safety Answering Point (P\+S\+A\+P).

At the same time, a digital \char`\"{}minimum set of data\char`\"{} (M\+S\+D) message is sent over the voice call using in-\/band modem signals. The M\+S\+D includes accident information like time, location, driving direction, and vehicle description.

The e\+Call can also be activated manually. The mobile network operator identifies that the 112 call is an e\+Call from the “e\+Call flag” inserted by the vehicle’s communication module.

This A\+P\+I applies for both P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N and E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S standards.

\begin{DoxyNote}{Note}
e\+Call service is only available on automotive products.
\end{DoxyNote}
\hypertarget{c_ecall_le_ecall_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_ecall_le_ecall_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service} service.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_ecall -> modemService.le_ecall
}
\end{DoxyVerb}
\hypertarget{c_ecall_le_ecall_operation}{}\subsubsection{Operation modes}\label{c_ecall_le_ecall_operation}
The modem can be configured to operate in three different operation modes\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a042d52c84b5b679ab32dd814c5b0be9e}{le\+\_\+ecall\+\_\+\+Force\+Only\+Mode()}\+: this function configures the e\+Call operation mode to e\+Call only, only emergency number can be used to start an e\+Call session. The modem doesn\textquotesingle{}t try to register on the Cellular network. This function forces the modem to behave as e\+Call only mode whatever U/\+S\+I\+M operation mode. The change doesn\textquotesingle{}t persist over power cycles. This function can be called before making an e\+Call.
\item \hyperlink{le__ecall__interface_8h_ad468828b0024de378d91ea9c30fd6f3f}{le\+\_\+ecall\+\_\+\+Force\+Persistent\+Only\+Mode()}\+: Same as \hyperlink{le__ecall__interface_8h_a042d52c84b5b679ab32dd814c5b0be9e}{le\+\_\+ecall\+\_\+\+Force\+Only\+Mode()}, but the change persists over power cycles.
\item \hyperlink{le__ecall__interface_8h_a924114fa7fab10c3f351766a76134f34}{le\+\_\+ecall\+\_\+\+Exit\+Only\+Mode()}\+: this function exits from e\+Call Only mode. It configures the e\+Call operation mode to Normal mode, the modem uses the default operation mode at power up (or after U/\+S\+I\+M hotswap). The modem behaves following the U/\+S\+I\+M e\+Call operation mode; for example the U/\+S\+I\+M can be configured only for e\+Call, or a combination of e\+Call and commercial service provision.
\item \hyperlink{le__ecall__interface_8h_a8e245065491b14f46405e415ea17b6b8}{le\+\_\+ecall\+\_\+\+Get\+Configured\+Operation\+Mode()}\+: this function allows the user to retrieve the configured Operation mode. The configured operation mode can be\+:
\begin{DoxyItemize}
\item {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+N\+O\+R\+M\+A\+L\+\_\+\+M\+O\+D\+E} \+: normal mode. The modem behaves following the U/\+S\+I\+M e\+Call operation mode.
\item {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+O\+N\+L\+Y\+\_\+\+M\+O\+D\+E} \+: e\+Call only mode according to U/\+S\+I\+M operation mode or forced by application through the \hyperlink{le__ecall__interface_8h_a042d52c84b5b679ab32dd814c5b0be9e}{le\+\_\+ecall\+\_\+\+Force\+Only\+Mode()} function.
\item {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+F\+O\+R\+C\+E\+D\+\_\+\+P\+E\+R\+S\+I\+S\+T\+E\+N\+T\+\_\+\+O\+N\+L\+Y\+\_\+\+M\+O\+D\+E} \+: persistent e\+Call only mode.
\end{DoxyItemize}
\end{DoxyItemize}\hypertarget{c_ecall_le_ecall_session}{}\subsubsection{e\+Call Session}\label{c_ecall_le_ecall_session}
Start an e\+Call session by creating an e\+Call object that calls \hyperlink{le__ecall__interface_8h_aad7fa3b34d9d72a2f1d4baa681ba25cc}{le\+\_\+ecall\+\_\+\+Create()}. Stop an e\+Call session with \hyperlink{le__ecall__interface_8h_a85800c86f9709fb7baa7219cc762181c}{le\+\_\+ecall\+\_\+\+End()}.

The type of e\+Call and the kind of activation are specified using different functions to start the e\+Call session\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_ab106c3ca87fc8dd8239d2849df932122}{le\+\_\+ecall\+\_\+\+Start\+Manual()}\+: initiate a manual e\+Call session (triggered by a passenger)
\item \hyperlink{le__ecall__interface_8h_aa25256eeacefcf00c14763ef294c7667}{le\+\_\+ecall\+\_\+\+Start\+Automatic()}\+: initiate an automatic e\+Call session (automatically triggered by the I\+V\+S in case of accident)
\item \hyperlink{le__ecall__interface_8h_aa5d23a1bea370b1ae29fc52d7a89d947}{le\+\_\+ecall\+\_\+\+Start\+Test()}\+: initiate a test e\+Call session (to test the communication between the I\+V\+S and the P\+S\+A\+P)
\end{DoxyItemize}

\begin{DoxyWarning}{Warning}
An application must wait for {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+E\+D} event before calling again the {\ttfamily le\+\_\+ecall\+\_\+\+Start\+Xxx()} functions.
\end{DoxyWarning}
When the e\+Call object is no longer needed, call \hyperlink{le__ecall__interface_8h_af1221deb68c46912748f65505b3e4919}{le\+\_\+ecall\+\_\+\+Delete()} to free all allocated resources associated with the object.

The current state of an e\+Call session can be queried using \hyperlink{le__ecall__interface_8h_a7881e794b9249222edde10f76d7663c9}{le\+\_\+ecall\+\_\+\+Get\+State()}. Alternatively, an application can register a handler be notified when the session state changes. The handler can be managed using \hyperlink{le__ecall__interface_8h_a453b64579f2884f1d26981bca38a201c}{le\+\_\+ecall\+\_\+\+Add\+State\+Change\+Handler()} and \hyperlink{le__ecall__interface_8h_a6be1fd10666da25882a2c6f78c82664d}{le\+\_\+ecall\+\_\+\+Remove\+State\+Change\+Handler()}.

An application can call \hyperlink{le__ecall__interface_8h_a771b2ef399a8fbf3b80c4eb11152c06a}{le\+\_\+ecall\+\_\+\+Get\+Termination\+Reason()} to know the reason of the call termination when call state is L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+S\+T\+A\+T\+E\+\_\+\+D\+I\+S\+C\+O\+N\+N\+E\+C\+T\+E\+D, and also \hyperlink{le__ecall__interface_8h_a8ffb7fb207537ea4574823285ebb6ca1}{le\+\_\+ecall\+\_\+\+Get\+Platform\+Specific\+Termination\+Code()} to get platform specific termination code (refer to your platform documentation for further details).\hypertarget{c_ecall_le_ecall_msd}{}\subsubsection{Minimum Set of Data (\+M\+S\+D)}\label{c_ecall_le_ecall_msd}
The dynamic values of the M\+S\+D can be set with\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a2b56b7b7fd7f936c144d30eba7815908}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Position()} sets the position of the vehicle.
\item \hyperlink{le__ecall__interface_8h_a8c009bb03d61dcd0ffbd9e986b692a85}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Passengers\+Count()} sets the number of passengers.
\end{DoxyItemize}

The M\+S\+D is automatically encoded with the dynamic values and the static values retrieved from the configuration tree each time those functions are called.

\begin{DoxyWarning}{Warning}
Those functions return a L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E error when the M\+S\+D has been already imported with \hyperlink{le__ecall__interface_8h_a85c4c3b921b9a6b0bc10f9400e58113e}{le\+\_\+ecall\+\_\+\+Import\+Msd()} function.
\end{DoxyWarning}
The M\+S\+D transmission mode can be set or get with\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a00d3dbc99884375cf2487d6640767c40}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Tx\+Mode()}
\item \hyperlink{le__ecall__interface_8h_a4319df67dc451fecb72e4e60ba7b6f6e}{le\+\_\+ecall\+\_\+\+Get\+Msd\+Tx\+Mode()}
\end{DoxyItemize}

The transmission mode can be\+:
\begin{DoxyItemize}
\item {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+T\+X\+\_\+\+M\+O\+D\+E\+\_\+\+P\+U\+S\+H} \+: the M\+S\+D is pushed by the I\+V\+S
\item {\ttfamily L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+T\+X\+\_\+\+M\+O\+D\+E\+\_\+\+P\+U\+L\+L} \+: the M\+S\+D is sent when requested by the P\+S\+A\+P
\end{DoxyItemize}

It\textquotesingle{}s possible to import a prepared M\+S\+D using the \hyperlink{le__ecall__interface_8h_a85c4c3b921b9a6b0bc10f9400e58113e}{le\+\_\+ecall\+\_\+\+Import\+Msd()} function. The prepared M\+S\+D must answer the requirements described in the \char`\"{}\+E\+N 15722\+:2013\char`\"{} publication (this publication has been prepared by Technical Committee C\+E\+N/\+T\+C 278 “\+Intelligent Transport Systems").

\begin{DoxyWarning}{Warning}
The imported M\+S\+D doesn\textquotesingle{}t take into account the values provided by the le\+\_\+ecall\+\_\+\+Set\+Msd\+Xxx() functions and the configuration tree. It overwrites any previous imported M\+S\+D or encoded M\+S\+D.

The imported M\+S\+D overwrites the control flags (automatic\+Activation and test\+Call) set by le\+\_\+ecall\+\_\+\+Start\+Xxx() functions (Manual, Automatic, Test). The User App is in charge of their correct settings.
\end{DoxyWarning}
The encoded M\+S\+D can be retrieved with \hyperlink{le__ecall__interface_8h_aebdb7744c37081fda6398031d3ee1198}{le\+\_\+ecall\+\_\+\+Export\+Msd()} function.

\begin{DoxyNote}{Note}
The User app must perform the M\+S\+D transmission by calling \hyperlink{le__ecall__interface_8h_a344e4c29208e576e81dda113f786529e}{le\+\_\+ecall\+\_\+\+Send\+Msd()} when the L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+S\+T\+A\+T\+E\+\_\+\+P\+S\+A\+P\+\_\+\+S\+T\+A\+R\+T\+\_\+\+I\+N\+D\+\_\+\+R\+E\+C\+E\+I\+V\+E\+D event is received. The M\+S\+D can be updated before calling \hyperlink{le__ecall__interface_8h_a344e4c29208e576e81dda113f786529e}{le\+\_\+ecall\+\_\+\+Send\+Msd()}, using the e\+\_\+ecall\+\_\+\+Import\+Msd() function or the le\+\_\+ecall\+\_\+\+Set\+Msd\+Xxx() functions.
\end{DoxyNote}
\hypertarget{c_ecall_le_ecall_concurrency}{}\subsubsection{Concurrency}\label{c_ecall_le_ecall_concurrency}
If another application tries to use the e\+Call service while a session is already in progress, the \hyperlink{le__ecall__interface_8h_ab106c3ca87fc8dd8239d2849df932122}{le\+\_\+ecall\+\_\+\+Start\+Manual()}, \hyperlink{le__ecall__interface_8h_aa25256eeacefcf00c14763ef294c7667}{le\+\_\+ecall\+\_\+\+Start\+Automatic()}, \hyperlink{le__ecall__interface_8h_aa5d23a1bea370b1ae29fc52d7a89d947}{le\+\_\+ecall\+\_\+\+Start\+Test()} functions will return a L\+E\+\_\+\+B\+U\+S\+Y error. The e\+Call session in progress won\textquotesingle{}t be interrupted or disturbed. The application can follow the session progress with \textquotesingle{}state\textquotesingle{} functions like \hyperlink{le__ecall__interface_8h_a7881e794b9249222edde10f76d7663c9}{le\+\_\+ecall\+\_\+\+Get\+State()} and \hyperlink{le__ecall__interface_8h_a453b64579f2884f1d26981bca38a201c}{le\+\_\+ecall\+\_\+\+Add\+State\+Change\+Handler()}. A manual e\+Call can\textquotesingle{}t interrupt an automatic e\+Call, and an automatic e\+Call can\textquotesingle{}t interrupt a manual e\+Call.\hypertarget{c_ecall_le_ecall_eraglonass}{}\subsubsection{E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S compliancy}\label{c_ecall_le_ecall_eraglonass}
To perform an emergency call following the E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S requirements, the \textquotesingle{}system\+Standard\textquotesingle{} entry of the configuration database must be set to \textquotesingle{}E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S\textquotesingle{}.

Moreover, the User can set some specific configuration settings in accordance with the P\+S\+A\+P configuration\+:


\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a15127a7b0500796257795aaf64acd1e2}{le\+\_\+ecall\+\_\+\+Set\+Era\+Glonass\+Manual\+Dial\+Attempts()}\+: set the M\+A\+N\+U\+A\+L\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S value. If a dial attempt under manual emergency call initiation failed, it should be repeated maximally E\+C\+A\+L\+L\+\_\+\+M\+A\+N\+U\+A\+L\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S-\/1 times within the maximal time limit of E\+C\+A\+L\+L\+\_\+\+D\+I\+A\+L\+\_\+\+D\+U\+R\+A\+T\+I\+O\+N. The default value is 10. Redial attempts stop once the call has been cleared down correctly, or if counter / timer reached their limits. Available for both manual and test modes.
\item \hyperlink{le__ecall__interface_8h_a836aaf195c0648d41f4a13f8c7ced736}{le\+\_\+ecall\+\_\+\+Set\+Era\+Glonass\+Auto\+Dial\+Attempts()}\+: set the A\+U\+T\+O\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S value. If a dial attempt under automatic emergency call initiation failed, it should be repeated maximally E\+C\+A\+L\+L\+\_\+\+A\+U\+T\+O\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S-\/1 times within the maximal time limit of E\+C\+A\+L\+L\+\_\+\+D\+I\+A\+L\+\_\+\+D\+U\+R\+A\+T\+I\+O\+N. The default value is 10. Redial attempts stop once the call has been cleared down correctly, or if counter / timer reached their limits.
\item \hyperlink{le__ecall__interface_8h_a6c934a9e5aad11eb6f009a6bf34fca19}{le\+\_\+ecall\+\_\+\+Set\+Era\+Glonass\+Dial\+Duration()}\+: set the E\+C\+A\+L\+L\+\_\+\+D\+I\+A\+L\+\_\+\+D\+U\+R\+A\+T\+I\+O\+N time. It is the maximum time the I\+V\+S have to connect the emergency call to the P\+S\+A\+P, including all redial attempts. If the call is not connected within this time (or Manual\+Dial\+Attempts/\+Auto\+Dial\+Attempts dial attempts), it will stop.
\end{DoxyItemize}

The corresponding getter functions let you retrieve the configuration settings values\+:


\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a579169dbcb91369caa156d2c0e3462c1}{le\+\_\+ecall\+\_\+\+Get\+Era\+Glonass\+Manual\+Dial\+Attempts()}\+: get the M\+A\+N\+U\+A\+L\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S value.
\item \hyperlink{le__ecall__interface_8h_af8beed56bd3be9bee8a771e05c498ac8}{le\+\_\+ecall\+\_\+\+Get\+Era\+Glonass\+Auto\+Dial\+Attempts()}\+: get the A\+U\+T\+O\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S value.
\item \hyperlink{le__ecall__interface_8h_afeb92d26dd8a2c092e96b07f3dc0391d}{le\+\_\+ecall\+\_\+\+Get\+Era\+Glonass\+Dial\+Duration()}\+: get the E\+C\+A\+L\+L\+\_\+\+D\+I\+A\+L\+\_\+\+D\+U\+R\+A\+T\+I\+O\+N time.
\end{DoxyItemize}\hypertarget{c_ecall_le_ecall_eraGlonassData}{}\subsubsection{E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S M\+S\+D additional data}\label{c_ecall_le_ecall_eraGlonassData}
E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S additional data are optional and provided in the M\+S\+D message if any. They are located in M\+S\+D data block number 12 as optional additional data.

E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S M\+S\+D additional data describes\+:
\begin{DoxyItemize}
\item The crash severity (Accident Severity Index -\/ A\+S\+I15)
\item The diagnostic result
\item The crash information
\end{DoxyItemize}

E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S M\+S\+D additional data can be specified through the following functions\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a577f3dcd16e53c8a14295ec58c6d2b9a}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Era\+Glonass\+Crash\+Severity()}.
\item \hyperlink{le__ecall__interface_8h_addb2874aacaffba2731354c4ac9428bf}{le\+\_\+ecall\+\_\+\+Reset\+Msd\+Era\+Glonass\+Crash\+Severity()}.
\item \hyperlink{le__ecall__interface_8h_a51ad61edf379cfe07f03fbd71b56df9d}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Era\+Glonass\+Diagnostic\+Result()}.
\item \hyperlink{le__ecall__interface_8h_ad3e06b90843a480d68dc99ead29ae8d0}{le\+\_\+ecall\+\_\+\+Reset\+Msd\+Era\+Glonass\+Diagnostic\+Result()}.
\item \hyperlink{le__ecall__interface_8h_a08c613df57d34eb2a1309738bced5d76}{le\+\_\+ecall\+\_\+\+Set\+Msd\+Era\+Glonass\+Crash\+Info()}.
\item \hyperlink{le__ecall__interface_8h_ab883aa41416ada9746acfbb75a0039a8}{le\+\_\+ecall\+\_\+\+Reset\+Msd\+Era\+Glonass\+Crash\+Info()}.
\end{DoxyItemize}

E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S additional data is encoded using the O\+I\+D version \char`\"{}1.\+4.\+1\char`\"{}. This was assigned to E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S optional additional data by C\+E\+N. Content of data block in the Additional\+Data should be\+:


\begin{DoxyCode}
ERAOADASN1Module
DEFINITIONS
AUTOMATIC TAGS ::=
BEGIN
ERADataFormatId::= INTEGER (1)

ERAAdditionalData ::= SEQUENCE \{
   crashSeverity INTEGER(0..2047) OPTIONAL,
   diagnosticResult DiagnosticResult OPTIONAL,
   crashInfo CrashInfo OPTIONAL,
   ...
\}

DiagnosticResult ::= SEQUENCE \{
   micConnectionFailure BOOLEAN OPTIONAL,
   micFailure BOOLEAN OPTIONAL,
   rightSpeakerFailure BOOLEAN OPTIONAL,
   leftSpeakerFailure BOOLEAN OPTIONAL,
   speakersFailure BOOLEAN OPTIONAL,
   ignitionLineFailure BOOLEAN OPTIONAL,
   uimFailure BOOLEAN OPTIONAL,
   statusIndicatorFailure BOOLEAN OPTIONAL,
   batteryFailure BOOLEAN OPTIONAL,
   batteryVoltageLow BOOLEAN OPTIONAL,
   crashSensorFailure BOOLEAN OPTIONAL,
   firmwareImageCorruption BOOLEAN OPTIONAL,
   commModuleInterfaceFailure BOOLEAN OPTIONAL,
   gnssReceiverFailure BOOLEAN OPTIONAL,
   raimProblem BOOLEAN OPTIONAL,
   gnssAntennaFailure BOOLEAN OPTIONAL,
   commModuleFailure BOOLEAN OPTIONAL,
   eventsMemoryOverflow BOOLEAN OPTIONAL,
   crashProfileMemoryOverflow BOOLEAN OPTIONAL,
   otherCriticalFailires BOOLEAN OPTIONAL,
   otherNotCriticalFailures BOOLEAN OPTIONAL
\}

CrashInfo ::= SEQUENCE \{
   crashFront BOOLEAN OPTIONAL,
   crashLeft BOOLEAN OPTIONAL,
   crashRight BOOLEAN OPTIONAL,
   crashRear BOOLEAN OPTIONAL,
   crashRollover BOOLEAN OPTIONAL,
   crashSide BOOLEAN OPTIONAL,
   crashFrontOrSide BOOLEAN OPTIONAL,
   crashAnotherType BOOLEAN OPTIONAL
\}
END
\end{DoxyCode}
\hypertarget{c_ecall_le_ecall_redial}{}\subsubsection{Redial management}\label{c_ecall_le_ecall_redial}
In the case of P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N, the redial can be performed as many times as desired but should be performed within 2 minutes. (E\+N 16062\+:2014 -\/7.\+14.\+3).

In the case of E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S, the redial can be performed E\+C\+A\+L\+L\+\_\+\+M\+A\+N\+U\+A\+L\+\_\+\+D\+I\+A\+L\+\_\+\+A\+T\+T\+E\+M\+P\+T\+S times within the maximal time limit of E\+C\+A\+L\+L\+\_\+\+D\+I\+A\+L\+\_\+\+D\+U\+R\+A\+T\+I\+O\+N (G\+O\+S\+T 54620 2013 – Appendix A).

The {\bfseries L\+E\+\_\+\+E\+C\+A\+L\+L\+\_\+\+S\+T\+A\+T\+E\+\_\+\+E\+N\+D\+\_\+\+O\+F\+\_\+\+R\+E\+D\+I\+A\+L\+\_\+\+P\+E\+R\+I\+O\+D} state event notifies the User of the redial period end.\hypertarget{c_ecall_le_ecall_samples}{}\subsubsection{Code sample}\label{c_ecall_le_ecall_samples}
The following code sample shows how an e\+Call session is used\+:


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} TriggerAutomaticEcall
(
    uint32\_t    paxCount,
    int32\_t     latitude,
    int32\_t     longitude,
    int32\_t     direction
)
\{
    \textcolor{comment}{// Create the eCall Session}
    \hyperlink{le__ecall__interface_8h_a8536728653b7b3cdd6b298c6e7b67705}{le\_ecall\_CallRef\_t} eCallRef = \hyperlink{le__ecall__interface_8h_aad7fa3b34d9d72a2f1d4baa681ba25cc}{le\_ecall\_Create}();

    \textcolor{comment}{// Set the dynamic MSD values, the static values are retrieved from the config tree}
    \hyperlink{le__ecall__interface_8h_a2b56b7b7fd7f936c144d30eba7815908}{le\_ecall\_SetMsdPosition}(eCallRef,
                            \textcolor{keyword}{true},
                            latitude,
                            longitude,
                            direction);
    \hyperlink{le__ecall__interface_8h_a8c009bb03d61dcd0ffbd9e986b692a85}{le\_ecall\_SetMsdPassengersCount}(eCallRef, paxCount);

    \textcolor{comment}{// Start the eCall session}
    \hyperlink{le__ecall__interface_8h_aa25256eeacefcf00c14763ef294c7667}{le\_ecall\_StartAutomatic}(eCallRef);
\}
\end{DoxyCode}


If you want to have a look at a more in-\/depth usage of these A\+P\+Is, please refer to the c\+\_\+ecall\+App\+Main .\hypertarget{c_ecall_le_ecall_configuration}{}\subsubsection{e\+Call configuration}\label{c_ecall_le_ecall_configuration}
By default, the number to dial is read from the F\+D\+N/\+S\+D\+N (Fixed Dialling Numbers/\+Service Dialling Numbers) of the U/\+S\+I\+M, depending upon the e\+Call operating mode.

However, the P\+S\+A\+P telephone number can be specified and retrieved with\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a9c13a8582bca84c4ae77643e1f4cfd71}{le\+\_\+ecall\+\_\+\+Set\+Psap\+Number()}
\item \hyperlink{le__ecall__interface_8h_a91c84ca3f4bb27844bfd2d14859bf31a}{le\+\_\+ecall\+\_\+\+Get\+Psap\+Number()}
\end{DoxyItemize}

\begin{DoxyNote}{Note}
Important! These two functions don\textquotesingle{}t modified the U/\+S\+I\+M content nor read the U/\+S\+I\+M content.
\end{DoxyNote}
\hyperlink{le__ecall__interface_8h_a034c442fd7c6650ed956822a561c0104}{le\+\_\+ecall\+\_\+\+Use\+U\+Sim\+Numbers()} function can be recalled to indicate the modem to read the number to dial from the F\+D\+N/\+S\+D\+N of the U/\+S\+I\+M, depending upon the e\+Call operating mode.

The N\+A\+D (Network Access Device, i.\+e. the Modem) deregistration time value can be set or get with\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_a66e454e84db7d337d76bc867b57891a1}{le\+\_\+ecall\+\_\+\+Set\+Nad\+Deregistration\+Time()}
\item \hyperlink{le__ecall__interface_8h_a0f24b673049d51baf132ace25e2fa161}{le\+\_\+ecall\+\_\+\+Get\+Nad\+Deregistration\+Time()}
\end{DoxyItemize}

Time is set in hours where\+:
\begin{DoxyItemize}
\item from 1 to 60 minutes -\/$>$ 1 hour
\item from 61 to 120 minutes -\/$>$ 2hours, etc.
\end{DoxyItemize}

Example\+: if {\ttfamily dereg\+Time} parameter unit is minutes, the effective time is\+: 
\begin{DoxyCode}
ECallConfiguration.nad\_deregistration\_time = (deregTime+59)/60; 
\end{DoxyCode}


After termination of an emergency call the in-\/vehicle system remains registered on the network for the period of time, defined by the installation parameter \textquotesingle{}N\+A\+D\+\_\+\+D\+E\+R\+E\+G\+I\+S\+T\+R\+A\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\textquotesingle{}.

\begin{DoxyWarning}{Warning}
Be sure to check the possible values of \textquotesingle{}N\+A\+D\+\_\+\+D\+E\+R\+E\+G\+I\+S\+T\+R\+A\+T\+I\+O\+N\+\_\+\+T\+I\+M\+E\textquotesingle{} for your specific platform.
\end{DoxyWarning}
The minimum interval value between dial attempts can be set or get with\+:
\begin{DoxyItemize}
\item \hyperlink{le__ecall__interface_8h_af90a8602d4b1d0cacaa3971c508dd188}{le\+\_\+ecall\+\_\+\+Set\+Interval\+Between\+Dial\+Attempts()}
\item \hyperlink{le__ecall__interface_8h_a3a24ae5a007d0c43db2bc55caa43c19d}{le\+\_\+ecall\+\_\+\+Get\+Interval\+Between\+Dial\+Attempts()}
\end{DoxyItemize}

The default value is set to 30 seconds.

The time is counted from the start of the first dial attempt.

If more time has expired during the dial attempt, it will wait for 1 second to allow hangup before redialing.

If less time has expired during the dial attempt, it will wait for (interval -\/ \textquotesingle{}dial attempt duration\textquotesingle{}) seconds to allow hangup before redialing.

In the case the call was connected, the redial will be immediate.

\hyperlink{le__ecall__interface_8h_af90a8602d4b1d0cacaa3971c508dd188}{le\+\_\+ecall\+\_\+\+Set\+Interval\+Between\+Dial\+Attempts()} is available for both manual and test modes.\hypertarget{c_ecall_le_ecall_configdb}{}\subsubsection{Configuration tree}\label{c_ecall_le_ecall_configdb}
The configuration database path for the e\+Call is\+: \begin{DoxyVerb}/
    modemServices/
        eCall/
            systemStandard<string> = <eCall system>
            msdVersion<int> = <MSD value>
            vehicleType<string> = <vehicle type>
            vin<string> = <VIN>
            propulsionType/
                0<string> = <propulsion type>
                1<string> = <propulsion type>
                ...
\end{DoxyVerb}


The \textquotesingle{}system\+Standard\textquotesingle{} is the kind of e\+Call system\+:
\begin{DoxyItemize}
\item P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N
\item E\+R\+A-\/\+G\+L\+O\+N\+A\+S\+S
\end{DoxyItemize}

If no value or a bad entry is filled, the default value is \textquotesingle{}P\+A\+N-\/\+E\+U\+R\+O\+P\+E\+A\+N\textquotesingle{}.

The \textquotesingle{}msd\+Version\textquotesingle{} field is the M\+S\+D format version. If the field is not present, the default M\+S\+D version is version 1.

The \textquotesingle{}vehicle\+Type\textquotesingle{} field can be set with the following choices (string type)\+:
\begin{DoxyItemize}
\item \char`\"{}\+Passenger-\/\+M1\char`\"{} (Passenger vehicle, Class M1)
\item \char`\"{}\+Bus-\/\+M2\char`\"{} (Buses and coaches, Class M2)
\item \char`\"{}\+Bus-\/\+M3\char`\"{} (Buses and coaches, Class M3)
\item \char`\"{}\+Commercial-\/\+N1\char`\"{} (Light commercial vehicles, Class N1)
\item \char`\"{}\+Heavy-\/\+N2\char`\"{} (Heavy duty vehicles, Class N2)
\item \char`\"{}\+Heavy-\/\+N3\char`\"{} (Heavy duty vehicles, Class N3)
\item \char`\"{}\+Motorcycle-\/\+L1e\char`\"{} (Motorcycles, Class L1e)
\item \char`\"{}\+Motorcycle-\/\+L2e\char`\"{} (Motorcycles, Class L2e)
\item \char`\"{}\+Motorcycle-\/\+L3e\char`\"{} (Motorcycles, Class L3e)
\item \char`\"{}\+Motorcycle-\/\+L4e\char`\"{} (Motorcycles, Class L4e)
\item \char`\"{}\+Motorcycle-\/\+L5e\char`\"{} (Motorcycles, Class L5e)
\item \char`\"{}\+Motorcycle-\/\+L6e\char`\"{} (Motorcycles, Class L6e)
\item \char`\"{}\+Motorcycle-\/\+L7e\char`\"{} (Motorcycles, Class L7e)
\end{DoxyItemize}

The \textquotesingle{}vin\textquotesingle{} is the vehicle identification number (string type).

The \textquotesingle{}propulsion\+Type\textquotesingle{} field can be set with the following choices (string type)\+:
\begin{DoxyItemize}
\item \char`\"{}\+Gasoline\char`\"{} (Gasoline propulsion)
\item \char`\"{}\+Diesel\char`\"{} (Diesel propulsion)
\item \char`\"{}\+Natural\+Gas\char`\"{} (Compressed natural gas propulsion)
\item \char`\"{}\+Propane\char`\"{} (Liquid propane gas propulsion)
\item \char`\"{}\+Electric\char`\"{} (Electric propulsion)
\item \char`\"{}\+Hydrogen\char`\"{} (Hydrogen propulsion)
\item \char`\"{}\+Other\char`\"{} (Other type of propulsion)
\end{DoxyItemize}

Several \textquotesingle{}propulsion\+Type\textquotesingle{} can be applied.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_ips}{}\subsection{Input Power Supply Monitoring A\+P\+I}\label{c_ips}
\hyperlink{le__ips__interface_8h}{A\+P\+I Reference}





The I\+P\+S A\+P\+I is used to get monitoring information related to the platform voltage input.\hypertarget{c_ips_le_ips_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_ips_le_ips_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service}.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_ips -> modemService.le_ips
}
\end{DoxyVerb}
\hypertarget{c_ips_Input}{}\subsubsection{Power Supply Monitoring}\label{c_ips_Input}
This functionality allows to retrieve the Platform voltage input in \mbox{[}m\+V\mbox{]}, so that the application can use the information to diagnose should the modem isn\textquotesingle{}t fully functioning.

\hyperlink{le__ips__interface_8h_ad4e7387907ce93bd409007bca25ae433}{le\+\_\+ips\+\_\+\+Get\+Input\+Voltage()} A\+P\+I allows the application to retrieve the Platform voltage input.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_mcc}{}\subsection{Modem Call Control}\label{c_mcc}
\hyperlink{le__mcc__interface_8h}{A\+P\+I Reference}





The Modem Call Control (mcc) A\+P\+I functions of this A\+P\+I are provided by the {\bfseries modem\+Service} service.\hypertarget{c_mcc_le_mcc_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_mcc_le_mcc_binding}
Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_mcc -> modemService.le_mcc
}
\end{DoxyVerb}
\hypertarget{c_mcc_le_mcc_starting_a_call}{}\subsubsection{Starting a Call}\label{c_mcc_le_mcc_starting_a_call}
To initiate a call, create a new call object with a destination telephone number calling the \hyperlink{le__mcc__interface_8h_aeee65430506230b5744701d08ff8dac4}{le\+\_\+mcc\+\_\+\+Create()} function.

\hyperlink{le__mcc__interface_8h_a72a32869bb23864b3e86c606368bed70}{le\+\_\+mcc\+\_\+\+Start()} must still initiate the call when ready.

The \hyperlink{le__mcc__interface_8h_a72a32869bb23864b3e86c606368bed70}{le\+\_\+mcc\+\_\+\+Start()} function initiates a call attempt (it\textquotesingle{}s asynchronous because it can take time for a call to connect).

It\textquotesingle{}s essential to register a handler function to get the call events. Use \hyperlink{le__mcc__interface_8h_ab826cf4b9e3911e659a90d483081e7fe}{le\+\_\+mcc\+\_\+\+Add\+Call\+Event\+Handler()} A\+P\+I to install that handler function. The handler will be called for all calls\textquotesingle{} events (incoming and outgoing).

The \hyperlink{le__mcc__interface_8h_a8a12dc6f1707cf52818d9c2d8281630c}{le\+\_\+mcc\+\_\+\+Remove\+Call\+Event\+Handler()} A\+P\+I uninstalls the handler function.

The following A\+P\+Is can be used to manage incoming or outgoing calls\+:
\begin{DoxyItemize}
\item \hyperlink{le__mcc__interface_8h_ab16921abc02e0569b129f4a7d92bf3c9}{le\+\_\+mcc\+\_\+\+Get\+Termination\+Reason()} -\/ termination reason.
\item \hyperlink{le__mcc__interface_8h_a68b9b8ed1b221924dcea1be0fd610a54}{le\+\_\+mcc\+\_\+\+Get\+Platform\+Specific\+Termination\+Code()} -\/ the platform specific termination code (refer to your platform documentation for further details).
\item \hyperlink{le__mcc__interface_8h_a07e4856dffdbf887f51879e39ec43e42}{le\+\_\+mcc\+\_\+\+Is\+Connected()} -\/ connection status.
\item \hyperlink{le__mcc__interface_8h_aeae32829e9a5fa864167df3ee67d0f41}{le\+\_\+mcc\+\_\+\+Get\+Remote\+Tel()} -\/ displays remote party telephone number associated with the call.
\item \hyperlink{le__mcc__interface_8h_a7b9567715a3cd30c83a3b6886eeb2044}{le\+\_\+mcc\+\_\+\+Hang\+Up()} will disconnect this call.
\end{DoxyItemize}

When finished with the call object, call \hyperlink{le__mcc__interface_8h_a1a016e6443df2d3ee99113649f4f34ae}{le\+\_\+mcc\+\_\+\+Delete()} to free all the allocated resources associated with the object.

Multi-\/threading/multi-\/application behaviour\+: the call\+Ref is linked to a specific client (i.\+e. connection with the mcc service). Each client will have its own call\+Ref for a same call. That is, if a call event handler is registered by one thread but \hyperlink{le__mcc__interface_8h_aeee65430506230b5744701d08ff8dac4}{le\+\_\+mcc\+\_\+\+Create()} is called by another thread, they will each get different call references for the same call. So, when multiple threads are being used to work with the same call, a comparison of the call references themselves can\textquotesingle{}t be used to tell whether or not they refer to the same call.

This code example uses {\ttfamily Call\+And\+Play()} to dial a phone number, and if successful, play a sound file. Once the file has played, the call hangs up.


\begin{DoxyCode}
\textcolor{keyword}{typedef} \textcolor{keyword}{struct}
\{
    \hyperlink{le__mcc__interface_8h_a8ae6dac3ca12854884d63e17d5388a7a}{le\_mcc\_CallRef\_t}             callRef;
    \textcolor{keywordtype}{char}                         filePath[MAX\_FILE\_PATH\_BYTES];
    \hyperlink{le__mcc__interface_8h_a0bb9fd4ec67450a267bc372bf9a90cb9}{le\_mcc\_CallEventHandlerRef\_t} eventHandlerRef;
\}
PlayContext\_t;

\textcolor{keywordtype}{void} CallAndPlay
(
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* destinationTelPtr,
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}* filePathPtr
)
\{
    PlayContext\_t* contextPtr = (PlayContext\_t*)\hyperlink{le__mem_8h_af7c289c73d4182835a26a9099f3db359}{le\_mem\_ForceAlloc}(PlayContextPoolRef);

    le\_str\_Copy(contextPtr->filePath, filePathPtr, \textcolor{keyword}{sizeof}(contextPtr->filePath), NULL);

    contextPtr->callRef = \hyperlink{le__mcc__interface_8h_aeee65430506230b5744701d08ff8dac4}{le\_mcc\_Create}(destinationTelPtr);

    contextPtr->eventHandlerRef = \hyperlink{le__mcc__interface_8h_ab826cf4b9e3911e659a90d483081e7fe}{le\_mcc\_AddCallEventHandler}(MyCallEventHandler,
                                                                  contextPtr);

    \hyperlink{le__mcc__interface_8h_a72a32869bb23864b3e86c606368bed70}{le\_mcc\_Start}(contextPtr->callRef);
\}


\textcolor{keyword}{static} \textcolor{keywordtype}{void} MyCallEventHandler
(
    \hyperlink{le__mcc__interface_8h_a8ae6dac3ca12854884d63e17d5388a7a}{le\_mcc\_CallRef\_t} callRef,
    \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cf}{le\_mcc\_Event\_t}   event,
    \textcolor{keywordtype}{void}*            contextPtr
)
\{
    PlayContext\_t*      myContextPtr = (PlayContext\_t*)contextPtr;

    \textcolor{keywordflow}{switch} (event)
    \{
        \textcolor{keywordflow}{case} \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cfa86702531207c50314b10ae3278c7ca0d}{LE\_MCC\_EVENT\_CONNECTED}:
            \{
                 [...]
                 \hyperlink{le__audio__interface_8h_aea2c5d0b394cfab87503639c534300c9}{le\_audio\_PlayFile}(FileAudioRef, AudioFileFd);
                 [...]
            \}
            \textcolor{keywordflow}{break};

        \textcolor{keywordflow}{case} \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cfa38b7c4ab21fa9828be8169372e41ae98}{LE\_MCC\_EVENT\_TERMINATED}:
            \hyperlink{le__mcc__interface_8h_a1a016e6443df2d3ee99113649f4f34ae}{le\_mcc\_Delete}(callRef);
            \textcolor{comment}{// I don't release the Profile for further use}

            \hyperlink{le__mcc__interface_8h_a8a12dc6f1707cf52818d9c2d8281630c}{le\_mcc\_RemoveCallEventHandler}(contextPtr->eventHandlerRef);

            \hyperlink{le__mem_8h_a6d8e3fe430bcb81efe97b57ce30ef2de}{le\_mem\_Release}(myContextPtr);
            \textcolor{keywordflow}{break};
    \}
\}


\textcolor{keyword}{static} \textcolor{keywordtype}{void} MyAudioFinishedHandler
(
    le\_audio\_PlayComplete reason,
    \textcolor{keywordtype}{void}*                 contextPtr
)
\{
    PlayContext\_t* myContextPtr = (PlayContext\_t*)contextPtr;

    \hyperlink{le__mcc__interface_8h_a7b9567715a3cd30c83a3b6886eeb2044}{le\_mcc\_HangUp}(myContextPtr->callRef);  \textcolor{comment}{// This will trigger a TERMINATED event.}
\}
\end{DoxyCode}
\hypertarget{c_mcc_le_mcc_answering_a_call}{}\subsubsection{Answering a call}\label{c_mcc_le_mcc_answering_a_call}
Receiving calls is similar sending calls. Add a handler through \hyperlink{le__mcc__interface_8h_ab826cf4b9e3911e659a90d483081e7fe}{le\+\_\+mcc\+\_\+\+Add\+Call\+Event\+Handler()} to be notified of incoming calls.

To answer, call \hyperlink{le__mcc__interface_8h_a598349c6ccfa151dbd1d2f2a9c293ca4}{le\+\_\+mcc\+\_\+\+Answer()}. To reject it, call \hyperlink{le__mcc__interface_8h_a7b9567715a3cd30c83a3b6886eeb2044}{le\+\_\+mcc\+\_\+\+Hang\+Up()}.

This code example uses Install\+Automatic\+Answer() to install a call event handler that automatically answers incoming calls. The handler function verifies the incoming call is permitted (through a predefined list), and then decides whether to answer or terminate it.


\begin{DoxyCode}
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t} AudioRxConnectorRef = NULL;
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_ab819480f4ce3f36e62b6a4e327668304}{le\_audio\_ConnectorRef\_t} AudioTxConnectorRef = NULL;
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} MicRef = NULL;
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} SpeakerRef = NULL;
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} CallRxAudioRef = NULL;
\textcolor{keyword}{static} \hyperlink{le__audio__interface_8h_a9a46ff5a5afa61f1bc76120ab9e4da0a}{le\_audio\_StreamRef\_t} CallTxAudioRef = NULL;

\textcolor{keywordtype}{void} InstallAutomaticAnswer
(
    \textcolor{keywordtype}{void}
)
\{
    \hyperlink{le__mcc__interface_8h_ab826cf4b9e3911e659a90d483081e7fe}{le\_mcc\_AddCallEventHandler}(   MyVoiceCallEventHandler,
                                       contextPtr);
\}


\textcolor{keyword}{static} \textcolor{keywordtype}{void} MyVoiceCallEventHandler
(
    \hyperlink{le__mcc__interface_8h_a8ae6dac3ca12854884d63e17d5388a7a}{le\_mcc\_CallRef\_t} callRef,
    \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cf}{le\_mcc\_Event\_t}   event,
    \textcolor{keywordtype}{void}*            contextPtr
)
\{
    \textcolor{keywordtype}{char}                tel[TEL\_NMBR\_MAX\_BYTES];

    \textcolor{keywordflow}{switch} (event)
    \{
        \textcolor{keywordflow}{case} \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cfab37936f33d31259ea0c16169ba852bd0}{LE\_MCC\_EVENT\_INCOMING}:
            \{
                \hyperlink{le__mcc__interface_8h_aeae32829e9a5fa864167df3ee67d0f41}{le\_mcc\_GetRemoteTel}(callRef, &tel, \textcolor{keyword}{sizeof}(tel));
                \textcolor{keywordflow}{if} (IsAnAuthorizedIncomingCall(tel) == TRUE)
                \{
                    SpeakerRef = \hyperlink{le__audio__interface_8h_a5c19afce44021c4abf6193707317f8de}{le\_audio\_OpenSpeaker}();
                    CallRxAudioRef = \hyperlink{le__audio__interface_8h_ae3ed568ba4d2763ea77e17e77b20ff02}{le\_audio\_OpenModemVoiceRx}();
                    MicRef = \hyperlink{le__audio__interface_8h_a74f1ef979329f6c2bd56ea622f4d05b2}{le\_audio\_OpenMic}();
                    CallTxAudioRef = \hyperlink{le__audio__interface_8h_ad745f008bb04873c817da7af3daf783d}{le\_audio\_OpenModemVoiceTx}();

                    AudioRxConnectorRef = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();
                    AudioTxConnectorRef = \hyperlink{le__audio__interface_8h_a570aaf85086f00aca592acfbaaa237be}{le\_audio\_CreateConnector}();

                    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(AudioRxConnectorRef, speakerRef);
                    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (AudioRxConnectorRef, callRxAudioRef);

                    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect}(AudioTxConnectorRef, micRef);
                    \hyperlink{le__audio__interface_8h_a338df65b2fb1ae0140d86880adbcf0de}{le\_audio\_Connect} (AudioTxConnectorRef, callTxAudioRef);

                    \hyperlink{le__mcc__interface_8h_a598349c6ccfa151dbd1d2f2a9c293ca4}{le\_mcc\_Answer}(callRef);
                \}
                \textcolor{keywordflow}{else}
                \{
                    \textcolor{comment}{// Reject the incoming call}
                    \hyperlink{le__mcc__interface_8h_a7b9567715a3cd30c83a3b6886eeb2044}{le\_mcc\_HangUp}(callRef);
                \}
             \}
         \textcolor{keywordflow}{break};

         \textcolor{keywordflow}{case} \hyperlink{le__mcc__interface_8h_aefc4679ffa76d0e04c578572c22f06cfa38b7c4ab21fa9828be8169372e41ae98}{LE\_MCC\_EVENT\_TERMINATED}:
             \hyperlink{le__audio__interface_8h_a6b88df9301038375701e4c15a4c8aaf0}{le\_audio\_Disconnect}(micRef);
             \hyperlink{le__audio__interface_8h_a6b88df9301038375701e4c15a4c8aaf0}{le\_audio\_Disconnect}(speakerRef);
             \hyperlink{le__audio__interface_8h_a6b88df9301038375701e4c15a4c8aaf0}{le\_audio\_Disconnect}(AudioRxConnectorRef);
             \hyperlink{le__audio__interface_8h_a6b88df9301038375701e4c15a4c8aaf0}{le\_audio\_Disconnect}(AudioTxConnectorRef);
             \hyperlink{le__mcc__interface_8h_a1a016e6443df2d3ee99113649f4f34ae}{le\_mcc\_Delete}(callRef);
         \textcolor{keywordflow}{break};
     \}
 \}
\end{DoxyCode}
\hypertarget{c_mcc_le_mcc_ending_all_call}{}\subsubsection{Ending all calls}\label{c_mcc_le_mcc_ending_all_call}
A special function can be used to hang-\/up all the ongoing calls\+: \hyperlink{le__mcc__interface_8h_a38ac8543a579ecc81430c121a64bd346}{le\+\_\+mcc\+\_\+\+Hang\+Up\+All()}. This function can be used to hang-\/up any calls that have been initiated through another client like A\+T commands.\hypertarget{c_mcc_le_mcc_ss}{}\subsubsection{Supplementary service.}\label{c_mcc_le_mcc_ss}
Calling Line Identification Restriction (C\+L\+I\+R) can be activated or deactivated by le\+\_\+mcc\+\_\+\+Set\+Caller\+Id\+Restrict A\+P\+I. The status is independent for each call object reference. Status can be read with the \hyperlink{le__mcc__interface_8h_a54093f7d51cae9a186a97aa799ac3ddc}{le\+\_\+mcc\+\_\+\+Get\+Caller\+Id\+Restrict()} A\+P\+I. Default value is L\+E\+\_\+\+O\+F\+F (Enable presentation of own phone number to remote).





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_mdc}{}\subsection{Modem Data Control}\label{c_mdc}
\hyperlink{le__mdc__interface_8h}{A\+P\+I Reference}





A data session is useful for applications that need to send or receive data over a network where S\+M\+S messages are insufficient. To start a data session, a data profile must be configured as specified by the target network.

The Modem Data Control (mdc) A\+P\+I is used to manage data profiles and data sessions.\hypertarget{c_mdc_le_mdc_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_mdc_le_mdc_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service} service.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_mdc -> modemService.le_mdc
}
\end{DoxyVerb}
\hypertarget{c_mdc_le_mdc_profile}{}\subsubsection{Data Profiles}\label{c_mdc_le_mdc_profile}
If a pre-\/defined data profile has been configured then this profile can be loaded using \hyperlink{le__mdc__interface_8h_a638b693cd5f644fa5c24f81e1e36483c}{le\+\_\+mdc\+\_\+\+Get\+Profile}. The maximum number of data profiles supported is modem dependent and can be retrieved with \hyperlink{le__mdc__interface_8h_a790602f1b17d7bf9626a51eac5599439}{le\+\_\+mdc\+\_\+\+Num\+Profiles}. A pre-\/defined data profile can also be retrieved using \hyperlink{le__mdc__interface_8h_a160de65c9260e93f7fc2140c0ff429e7}{le\+\_\+mdc\+\_\+\+Get\+Profile\+From\+Apn} thanks to its A\+P\+N.

\begin{DoxyWarning}{Warning}
Ensure to check the list of supported data profiles for your specific platform.
\end{DoxyWarning}
The following data profile parameters can be retrieved\+:
\begin{DoxyItemize}
\item Packet Data Protocol using \hyperlink{le__mdc__interface_8h_a0a51125579f1d5009dac03c79ddff498}{le\+\_\+mdc\+\_\+\+Get\+P\+D\+P}.
\item Access Point Name using \hyperlink{le__mdc__interface_8h_ac9accd1ea303d6840e5e7de19b0dae6f}{le\+\_\+mdc\+\_\+\+Get\+A\+P\+N}.
\item Authentication settings using \hyperlink{le__mdc__interface_8h_a2bd23fc2f951772a8fa73301affff36f}{le\+\_\+mdc\+\_\+\+Get\+Authentication}.
\end{DoxyItemize}

The following data profile parameters can be set\+:
\begin{DoxyItemize}
\item Packet Data Protocol using \hyperlink{le__mdc__interface_8h_a73e66a7a63dc95d7f261fc2a26470386}{le\+\_\+mdc\+\_\+\+Set\+P\+D\+P}.
\item Access Point Name using \hyperlink{le__mdc__interface_8h_a1777f22b1a400593c3e0fb879acd57c6}{le\+\_\+mdc\+\_\+\+Set\+A\+P\+N}.
\item Authentication settings using \hyperlink{le__mdc__interface_8h_abf58f1dd7d4f9b915647e9c0f642065b}{le\+\_\+mdc\+\_\+\+Set\+Authentication}.
\end{DoxyItemize}\hypertarget{c_mdc_le_mdc_session}{}\subsubsection{Data Sessions}\label{c_mdc_le_mdc_session}
\hypertarget{c_mdc_le_mdc_session_MO}{}\paragraph{Mobile Originated (\+M\+O-\/\+P\+D\+P context activation)}\label{c_mdc_le_mdc_session_MO}
A data session can be started using \hyperlink{le__mdc__interface_8h_a2cb08d5c3e6c43297d80448891719649}{le\+\_\+mdc\+\_\+\+Start\+Session}. To start a data session, a data profile must be created and written to the modem, or an existing data profile can be used. A data session can be stopped using \hyperlink{le__mdc__interface_8h_a53453f85065c3cace0922150b7e3d869}{le\+\_\+mdc\+\_\+\+Stop\+Session}. The number of simultaneous data sessions supported is dependent on the modem, but cannot be more than the maximum number of supported profiles.

The current state of a data session can be queried using \hyperlink{le__mdc__interface_8h_add91c364e8b3e4e82a0ce64e480c016b}{le\+\_\+mdc\+\_\+\+Get\+Session\+State}. An application can also a register handler to be notified when the session state changes. The handler can be managed using \hyperlink{le__mdc__interface_8h_a594c85c1ccb56ddfbaf36496f35f681e}{le\+\_\+mdc\+\_\+\+Add\+Session\+State\+Handler} and \hyperlink{le__mdc__interface_8h_a3b89962f4383f42a357f5a5fcc14fdff}{le\+\_\+mdc\+\_\+\+Remove\+Session\+State\+Handler}.\hypertarget{c_mdc_le_mdc_session_MT}{}\paragraph{Mobile Terminated (\+M\+T-\/\+P\+D\+P context activation)}\label{c_mdc_le_mdc_session_MT}
To be notified by the M\+T-\/\+P\+D\+P context request, the application has to subscribe to the state handler using \hyperlink{le__mdc__interface_8h_ada19c2a399ba8c0aa038e27c21689472}{le\+\_\+mdc\+\_\+\+Add\+Mt\+Pdp\+Session\+State\+Handler}. When the incoming M\+T-\/\+P\+D\+P context request is notified, the application takes responsibility to trigger the data session for that M\+T P\+D\+P request using \hyperlink{le__mdc__interface_8h_a2cb08d5c3e6c43297d80448891719649}{le\+\_\+mdc\+\_\+\+Start\+Session}. That data session can be stopped using \hyperlink{le__mdc__interface_8h_a53453f85065c3cace0922150b7e3d869}{le\+\_\+mdc\+\_\+\+Stop\+Session}.

The network interface settings of that M\+T-\/\+P\+D\+P context can be retrieved using the provided Data Profile. Please refer to \hyperlink{c_mdc_le_mdc_session_networkItf}{Network interface settings}.

A data session can be rejected using \hyperlink{le__mdc__interface_8h_ae3b49edad910960b84a9012ecc33c66a}{le\+\_\+mdc\+\_\+\+Reject\+Mt\+Pdp\+Session}. The number of simultaneous data sessions supported is dependent on the modem, but cannot be more than the maximum number of supported profiles.

The handler can be released using \hyperlink{le__mdc__interface_8h_ad296518ad496c960b4b23f89f7a1b222}{le\+\_\+mdc\+\_\+\+Remove\+Mt\+Pdp\+Session\+State\+Handler}.\hypertarget{c_mdc_le_mdc_session_networkItf}{}\paragraph{Network interface settings}\label{c_mdc_le_mdc_session_networkItf}
Once a data session starts, a Linux network interface is created. It\textquotesingle{}s the application\textquotesingle{}s responsibility to configure the network interface, usually through a D\+H\+C\+P client. Query the interface name using \hyperlink{le__mdc__interface_8h_abf470aa8e252114cbb95b4e337083d52}{le\+\_\+mdc\+\_\+\+Get\+Interface\+Name}. The I\+P Preference can be checked with \hyperlink{le__mdc__interface_8h_aa3912e94864a6e5862e07f58b3772cba}{le\+\_\+mdc\+\_\+\+Is\+I\+Pv4} or \hyperlink{le__mdc__interface_8h_adde11de0b17b2c937acca6355b6fba11}{le\+\_\+mdc\+\_\+\+Is\+I\+Pv6} when the profile is connected. The I\+P address for the current data session can be retreived by \hyperlink{le__mdc__interface_8h_a732acb5823549a1644aa1bb5ba69fea5}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv4\+Address} or \hyperlink{le__mdc__interface_8h_aacd6a0b646f26625cdb26a78d42f8e5f}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv6\+Address}. The Gateway and D\+N\+S addresses can be retrieved using \hyperlink{le__mdc__interface_8h_af4be1afa6d44a4a7041f9f02660704b9}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv4\+Gateway\+Address}, \hyperlink{le__mdc__interface_8h_ae99f6e212de1b0c0ea8a8763b62e0bea}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv4\+D\+N\+S\+Addresses} or \hyperlink{le__mdc__interface_8h_a0b82eac1ed112bd3b82060cc54751246}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv6\+Gateway\+Address}, \hyperlink{le__mdc__interface_8h_a8aeb3f684567eee2976b851b7d713f01}{le\+\_\+mdc\+\_\+\+Get\+I\+Pv6\+D\+N\+S\+Addresses}. The Access Point Name can be retrieved by \hyperlink{le__mdc__interface_8h_ac9accd1ea303d6840e5e7de19b0dae6f}{le\+\_\+mdc\+\_\+\+Get\+A\+P\+N}. The Data bearer Technology can be retreived by \hyperlink{le__mdc__interface_8h_a1b17bb87b347162013b5ad608cdcda2d}{le\+\_\+mdc\+\_\+\+Get\+Data\+Bearer\+Technology}. When the data session is stopped, the disconnection reason can be known using \hyperlink{le__mdc__interface_8h_afe73f44c23b1bd120dd82a85b36c6059}{le\+\_\+mdc\+\_\+\+Get\+Disconnection\+Reason()} or \hyperlink{le__mdc__interface_8h_a3e3a92b0f5e3edab9400412170517a62}{le\+\_\+mdc\+\_\+\+Get\+Platform\+Specific\+Disconnection\+Code()} (refer to your platform documentation for further details).\hypertarget{c_mdc_le_mdc_dataStatistics}{}\subsubsection{Data Statistics}\label{c_mdc_le_mdc_dataStatistics}
Data bytes received/transmitted can be access through \hyperlink{le__mdc__interface_8h_aaad833c105f7d0ae77f18195d6739080}{le\+\_\+mdc\+\_\+\+Get\+Bytes\+Counters}. These values correspond to the number of bytes received/transmitted since the last software reset or the last \hyperlink{le__mdc__interface_8h_a63636b2779d2ee6a6520ebfb2d26666c}{le\+\_\+mdc\+\_\+\+Reset\+Bytes\+Counter} called. Making these value persistent after a software reboot is the client responsibility.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_info}{}\subsection{Modem Information}\label{c_info}
\hyperlink{le__info__interface_8h}{A\+P\+I Reference}





This file contains prototype definitions for Modem Information A\+P\+Is.\hypertarget{c_info_le_info_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_info_le_info_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service}.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_info -> modemService.le_info
}
\end{DoxyVerb}
\hypertarget{c_info_le_info_version}{}\subsubsection{Query Firmware Version}\label{c_info_le_info_version}
\hyperlink{le__info__interface_8h_ae4a7baef2aac776edefefab68b74a7c6}{le\+\_\+info\+\_\+\+Get\+Firmware\+Version()} is used to query the current firmware version. \hyperlink{le__info__interface_8h_a931797ade737e2eebb09008ce84891ff}{le\+\_\+info\+\_\+\+Get\+Bootloader\+Version()} is used to query the current bootloader version. In both cases, the version is returned as a human readable string.

The linux kernel version can be queried using standard linux methods, such as the uname command, or the uname() A\+P\+I.\hypertarget{c_info_le_info_model}{}\subsubsection{Query Device information}\label{c_info_le_info_model}
\hyperlink{le__info__interface_8h_a4cd7a99fddb014e25880e6354b1d02f8}{le\+\_\+info\+\_\+\+Get\+Device\+Model()} is used to retrieve the target hardware platform identity.

\hyperlink{le__info__interface_8h_a82950824965105fd9041fe5ed7239d79}{le\+\_\+info\+\_\+\+Get\+Imei()} is used to retrieve the International Mobile Equipment Identity (I\+M\+E\+I).

\hyperlink{le__info__interface_8h_a7e72f4ea46e0354a359f5dd08bf3eee2}{le\+\_\+info\+\_\+\+Get\+Meid()} is used to retrieve the C\+D\+M\+A device Mobile Equipment Identifier (M\+E\+I\+D).

\hyperlink{le__info__interface_8h_a60e5327bbc91669c8bb92cd8df19fc69}{le\+\_\+info\+\_\+\+Get\+Esn()} is used to retrieve Electronic Serial Number (E\+S\+N) of the device.

\hyperlink{le__info__interface_8h_a03837e7763a2de9fef400bc6ff099ed9}{le\+\_\+info\+\_\+\+Get\+Mdn()} is used to retrieve the Mobile Directory Number (M\+D\+N) of the device.

\hyperlink{le__info__interface_8h_a6269c360fcee8fc52d0fe462ba65eda9}{le\+\_\+info\+\_\+\+Get\+Min()} is used to retrieve the C\+D\+M\+A Mobile Identification Number (M\+I\+N).

\hyperlink{le__info__interface_8h_ab12105ea6f654c3124ec812234e0f1fa}{le\+\_\+info\+\_\+\+Get\+Prl\+Version()} is used to retrieve the C\+D\+M\+A version of Preferred Roaming List (P\+R\+L).

\hyperlink{le__info__interface_8h_a3f2f3ea1720f9ff173483046966ebdb3}{le\+\_\+info\+\_\+\+Get\+Prl\+Only\+Preference()} is used to retrieve the C\+D\+M\+A Preferred Roaming List (P\+R\+L) only preferences status.

\hyperlink{le__info__interface_8h_ae87f9481c09d0357ff31379b8bd8f233}{le\+\_\+info\+\_\+\+Get\+Nai()} is used to retrieve the C\+D\+M\+A Network Access Identifier (N\+A\+I) string.

\hyperlink{le__info__interface_8h_a8b44d64cf12cd4d5475482f6ec8b70f5}{le\+\_\+info\+\_\+\+Get\+Manufacturer\+Name()} is used to retrieve the Manufacturer name.

\hyperlink{le__info__interface_8h_a18940ac413b3df2bac02892d243d6bd4}{le\+\_\+info\+\_\+\+Get\+Pri\+Id()} is used to retrieve the Product Requirement Information Identifier (P\+R\+I I\+D) Part Number and the Revision number. The Part number is a 7-\/digit string. Revision Number string contains 2-\/digit major version + \textquotesingle{}.\textquotesingle{} char + 2-\/digit minor version (xx.\+xx).

\hyperlink{le__info__interface_8h_a23d1f0f22d275ae334c4124e56f1d7e5}{le\+\_\+info\+\_\+\+Get\+Platform\+Serial\+Number()} is used to retrieve the Platform Serial Number (P\+S\+N) string.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_mrc}{}\subsection{Modem Radio Control}\label{c_mrc}
\hyperlink{le__mrc__interface_8h}{A\+P\+I Reference}





The Modem Radio Control (M\+R\+C) A\+P\+Is is used to control cellular network environments.

It\textquotesingle{}s important for many M2\+M apps to know details about cellular network environments (like network registration and signal quality). It allows you to limit some M2\+M services based on the reliability of the network environment, and provides information to control power consumption (power on or shutdown the radio module).\hypertarget{c_mrc_le_mrc_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_mrc_le_mrc_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service} service.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_mrc -> modemService.le_mrc
}
\end{DoxyVerb}
\hypertarget{c_mrc_le_mrc_power}{}\subsubsection{Radio Power Management}\label{c_mrc_le_mrc_power}
\hyperlink{le__mrc__interface_8h_a78bd27d92337e2122320f41bcaa5480f}{le\+\_\+mrc\+\_\+\+Set\+Radio\+Power()} A\+P\+I allows the application to power up or shutdown the radio module.

\hyperlink{le__mrc__interface_8h_aac51332c6c84e460746eb1ad45c064d6}{le\+\_\+mrc\+\_\+\+Get\+Radio\+Power()} A\+P\+I displays radio module power state.\hypertarget{c_mrc_le_mrc_configuration}{}\subsubsection{Radio Configuration preferences}\label{c_mrc_le_mrc_configuration}
The following functions let you configure and retrieve the radio configuration preferences\+: \hyperlink{le__mrc__interface_8h_acb434a9f91afb5b6639baf3678ee9388}{le\+\_\+mrc\+\_\+\+Set\+Automatic\+Register\+Mode()}, \hyperlink{le__mrc__interface_8h_a09b890f05a20f4b007d60e595026631f}{le\+\_\+mrc\+\_\+\+Set\+Manual\+Register\+Mode()} and \hyperlink{le__mrc__interface_8h_a283c0c092c5a135a8e95f9f091655cb1}{le\+\_\+mrc\+\_\+\+Get\+Register\+Mode()} let you set/get the selected Scan mode.

\hyperlink{le__mrc__interface_8h_ac808b4dc721e031566da92e00663c027}{le\+\_\+mrc\+\_\+\+Set\+Band\+Preferences()}, \hyperlink{le__mrc__interface_8h_a04418f56480070ba6c4f3d176dafaa37}{le\+\_\+mrc\+\_\+\+Get\+Band\+Preferences()} let you set/get the 2\+G/3\+G band preferences by using a bit mask built with {\ttfamily le\+\_\+mrc\+\_\+\+Band\+Bit\+Mask\+\_\+t} 

The 2\+G/3\+G band preferences can be\+:
\begin{DoxyItemize}
\item Band-\/\+Class-\/0-\/\+A-\/\+System
\item Band-\/\+Class-\/0-\/\+B-\/\+System
\item Band-\/\+Class-\/1-\/\+All-\/\+Blocks
\item Band-\/\+Class-\/2-\/\+Placeholder
\item Band-\/\+Class-\/3-\/\+A-\/\+System
\item Band-\/\+Class-\/4-\/\+All-\/\+Blocks
\item Band-\/\+Class-\/5-\/\+All-\/\+Blocks
\item Band-\/\+Class-\/6
\item Band-\/\+Class-\/7
\item Band-\/\+Class-\/8
\item Band-\/\+Class-\/9
\item Band-\/\+Class-\/10
\item Band-\/\+Class-\/11
\item Band-\/\+Class-\/12
\item Band-\/\+Class-\/13
\item Band-\/\+Class-\/14
\item Band-\/\+Class-\/15
\item Band-\/\+Class-\/16
\item Band-\/\+Class-\/17
\item Band-\/\+Class-\/18
\item Band-\/\+Class-\/19
\item G\+S\+M-\/\+D\+C\+S-\/1800
\item E-\/\+G\+S\+M-\/900 (for Extended G\+S\+M 900 band)
\item Primary-\/\+G\+S\+M-\/900
\item G\+S\+M-\/450
\item G\+S\+M-\/480
\item G\+S\+M-\/750
\item G\+S\+M-\/850
\item G\+S\+M\+R-\/900 (for G\+S\+M Railways G\+S\+M 900 band)
\item G\+S\+M-\/\+P\+C\+S-\/1900
\item W\+C\+D\+M\+A-\/\+E\+U-\/\+J-\/\+C\+H-\/\+I\+M\+T-\/2100 (for W\+C\+D\+M\+A Europe, Japan, and China I\+M\+T 2100 band)
\item W\+C\+D\+M\+A-\/\+U\+S-\/\+P\+C\+S-\/1900 (for W\+C\+D\+M\+A U.\+S. P\+C\+S 1900 band)
\item W\+C\+D\+M\+A-\/\+E\+U-\/\+C\+H-\/\+D\+C\+S-\/1800 (for W\+C\+D\+M\+A Europe and China D\+C\+S 1800 band)
\item W\+C\+D\+M\+A-\/\+U\+S-\/1700 (for W\+C\+D\+M\+A U.\+S. 1700 band)
\item W\+C\+D\+M\+A-\/\+U\+S-\/850 (for W\+C\+D\+M\+A U.\+S. 850 band)
\item W\+C\+D\+M\+A-\/\+J-\/800 (for W\+C\+D\+M\+A Japan 800 band)
\item W\+C\+D\+M\+A-\/\+E\+U-\/2600 (for W\+C\+D\+M\+A Europe 2600 band)
\item W\+C\+D\+M\+A-\/\+E\+U-\/\+J-\/900 (for W\+C\+D\+M\+A Europe and Japan 900 band)
\item W\+C\+D\+M\+A-\/\+J-\/1700 (for W\+C\+D\+M\+A Japan 1700 band)
\end{DoxyItemize}

\hyperlink{le__mrc__interface_8h_a21d2fe7c736e9a4a342dcc461a5d6e02}{le\+\_\+mrc\+\_\+\+Set\+Lte\+Band\+Preferences()}, \hyperlink{le__mrc__interface_8h_af4ec5bd36ba8df68bc12a10618268742}{le\+\_\+mrc\+\_\+\+Get\+Lte\+Band\+Preferences()} let you set/get the L\+T\+E band preferences by using a bit mask built with {\ttfamily le\+\_\+mrc\+\_\+\+Lte\+Band\+Bit\+Mask\+\_\+t}.

The L\+T\+E band preferences can be 0 to 43 except 15, 16, 22, 23, and 26 to 32.

\hyperlink{le__mrc__interface_8h_a8765511597189b64e486fa8f17bcddcd}{le\+\_\+mrc\+\_\+\+Set\+Td\+Scdma\+Band\+Preferences()}, \hyperlink{le__mrc__interface_8h_aed41544004ed7df9de8e874b8bb09d3b}{le\+\_\+mrc\+\_\+\+Get\+Td\+Scdma\+Band\+Preferences()} let you set/get the T\+D-\/\+S\+C\+D\+M\+A band preferences by using a bit mask built with {\ttfamily le\+\_\+mrc\+\_\+\+Td\+Scdma\+Band\+Bit\+Mask\+\_\+t} 

The T\+D-\/\+S\+C\+D\+M\+A band preferences can be \textquotesingle{}A\textquotesingle{} to \textquotesingle{}F\textquotesingle{}

\begin{DoxyWarning}{Warning}
Ensure to check the supported preferences for your specific platform.
\end{DoxyWarning}
\hyperlink{le__mrc__interface_8h_ac476a122ab91d3607c4eb016e93a3bde}{le\+\_\+mrc\+\_\+\+Add\+Preferred\+Operator()} , \hyperlink{le__mrc__interface_8h_a0c2d65eb8cdb200aa4bce8766530c39f}{le\+\_\+mrc\+\_\+\+Remove\+Preferred\+Operator()} to add/remove a preferred operator by specifying the M\+C\+C/\+M\+N\+C and the Radio Access Technology.

\hyperlink{le__mrc__interface_8h_a1ea0d2943accd51d3b428e0e6c94d297}{le\+\_\+mrc\+\_\+\+Get\+Preferred\+Operators\+List()}, \hyperlink{le__mrc__interface_8h_a9648b653b7551cd065ec323b96a0aa1b}{le\+\_\+mrc\+\_\+\+Get\+First\+Preferred\+Operator()}, \hyperlink{le__mrc__interface_8h_a896703cabaacf97a70708d944cfbfc87}{le\+\_\+mrc\+\_\+\+Get\+Next\+Preferred\+Operator()}, \hyperlink{le__mrc__interface_8h_a60679f563ffecc8f107425b806edcdf0}{le\+\_\+mrc\+\_\+\+Delete\+Preferred\+Operators\+List()}, \hyperlink{le__mrc__interface_8h_ab2204081bc04a108194e1dd915c35acf}{le\+\_\+mrc\+\_\+\+Get\+Preferred\+Operator\+Details()} let you retrieve a list of the selected preferred operators and get their details.\hypertarget{c_mrc_le_mrc_rat}{}\subsubsection{Radio Access Technology (\+R\+A\+T)}\label{c_mrc_le_mrc_rat}
\hyperlink{le__mrc__interface_8h_a3ad9533c467cec0902d5d165bb32d67b}{le\+\_\+mrc\+\_\+\+Get\+Radio\+Access\+Tech\+In\+Use()} A\+P\+I retrieves the current active Radio Access Technology.

The application can register a handler function to retrieve the Radio Access Technology each time the R\+A\+T changes.

\hyperlink{le__mrc__interface_8h_aedd9c526588a8298322525cfba6f875d}{le\+\_\+mrc\+\_\+\+Add\+Rat\+Change\+Handler()} A\+P\+I installs a R\+A\+T change handler.

\hyperlink{le__mrc__interface_8h_aed4f1730c99a1a9204a198e3df3cf6f5}{le\+\_\+mrc\+\_\+\+Remove\+Rat\+Change\+Handler()} A\+P\+I uninstalls the handler function.

\hyperlink{le__mrc__interface_8h_a2d4abd391bc69c218538f5d8e1be4e01}{le\+\_\+mrc\+\_\+\+Set\+Rat\+Preferences()}, \hyperlink{le__mrc__interface_8h_ae9fa8655738c63e392c8dcc862bdb1d5}{le\+\_\+mrc\+\_\+\+Get\+Rat\+Preferences()} let you set/get the Radio Access Technology preferences by using a bit mask built with {\ttfamily le\+\_\+mrc\+\_\+\+Rat\+Bit\+Mask\+\_\+t}.

The Radio Access Technology preferences can be\+:
\begin{DoxyItemize}
\item C\+D\+M\+A (C\+D\+M\+A2000-\/1\+X + C\+D\+M\+A2000-\/\+H\+R\+P\+D)
\item G\+S\+M
\item U\+M\+T\+S (U\+M\+T\+S + T\+D-\/\+S\+C\+D\+M\+A)
\item L\+T\+E
\end{DoxyItemize}

\begin{DoxyNote}{Note}
L\+E\+\_\+\+M\+R\+C\+\_\+\+B\+I\+T\+M\+A\+S\+K\+\_\+\+R\+A\+T\+\_\+\+A\+L\+L value can be used to select the R\+A\+T in automatic mode.
\end{DoxyNote}
\hypertarget{c_mrc_le_mrc_registration}{}\subsubsection{Network Registration}\label{c_mrc_le_mrc_registration}
\hyperlink{le__mrc__interface_8h_a4f11e27862fef384c0023f5b538e543d}{le\+\_\+mrc\+\_\+\+Get\+Net\+Reg\+State()} A\+P\+I retrieves the radio module network registration status.

The application can register a handler function to retrieve the registration status each time the registration state changes.

\hyperlink{le__mrc__interface_8h_a929745b84719754d28f539540f71a552}{le\+\_\+mrc\+\_\+\+Add\+Net\+Reg\+State\+Event\+Handler()} A\+P\+I installs a registration state handler.

le\+\_\+mrc\+\_\+\+Remove\+Net\+Reg\+State\+Handler() A\+P\+I uninstalls the handler function. \begin{DoxyNote}{Note}
If only one handler is registered, the le\+\_\+mrc\+\_\+\+Remove\+Net\+Reg\+State\+Handler() A\+P\+I resets the registration mode to its original value before any handler functions were added.
\end{DoxyNote}
\hyperlink{le__mrc__interface_8h_a578262185e6c0514e4ad5ba584c360ca}{le\+\_\+mrc\+\_\+\+Register\+Cellular\+Network()} A\+P\+I registers on a cellular network.\hypertarget{c_mrc_le_mrc_signal}{}\subsubsection{Signal Quality}\label{c_mrc_le_mrc_signal}
\hyperlink{le__mrc__interface_8h_a717aa0f4e4dc9a83b6adc2f26f3f0258}{le\+\_\+mrc\+\_\+\+Get\+Signal\+Qual()} retrieves the received signal strength details.

You must call \hyperlink{le__mrc__interface_8h_ad3662723a7ed47cf45d9a2eaaa1fb16e}{le\+\_\+mrc\+\_\+\+Measure\+Signal\+Metrics()} to measure the signal metrics of the serving cell (aka the \textquotesingle{}serving\textquotesingle{} cell). It returns a reference of le\+\_\+mrc\+\_\+\+Metrics\+Ref\+\_\+t type.

When the signal metrics are no longer needed, you must call \hyperlink{le__mrc__interface_8h_a20addd98ee6cb07f9ee1a45be01b5203}{le\+\_\+mrc\+\_\+\+Delete\+Signal\+Metrics()} to free all allocated ressources associated with the Metrics object.

\hyperlink{le__mrc__interface_8h_a5564bace31c937bcef096e597f33d3a4}{le\+\_\+mrc\+\_\+\+Get\+Rat\+Of\+Signal\+Metrics()} returns the Radio Access Technology of the signal measures.

\hyperlink{le__mrc__interface_8h_a9d7243b29bf4c705c4eba83fa3799582}{le\+\_\+mrc\+\_\+\+Get\+Gsm\+Signal\+Metrics()} the signal strength in d\+Bm and the bit error rate measured on G\+S\+M network.

\hyperlink{le__mrc__interface_8h_a456648564abfc8e9711b60a5d8bddc9b}{le\+\_\+mrc\+\_\+\+Get\+Umts\+Signal\+Metrics()} returns the signal metrics measured on U\+M\+T\+S network.

\hyperlink{le__mrc__interface_8h_a030880c064afbf2686726fd2e538adfe}{le\+\_\+mrc\+\_\+\+Get\+Lte\+Signal\+Metrics()} returns the signal metrics measured on L\+T\+E network.

\hyperlink{le__mrc__interface_8h_a09ff33b24fd01be18a145b2b3f1f579a}{le\+\_\+mrc\+\_\+\+Get\+Cdma\+Signal\+Metrics()} returns the signal metrics measured on C\+D\+M\+A network.

The application can register a handler function to get notifications when the signal strength changes of a certain threshold value.

\hyperlink{le__mrc__interface_8h_ab62b444715b2b530efe5d397eb86a6e8}{le\+\_\+mrc\+\_\+\+Add\+Signal\+Strength\+Change\+Handler()} A\+P\+I installs a signal strength change handler. The R\+A\+T, the lower-\/range and the upper-\/range thresholds must be passed as input parameters. These parameters are updated each time the function is called, the previous thresholds are replaced by the new ones if the function is called with the same R\+A\+T.

The event is notified when we cross the range limits in both direction.

\hyperlink{le__mrc__interface_8h_a789dca8360ddf32a0ea1bfdd24efc6d4}{le\+\_\+mrc\+\_\+\+Remove\+Signal\+Strength\+Change\+Handler()} A\+P\+I uninstalls the handler function.\hypertarget{c_mrc_le_mrc_location}{}\subsubsection{Serving cell\textquotesingle{}s location information}\label{c_mrc_le_mrc_location}
\hyperlink{le__mrc__interface_8h_aafc9fb71c3013b7b26dc386b13ca4a85}{le\+\_\+mrc\+\_\+\+Get\+Serving\+Cell\+Id()} retrieves the the serving Cell Identifier.

\hyperlink{le__mrc__interface_8h_a8ba03765e7595f85783f6f6a022311f8}{le\+\_\+mrc\+\_\+\+Get\+Serving\+Cell\+Loc\+Area\+Code()} retrieves the Location Area Code of the serving cell.\hypertarget{c_mrc_le_mrc_network_information}{}\subsubsection{Current Network Information}\label{c_mrc_le_mrc_network_information}
\hyperlink{le__mrc__interface_8h_a27e5eaddd6df34e4bfcee7d25775591e}{le\+\_\+mrc\+\_\+\+Get\+Current\+Network\+Name()} retrieves the Current Network Name. \hyperlink{le__mrc__interface_8h_a2e476636ca33c40ce18b73b11a6f9f55}{le\+\_\+mrc\+\_\+\+Get\+Current\+Network\+Mcc\+Mnc()} retrieves the Current Network P\+L\+M\+N information.\hypertarget{c_mrc_le_mrc_networkScan}{}\subsubsection{Network Scan}\label{c_mrc_le_mrc_networkScan}
Call \hyperlink{le__mrc__interface_8h_ab4a246dd466fa8175aca0158e0cab227}{le\+\_\+mrc\+\_\+\+Perform\+Cellular\+Network\+Scan()} to fill a list of all network in sight. You can go through all Scan Information by calling \hyperlink{le__mrc__interface_8h_ae006d053b037cec589aa85053472a2af}{le\+\_\+mrc\+\_\+\+Get\+First\+Cellular\+Network\+Scan()} and \hyperlink{le__mrc__interface_8h_ae0ca9f0c1c106d6ddeef784c6bb0d69b}{le\+\_\+mrc\+\_\+\+Get\+Next\+Cellular\+Network\+Scan()}.

For each Scan Information, you can call\+:


\begin{DoxyItemize}
\item \hyperlink{le__mrc__interface_8h_af4fa2d3f3c9a664b8e46478dba048f2e}{le\+\_\+mrc\+\_\+\+Get\+Cellular\+Network\+Mcc\+Mnc()} to have the operator code.
\item \hyperlink{le__mrc__interface_8h_a82cb12c5f02baccbb04b0af1be4eb031}{le\+\_\+mrc\+\_\+\+Get\+Cellular\+Network\+Name()} to get the operator name.
\item \hyperlink{le__mrc__interface_8h_ad33fbe1d2b7acee0e47f3e54cab78274}{le\+\_\+mrc\+\_\+\+Get\+Cellular\+Network\+Rat()} to get the radio access technology.
\item \hyperlink{le__mrc__interface_8h_a4c859fc1364c183aa1d26a022db365c6}{le\+\_\+mrc\+\_\+\+Is\+Cellular\+Network\+In\+Use()} to check if this is currently in use by the network.
\item \hyperlink{le__mrc__interface_8h_a72ca8072f90d453169baff44441c41c0}{le\+\_\+mrc\+\_\+\+Is\+Cellular\+Network\+Available()} to check if this is available.
\item \hyperlink{le__mrc__interface_8h_a7333dfc638f50524f9c6fd81457828ba}{le\+\_\+mrc\+\_\+\+Is\+Cellular\+Network\+Home()} to check if this is in home status.
\item \hyperlink{le__mrc__interface_8h_a699a52d014550124a5b3362ee888a780}{le\+\_\+mrc\+\_\+\+Is\+Cellular\+Network\+Forbidden()} to check if this is forbidden by the network.
\end{DoxyItemize}

\hyperlink{le__mrc__interface_8h_ac45ce335b3fa063b83bb925e67eeaeb3}{le\+\_\+mrc\+\_\+\+Delete\+Cellular\+Network\+Scan()} should be called when you do not need the list anymore.

Usage example\+: 
\begin{DoxyCode}
\hyperlink{le__mrc__interface_8h_a25a9e79cc9078e22cec22444fd959c61}{le\_mrc\_ScanInformationListRef\_t} scanInformationList = NULL;

scanInformationList = \hyperlink{le__mrc__interface_8h_ab4a246dd466fa8175aca0158e0cab227}{le\_mrc\_PerformCellularNetworkScan}(
      \hyperlink{le__mrc__interface_8h_af643c7005da7f2466302eebdf7a29d93aa6e87ad274b7f5011413ea0e8375300b}{LE\_MRC\_BITMASK\_RAT\_ALL});

\textcolor{keywordflow}{if} (!scanInformationList)
\{
    fprintf(stdout, \textcolor{stringliteral}{"Could not perform scan\(\backslash\)n"});
    \textcolor{keywordflow}{return};
\}

\hyperlink{le__mrc__interface_8h_a3e7fe3e0d8f10fe7853f00eb254529ea}{le\_mrc\_ScanInformationRef\_t} cellRef;

\textcolor{keywordflow}{for} (cellRef=\hyperlink{le__mrc__interface_8h_ae006d053b037cec589aa85053472a2af}{le\_mrc\_GetFirstCellularNetworkScan}(scanInformationList);
     cellRef!=NULL;
     cellRef=\hyperlink{le__mrc__interface_8h_ae0ca9f0c1c106d6ddeef784c6bb0d69b}{le\_mrc\_GetNextCellularNetworkScan}(scanInformationList))
\{
    le\_mrc\_Rat rat;
    \textcolor{keywordtype}{char} mcc[4],mnc[4];
    \textcolor{keywordtype}{char} name[100];

    rat = \hyperlink{le__mrc__interface_8h_ad33fbe1d2b7acee0e47f3e54cab78274}{le\_mrc\_GetCellularNetworkRat}(cellRef);

    fprintf(stdout, \textcolor{stringliteral}{"Rat %d "},rat);

    \textcolor{keywordflow}{if} (\hyperlink{le__mrc__interface_8h_af4fa2d3f3c9a664b8e46478dba048f2e}{le\_mrc\_GetCellularNetworkMccMnc}(cellRef,mcc,\textcolor{keyword}{sizeof}(mcc),mnc,\textcolor{keyword}{sizeof}(
      mnc))!=\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        fprintf(stdout, \textcolor{stringliteral}{"Failed to get operator code.\(\backslash\)n"});
    \}
    \textcolor{keywordflow}{else}
    \{
        fprintf(stdout, \textcolor{stringliteral}{"[%s-%s] "},mcc,mnc);
    \}

    \textcolor{keywordflow}{if} (\hyperlink{le__mrc__interface_8h_a82cb12c5f02baccbb04b0af1be4eb031}{le\_mrc\_GetCellularNetworkName}(cellRef, name, \textcolor{keyword}{sizeof}(name)) != 
      \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        fprintf(stdout, \textcolor{stringliteral}{"Failed to get operator name.\(\backslash\)n"});
    \}
    \textcolor{keywordflow}{else}
    \{
        fprintf(stdout, \textcolor{stringliteral}{"%-32s"},name);
    \}

    fprintf(stdout,\textcolor{stringliteral}{"%-15s,"},\hyperlink{le__mrc__interface_8h_a4c859fc1364c183aa1d26a022db365c6}{le\_mrc\_IsCellularNetworkInUse}(cellRef)?\textcolor{stringliteral}{"Is used"}:\textcolor{stringliteral}{"
      Is not used"});

    fprintf(stdout,\textcolor{stringliteral}{"%-20s,"},\hyperlink{le__mrc__interface_8h_a72ca8072f90d453169baff44441c41c0}{le\_mrc\_IsCellularNetworkAvailable}(cellRef)?\textcolor{stringliteral}{"Is
       available"}:\textcolor{stringliteral}{"Is not available"});

    fprintf(stdout,\textcolor{stringliteral}{"%-10s,"},\hyperlink{le__mrc__interface_8h_a7333dfc638f50524f9c6fd81457828ba}{le\_mrc\_IsCellularNetworkHome}(cellRef)?\textcolor{stringliteral}{"Home"}:\textcolor{stringliteral}{"
      Roaming"});

    fprintf(stdout,\textcolor{stringliteral}{"%-10s]\(\backslash\)n"},\hyperlink{le__mrc__interface_8h_a699a52d014550124a5b3362ee888a780}{le\_mrc\_IsCellularNetworkForbidden}(cellRef)?\textcolor{stringliteral}{"
      Forbidden"}:\textcolor{stringliteral}{"Allowed"});

\}

\hyperlink{le__mrc__interface_8h_ac45ce335b3fa063b83bb925e67eeaeb3}{le\_mrc\_DeleteCellularNetworkScan}(scanInformationList);
\end{DoxyCode}
\hypertarget{c_mrc_le_mrc_ngbr}{}\subsubsection{Neighboring Cells Information}\label{c_mrc_le_mrc_ngbr}
\begin{DoxyWarning}{Warning}
The following functions do not apply to C\+D\+M\+A network.
\end{DoxyWarning}
You must call \hyperlink{le__mrc__interface_8h_a8d44fe46e61f3399c5e0dd6002b042ae}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cells\+Info()} to retrieve the neighboring cells information. It returns a reference of le\+\_\+mrc\+\_\+\+Neighbor\+Cells\+Ref\+\_\+t type.

When the neighboring cells information is no longer needed, you must call \hyperlink{le__mrc__interface_8h_a101343359e8d36ab41180aede2891b07}{le\+\_\+mrc\+\_\+\+Delete\+Neighbor\+Cells\+Info()} to free all allocated resources associated with the object.

Then, you can use the following function to get the information\+:
\begin{DoxyItemize}
\item \hyperlink{le__mrc__interface_8h_ab50724fd74818d71da1dfcd2217dd795}{le\+\_\+mrc\+\_\+\+Get\+First\+Neighbor\+Cell\+Info()} and \hyperlink{le__mrc__interface_8h_ab50724fd74818d71da1dfcd2217dd795}{le\+\_\+mrc\+\_\+\+Get\+First\+Neighbor\+Cell\+Info()} allow to go among the single cell information retrieved with \hyperlink{le__mrc__interface_8h_a8d44fe46e61f3399c5e0dd6002b042ae}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cells\+Info()}. These two functions return a reference of le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t type.
\item \hyperlink{le__mrc__interface_8h_abdbc94e474235417d8610e2eb95558eb}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Id()} gets the identifier of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter (can be called for any kind of R\+A\+T).
\item \hyperlink{le__mrc__interface_8h_a70ba0ca70367bc673a6bca1e246bb88f}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Loc\+Area\+Code()} gets the location area code of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter (can be called for any kind of R\+A\+T). 0x\+F\+F\+F\+F value is returned if the value is not available.
\item \hyperlink{le__mrc__interface_8h_aeae116235802afd041afd9df009642aa}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Rx\+Level()} gets the signal strength (in d\+Bm) of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter (can be called for any kind of R\+A\+T).
\item \hyperlink{le__mrc__interface_8h_a5bb3e75b74260a9cee57247e1968a31f}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Rat()} gets the Radio Access Technology of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter.
\item \hyperlink{le__mrc__interface_8h_a94e452e3d7063d3359dcbb97a31b984b}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Umts\+Ec\+Io()} gets the Ec/\+Io (the received energy per chip divided by the power density in the band measured in d\+Bm on the primary C\+P\+I\+C\+H channel of serving cell) of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter.
\item \hyperlink{le__mrc__interface_8h_a7754836120c34cd2610b9777bd56409f}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Lte\+Intra\+Freq()} gets the R\+S\+R\+P and R\+S\+R\+Q of the Interfrequency of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter.
\item \hyperlink{le__mrc__interface_8h_a331545d4e396c513bba028db981c016b}{le\+\_\+mrc\+\_\+\+Get\+Neighbor\+Cell\+Lte\+Inter\+Freq()} gets the R\+S\+R\+P and R\+S\+R\+Q of the Interfrequency of the cell specified with the le\+\_\+mrc\+\_\+\+Cell\+Info\+Ref\+\_\+t parameter.
\end{DoxyItemize}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_riPin}{}\subsection{Ring Indicator Signal}\label{c_riPin}
\hyperlink{le__ri_pin__interface_8h}{A\+P\+I Reference}





The Ring Indicator pin is used to allow the module to wake up a host device.\hypertarget{c_ri_pin_c_riPin_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_ri_pin_c_riPin_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service} app.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_riPin -> modemService.le_riPin
}
\end{DoxyVerb}
\hypertarget{c_ri_pin_c_riPin_usage}{}\subsubsection{Ring Indication signal}\label{c_ri_pin_c_riPin_usage}
The R\+I\+N\+G pin can be configured to notify a host device with different timing of pulse signals for different module activities.


\begin{DoxyItemize}
\item \hyperlink{le__ri_pin__interface_8h_a3fa556aaae988f3a835ac2bc89cbfd59}{le\+\_\+ri\+Pin\+\_\+\+Am\+I\+Owner\+Of\+Ring\+Signal()} function checks whether the application core is the current owner of the Ring Indicator signal.
\item \hyperlink{le__ri_pin__interface_8h_a2cdbeb7aa773f498780058bea06c6553}{le\+\_\+ri\+Pin\+\_\+\+Take\+Ring\+Signal()} function takes control of the Ring Indicator signal.
\item \hyperlink{le__ri_pin__interface_8h_a7fd705c4c6ae5e70c076461b25379440}{le\+\_\+ri\+Pin\+\_\+\+Release\+Ring\+Signal()} function releases control of the Ring Indicator signal.
\item \hyperlink{le__ri_pin__interface_8h_afdf9b77f43ec0cd8c7ceb91e5993d382}{le\+\_\+ri\+Pin\+\_\+\+Pulse\+Ring\+Signal()} function sets the ring signal high for configurable duration of time before lowering it.
\end{DoxyItemize}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_rtc}{}\subsection{User Timebase}\label{c_rtc}
\hyperlink{le__rtc__interface_8h}{A\+P\+I Reference} ~\newline
 \hyperlink{howToSetUserTimebase}{Set User Timebase} 



This A\+P\+I provides definitions to read and set the {\itshape user} timebase for a target\textquotesingle{}s real time clock (R\+T\+C).

Usually, the time daemon automatically updates the system time (i.\+e., gets time value when calling \hyperlink{le__clock_8h_a33197dbd676a37b8c4d5de8f93edc1ee}{le\+\_\+clk\+\_\+\+Get\+Absolute\+Time()} or using Linux {\ttfamily date} command). In some cases, the R\+T\+C time value may require a user timebase value based on other domains (e.\+g., G\+P\+S) to offset differences between the battery-\/powered R\+T\+C and the system time.

If you\textquotesingle{}re synchronizng with cellular network time only, the time daemon will update the system time (the time you get when calling \hyperlink{le__clock_8h_a33197dbd676a37b8c4d5de8f93edc1ee}{le\+\_\+clk\+\_\+\+Get\+Absolute\+Time()} or using linux \textquotesingle{}date\textquotesingle{} command) automatically.\hypertarget{c_rtc_c_rtc_disableDaemon}{}\subsubsection{Disable Time Daemon}\label{c_rtc_c_rtc_disableDaemon}
If you need to set the system time from a saved user timebase value, you should disable the time daemon by commenting out the {\ttfamily T\+I\+M\+E\+\_\+\+S\+E\+R\+V\+I\+C\+E\+S=\char`\"{}qcom\+\_\+time\char`\"{}} line in {\ttfamily /etc/time\+\_\+service}.conf to prevent the system time from being updated if the modem receives a new time from a cellular network.

\begin{DoxyNote}{Note}
The time stored in the user timebase is incremented on a millisecond basis; Unix time is incremented by the second. When storing Unix time in the user timebase, it must be multiplied by 1000, and, conversely, must be divided by 1000 when retrieved.
\end{DoxyNote}
\hypertarget{c_rtc_c_rtc_getSet}{}\subsubsection{Get/\+Set Time Value}\label{c_rtc_c_rtc_getSet}
Use \hyperlink{le__rtc__interface_8h_a1819b745bbef6d340305ce07b9b7ce2f}{le\+\_\+rtc\+\_\+\+Get\+User\+Time()} to read the current R\+T\+C time, and \hyperlink{le__rtc__interface_8h_a6d4e09df04dfb0c8a8e1386030bdf83c}{le\+\_\+rtc\+\_\+\+Set\+User\+Time()} to set the user timebase adjustment (plus/minus in milliseconds).





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_sim}{}\subsection{S\+I\+M}\label{c_sim}
\hyperlink{le__sim__interface_8h}{A\+P\+I Reference}





This file contains prototype definitions for S\+I\+M A\+P\+I.

A subscriber identity module or subscriber identification module (S\+I\+M) is an integrated circuit that securely stores the international mobile subscriber identity (I\+M\+S\+I) and related key used to identify and authenticate subscribers on M2\+M devices.

Most S\+I\+M cards can store a number of S\+M\+S messages and phone book contacts.

\hyperlink{le__sim__interface_8h_a4c9e3ded0485f14c66e4d51763f2de57}{le\+\_\+sim\+\_\+\+Get\+Selected\+Card()} returns the selected S\+I\+M card number.\hypertarget{c_sim_le_sim_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_sim_le_sim_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service}.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_sim -> modemService.le_sim
}
\end{DoxyVerb}
\hypertarget{c_sim_le_sim_SelectCard}{}\subsubsection{Select a card to use}\label{c_sim_le_sim_SelectCard}
\hyperlink{le__sim__interface_8h_a91a0f0399c89e466b9a8ccfab6de129d}{le\+\_\+sim\+\_\+\+Select\+Card()} function is used to select the S\+I\+M. By default, the S\+I\+M in slot 1 is used. \begin{DoxyNote}{Note}
The S\+I\+M selection is not reset persistent; this function has to be called at each start-\/up.

\+: It is recommended to wait for a S\+I\+M handler notification after a new S\+I\+M selection before calling le\+\_\+sim A\+P\+I functions.
\end{DoxyNote}
\hypertarget{c_sim_le_sim_id}{}\subsubsection{S\+I\+M identification information}\label{c_sim_le_sim_id}
{\bfseries I\+C\+C\+I\+D\+:} Each S\+I\+M is internationally identified by its integrated circuit card identifier (I\+C\+C\+I\+D). I\+C\+C\+I\+Ds are stored in the S\+I\+M cards and engraved or printed on the S\+I\+M card body. The I\+C\+C\+I\+D is defined by the I\+T\+U-\/\+T recommendation E.\+118 as the Primary Account Number. According to E.\+118, the number is up to 19 digits long, including a single check digit calculated using the Luhn algorithm. However, the G\+S\+M Phase 1 (E\+T\+S\+I Recommendation G\+S\+M 11.\+11) defined the I\+C\+C\+I\+D length as 10 octets (20 digits) with operator-\/specific structure.

\hyperlink{le__sim__interface_8h_a90cbc71edc9bee227502f3836f5fa117}{le\+\_\+sim\+\_\+\+Get\+I\+C\+C\+I\+D()} A\+P\+I reads the identification number (I\+C\+C\+I\+D).

Using this A\+P\+I selects the requested S\+I\+M.

{\bfseries I\+M\+S\+I\+:} The International Mobile Subscriber Identity or I\+M\+S\+I is a unique identification associated with all cellular networks. The I\+M\+S\+I is used in any mobile network that connects with other networks. For G\+S\+M, U\+M\+T\+S and L\+T\+E network, this number is provisioned in the S\+I\+M card.

An I\+M\+S\+I is usually presented as a 15 digit long number, but can be shorter. The first 3 digits are the mobile country code (M\+C\+C), are followed by the mobile network code (M\+N\+C), either 2 digits (European standard) or 3 digits (North American standard). The length of the M\+N\+C depends on the value of the M\+C\+C. The remaining digits are the mobile subscription identification number (M\+S\+I\+N) within the network\textquotesingle{}s customer base.

{\bfseries Home} {\bfseries Network} {\bfseries Name\+:} \hyperlink{le__sim__interface_8h_a2a6676da979e90e12010e084f304660b}{le\+\_\+sim\+\_\+\+Get\+Home\+Network\+Operator()} retrieves the Home Network Name.

\hyperlink{le__sim__interface_8h_aedcba6023de6b7ec0a2cf3d2ca725b49}{le\+\_\+sim\+\_\+\+Get\+I\+M\+S\+I()} A\+P\+I reads the international mobile subscriber identity (I\+M\+S\+I).

Using this A\+P\+I selects the requested S\+I\+M.

{\bfseries Phone} {\bfseries Number\+:} \hyperlink{le__sim__interface_8h_a68a907c8b75749b0647721604a8deb12}{le\+\_\+sim\+\_\+\+Get\+Subscriber\+Phone\+Number()} A\+P\+I reads the Phone Number associated to the S\+I\+M. If the phone number has not been provisioned, it will return the empty string.

Using this A\+P\+I selects the requested S\+I\+M.

{\bfseries Home} {\bfseries Network} {\bfseries Information\+:} 
\begin{DoxyItemize}
\item \hyperlink{le__sim__interface_8h_a2a6676da979e90e12010e084f304660b}{le\+\_\+sim\+\_\+\+Get\+Home\+Network\+Operator()}function retrieves the Home Network Name.
\item \hyperlink{le__sim__interface_8h_a048b9cc4aed3f4c2fcf6ca34f40e99a9}{le\+\_\+sim\+\_\+\+Get\+Home\+Network\+Mcc\+Mnc()}function retrieves the Home Network M\+C\+C (Mobile Country Code) and M\+N\+C (Mobile Network Code).
\end{DoxyItemize}\hypertarget{c_sim_le_sim_auth}{}\subsubsection{S\+I\+M Authentication}\label{c_sim_le_sim_auth}
\hyperlink{le__sim__interface_8h_a7d9de57c8931013432cd41b26d1e7585}{le\+\_\+sim\+\_\+\+Enter\+P\+I\+N()} enters the P\+I\+N (Personal Identification Number) code that\textquotesingle{}s required before any Mobile equipment functionality can be used.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_a8886dbb94aa732883ec5a67ddd345f98}{le\+\_\+sim\+\_\+\+Get\+Remaining\+P\+I\+N\+Tries()} returns the number of remaining P\+I\+N entry attempts before the S\+I\+M will become blocked.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_a761bbdf28094b906236320445d9b9166}{le\+\_\+sim\+\_\+\+Change\+P\+I\+N()} must be called to change the P\+I\+N code.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_a9e21c9a633b4675997238cefaa96b9a8}{le\+\_\+sim\+\_\+\+Lock()} locks the S\+I\+M card\+: it enables requests for the P\+I\+N code.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_a36f50d2da76a981a8f671424dccb1c1d}{le\+\_\+sim\+\_\+\+Unlock()} unlocks the S\+I\+M card\+: it disables requests for the P\+I\+N code.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_a77293780d1e14f291418181c7c3c11f0}{le\+\_\+sim\+\_\+\+Unblock()} unblocks the S\+I\+M card. The S\+I\+M card is blocked after X unsuccessful attempts to enter the P\+I\+N. \hyperlink{le__sim__interface_8h_a77293780d1e14f291418181c7c3c11f0}{le\+\_\+sim\+\_\+\+Unblock()} requires the P\+U\+K (Personal Unblocking) code to set a new P\+I\+N code.

Using this A\+P\+I selects the requested S\+I\+M.\hypertarget{c_sim_le_sim_state}{}\subsubsection{S\+I\+M states}\label{c_sim_le_sim_state}
\hyperlink{le__sim__interface_8h_aa3255a29cec4358c5e0d68b9ac62ff88}{le\+\_\+sim\+\_\+\+Is\+Present()} A\+P\+I advises the S\+I\+M is inserted (and locked) or removed.

Using this A\+P\+I selects the requested S\+I\+M.

\hyperlink{le__sim__interface_8h_ace457890856d3692ecb4176f0e892558}{le\+\_\+sim\+\_\+\+Is\+Ready()} A\+P\+I advises the S\+I\+M is ready (P\+I\+N code correctly entered or not required).

Using this A\+P\+I selects the requested S\+I\+M.

The \hyperlink{le__sim__interface_8h_a16b06f266471d81f772e5439ec570144}{le\+\_\+sim\+\_\+\+Get\+State()} A\+P\+I retrieves the S\+I\+M state\+:
\begin{DoxyItemize}
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+I\+N\+S\+E\+R\+T\+E\+D \+: S\+I\+M card is inserted and locked.
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+A\+B\+S\+E\+N\+T \+: S\+I\+M card is absent.
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+R\+E\+A\+D\+Y \+: S\+I\+M card is inserted and unlocked.
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+B\+L\+O\+C\+K\+E\+D \+: S\+I\+M card is blocked.
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+B\+U\+S\+Y \+: S\+I\+M card is busy.
\item L\+E\+\_\+\+S\+I\+M\+\_\+\+S\+T\+A\+T\+E\+\_\+\+U\+N\+K\+N\+O\+W\+N \+: Unknown S\+I\+M state.
\end{DoxyItemize}

Using this A\+P\+I selects the requested S\+I\+M.

A handler function must be registered to receive S\+I\+M\textquotesingle{}s state notifications. \hyperlink{le__sim__interface_8h_a8e296a7cd35edd99cb1dc21232e280dd}{le\+\_\+sim\+\_\+\+Add\+New\+State\+Handler()} A\+P\+I allows the User to register that handler.

The handler must satisfy the following prototype\+: typedef void($\ast$le\+\_\+sim\+\_\+\+New\+State\+Handler\+Func\+\_\+t)(le\+\_\+sim\+\_\+\+Id\+\_\+t sim\+Id, le\+\_\+sim\+\_\+\+States\+\_\+t sim\+State);

When a new S\+I\+M\textquotesingle{}s state is notified, the handler is called.

Call \hyperlink{le__sim__interface_8h_a16b06f266471d81f772e5439ec570144}{le\+\_\+sim\+\_\+\+Get\+State()} to retrieve the new state of the S\+I\+M.

\begin{DoxyNote}{Note}
If two (or more) applications have registered a handler function for notifications, they will all receive it and will be passed the same S\+I\+M.
\end{DoxyNote}
The application can uninstall the handler function by calling \hyperlink{le__sim__interface_8h_a8e3a4e2e978cf4931a39317ee5e9f762}{le\+\_\+sim\+\_\+\+Remove\+New\+State\+Handler()} A\+P\+I.\hypertarget{c_sim_le_sim_profile_switch}{}\subsubsection{Local S\+I\+M profile switch}\label{c_sim_le_sim_profile_switch}
As soon as there are several subscriptions/profiles in the e\+U\+I\+C\+C (multi-\/profile), and one of them is dedicated to emergency calls (ex\+: e\+Call, E\+R\+A-\/\+Glonass), local swap is needed to swap as quickly as possible to the emergency profile in case of need.

“\+Local swap” means that the User\textquotesingle{}s application must be able to directly request the e\+U\+I\+C\+C to swap to Emergency Call Subscription (E\+C\+S).

Local swap puts the e\+U\+I\+C\+C in a temporary state, meaning the commercial subscription is replaced by emergency subscription for a limited time, event triggering the swap back to commercial subscription being controlled by the User\textquotesingle{}s application.

The \hyperlink{le__sim__interface_8h_aa856f5e094e8182c8d0b07761e309549}{le\+\_\+sim\+\_\+\+Local\+Swap\+To\+Emergency\+Call\+Subscription()} function requests the multi-\/profile e\+U\+I\+C\+C to swap to E\+C\+S and to refresh. The User\textquotesingle{}s application must wait for e\+U\+I\+C\+C reboot to be finished and network connection available.

The \hyperlink{le__sim__interface_8h_a51b535750b66c4cf460e3c8c72f3658d}{le\+\_\+sim\+\_\+\+Local\+Swap\+To\+Commercial\+Subscription()} function requests the multi-\/profile e\+U\+I\+C\+C to swap back to commercial subscription and to refresh. The User\textquotesingle{}s application must wait for e\+U\+I\+C\+C reboot to be finished and network connection available.

The User\textquotesingle{}s application can install an handler with \hyperlink{le__sim__interface_8h_a8e296a7cd35edd99cb1dc21232e280dd}{le\+\_\+sim\+\_\+\+Add\+New\+State\+Handler()} to receive e\+U\+I\+C\+C\textquotesingle{}s state notifications.

\begin{DoxyWarning}{Warning}
If you use a Giesecke \& Devrient (G\&D) card, be sure that your platform has disabled security restrictions for channel management A\+P\+D\+U commands, otherwise local S\+I\+M profile switch could not work.
\end{DoxyWarning}
The \hyperlink{le__sim__interface_8h_a837cdc0fe30761f4339f846a0b44c5f1}{le\+\_\+sim\+\_\+\+Is\+Emergency\+Call\+Subscription\+Selected()} function must be called to get the current subscription.

\begin{DoxyWarning}{Warning}
There is no standard method to interrogate the current selected subscription. The returned value of this function is based on the last executed local swap command. This means that this function will always return L\+E\+\_\+\+N\+O\+T\+\_\+\+F\+O\+U\+N\+D error at Legato startup.
\end{DoxyWarning}
\hypertarget{c_sim_le_sim_stk}{}\subsubsection{S\+I\+M Toolkit}\label{c_sim_le_sim_stk}
The S\+I\+M application Toolkit allows the S\+I\+M card to initiates commands or asking input from the modem to accept/reject S\+I\+M operations.

One of the use case is the remote provisioning of an embedded U\+I\+C\+C (e\+U\+I\+C\+C).

The embedded U\+I\+C\+C (e\+U\+I\+C\+C) format supports multiple subscription profiles, which can be remotely provisioned, updated or selected through S\+I\+M tool kit procedures (Bearer Independent Protocol -\/\+B\+I\+P-\/, S\+I\+M refresh).

It is mainly used for in-\/vehicle emergency call service (e\+Call).

An e\+U\+I\+C\+C can be remotely managed to change the Mobile Network Operator subscription.

The \hyperlink{le__sim__interface_8h_a85577728a34d70801cbb4deb8efd75d5}{le\+\_\+sim\+\_\+\+Add\+Sim\+Toolkit\+Event\+Handler()} function registers a handler to be notified of S\+I\+M Toolkit events.

The \hyperlink{le__sim__interface_8h_a487be241cae0657f96bcc44d0f8fab5a}{le\+\_\+sim\+\_\+\+Remove\+Sim\+Toolkit\+Event\+Handler()} function unregisters the handler.

The \hyperlink{le__sim__interface_8h_a8cc75a17466446c19c5bd941b1360e0e}{le\+\_\+sim\+\_\+\+Accept\+Sim\+Toolkit\+Command()} allows the device to accept the last S\+I\+M Toolkit command.

The \hyperlink{le__sim__interface_8h_a8cbdc50d62ddd5ea80386d27e16d954f}{le\+\_\+sim\+\_\+\+Reject\+Sim\+Toolkit\+Command()} forbids the device to accept the last S\+I\+M Toolkit command.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_temp}{}\subsection{Temperature Monitoring}\label{c_temp}
\hyperlink{le__temp__interface_8h}{A\+P\+I Reference}





The Temperature A\+P\+I is used to retrieve Platform and Radio \textquotesingle{}s temperature values and set warning and critical thresholds.

\begin{DoxyWarning}{Warning}
When a Critical event occurs, some platform can automatically switch off.
\end{DoxyWarning}
\hypertarget{c_temp_le_temp_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_temp_le_temp_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service} application service.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_temp -> modemService.le_temp
}
\end{DoxyVerb}
\hypertarget{c_temp_c_temp_radio}{}\subsubsection{Radio Temperature Thresholds}\label{c_temp_c_temp_radio}
Two Thresholds are set to notify the Radio temperature state\+: the warning and the critical radio temperature thresholds.

if the Radio temperature reachs the\+:
\begin{DoxyItemize}
\item \char`\"{}\+Critical Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+R\+A\+D\+I\+O\+\_\+\+H\+I\+\_\+\+C\+R\+I\+T\+I\+C\+A\+L event occurs.
\item \char`\"{}\+Warning Threshold\char`\"{} but still lower than \char`\"{}\+Critical Threshold\char`\"{}, L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+R\+A\+D\+I\+O\+\_\+\+H\+I\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs.
\end{DoxyItemize}

if the Radio temperature decreases below the\+:
\begin{DoxyItemize}
\item \char`\"{}\+Critical Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+R\+A\+D\+I\+O\+\_\+\+H\+I\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs.
\item \char`\"{}\+Warning Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+R\+A\+D\+I\+O\+\_\+\+N\+O\+R\+M\+A\+L event occurs.
\end{DoxyItemize}

\begin{DoxyWarning}{Warning}
An hysteresis can be dependent of the platform. Be sure to verify your platform\textquotesingle{}s specifications.
\end{DoxyWarning}
\hypertarget{c_temp_c_temp_platform}{}\subsubsection{Platform Temperature Thresholds}\label{c_temp_c_temp_platform}
Fours Thresholds are set to decide the state\+: the low critical, low warning, high warning and the high critical Platform temperatures thresholds

if the Platform temperature reachs the\+:
\begin{DoxyItemize}
\item \char`\"{}high Critical Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+H\+I\+\_\+\+C\+R\+I\+T\+I\+C\+A\+L\+L event occurs.
\item \char`\"{}high Warning Threshold\char`\"{} but still lower than \char`\"{}high Critical Threshold\char`\"{}, L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+H\+I\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs
\end{DoxyItemize}

if the Platform temperature decreases below the\+:
\begin{DoxyItemize}
\item \char`\"{}low Warning Threshold\char`\"{} but still higher than \char`\"{}low Critical Threshold\char`\"{}, L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+L\+O\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs.
\item \char`\"{}low Critical Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+L\+O\+\_\+\+C\+R\+I\+T\+I\+C\+A\+L\+L event occurs.
\end{DoxyItemize}

if the Platform temperature decreases below the\+:
\begin{DoxyItemize}
\item \char`\"{}hi Critical Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+H\+I\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs.
\item \char`\"{}hi Warning Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+N\+O\+R\+M\+A\+L event occurs.
\end{DoxyItemize}

if the Platform temperature reachs the\+:
\begin{DoxyItemize}
\item \char`\"{}low Warning Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+N\+O\+R\+M\+A\+L event occurs..
\item \char`\"{}low Critical Threshold\char`\"{} but still lower than \char`\"{}high Warning Threshold\char`\"{}, a L\+E\+\_\+\+T\+E\+M\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+L\+O\+\_\+\+W\+A\+R\+N\+I\+N\+G event occurs..
\end{DoxyItemize}

\begin{DoxyWarning}{Warning}
An hysteresis can be dependent of the platform. Be sure to verify your platform\textquotesingle{}s specifications.
\end{DoxyWarning}
\hypertarget{c_temp_Temperature}{}\subsubsection{Monitoring}\label{c_temp_Temperature}
This functionality allows to monitoring the platform temperature by getting the current Platform or Radio temperature and by setting warning and critical thresholds temperature.

\begin{DoxyWarning}{Warning}
On some platforms, the thresholds parameters are persistent and a Platform reboot is required for thresholds change takes effect.
\end{DoxyWarning}
When the warning or the critical temperature thresholds are reached an event is sent with the {\ttfamily le\+\_\+temp\+\_\+\+Threshold\+Event\+\_\+t} event type .


\begin{DoxyItemize}
\item \hyperlink{le__temp__interface_8h_af02a78a861bb30c2b17049da34b30409}{le\+\_\+temp\+\_\+\+Get\+Radio\+Temperature()} A\+P\+I allows the application to retrieve the Radio temperature.
\item \hyperlink{le__temp__interface_8h_a476e20b815d3df88ff00ebe1fab42792}{le\+\_\+temp\+\_\+\+Set\+Radio\+Thresholds()} A\+P\+I allows the application to set the warning and the critical Radio temperature thresholds.
\item \hyperlink{le__temp__interface_8h_a275ce92a6ed5376a978b5be5687f6cd1}{le\+\_\+temp\+\_\+\+Get\+Radio\+Thresholds()} A\+P\+I allows the application to get the warning and the critical Radio temperature threshold.
\item \hyperlink{le__temp__interface_8h_ad5a5d27181c71928e3b8a5a0476e8b08}{le\+\_\+temp\+\_\+\+Get\+Platform\+Temperature()} A\+P\+I allows the application to retrieve the Platform temperature.
\item \hyperlink{le__temp__interface_8h_aea0cace31c93751db6d48be522e073b8}{le\+\_\+temp\+\_\+\+Set\+Platform\+Thresholds()} A\+P\+I allows the application to set the warning and the critical Platform temperature thresholds.
\item \hyperlink{le__temp__interface_8h_a00a364d667662c110b51fa1475dcc39f}{le\+\_\+temp\+\_\+\+Get\+Platform\+Thresholds()} A\+P\+I allows the application to get the warning and the critical Platform temperature threshold.
\item \hyperlink{le__temp__interface_8h_acb2ef2d56777133835b843a786103268}{le\+\_\+temp\+\_\+\+Add\+Threshold\+Event\+Handler()} A\+P\+I adds a handler to notify when the temperature threshold is reached.
\item \hyperlink{le__temp__interface_8h_a29fa7d59baed8a6ee058e32e2cddbd74}{le\+\_\+temp\+\_\+\+Remove\+Threshold\+Event\+Handler()} A\+P\+I removes the temperature handler.
\end{DoxyItemize}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesPositioning}{}\section{Positioning}\label{legatoServicesPositioning}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{c_gnss}{G\+N\+S\+S} &G\+N\+S\+S device control &\PBS\centering \\\cline{1-3}
\hyperlink{c_pos}{Positioning} &Device physical position/movement &\PBS\centering  \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_gnss}{}\subsection{G\+N\+S\+S}\label{c_gnss}
\hyperlink{le__gnss__interface_8h}{A\+P\+I Reference} ~\newline
 \hyperlink{howToGNSS}{Manage G\+N\+S\+S}





This A\+P\+I provides access to the G\+N\+S\+S device.

G\+N\+S\+S or Global Navigation Satellite System is a satellite navigation system with global coverage.

This A\+P\+I provides function to configure the G\+N\+S\+S device and retrieve position information.\hypertarget{c_gnss_le_gnss_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_gnss_le_gnss_binding}
All the functions of this A\+P\+I are provided by the {\bfseries positioning\+Service} application service.

Here\textquotesingle{}s a code sample binding to Positioning services\+: \begin{DoxyVerb} bindings:
 {
    clientExe.clientComponent.le_gnss -> positioningService.le_gnss
 }\end{DoxyVerb}
\hypertarget{c_gnss_le_gnss_EnableDisable}{}\subsubsection{Enable/\+Disable G\+N\+S\+S device}\label{c_gnss_le_gnss_EnableDisable}
The application can enable/disable the G\+N\+S\+S device with the \hyperlink{le__gnss__interface_8h_a8e1d96b1b64055b298a74cad1acfbbf8}{le\+\_\+gnss\+\_\+\+Enable()} / \hyperlink{le__gnss__interface_8h_aa2cd87c616f968370e9e2113570437ea}{le\+\_\+gnss\+\_\+\+Disable()} functions. By default the G\+N\+S\+S device is enabled for the positioning\+Service application service. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_StartStop}{}\subsubsection{Start/\+Stop G\+N\+S\+S device}\label{c_gnss_le_gnss_StartStop}
The application can start/stop the G\+N\+S\+S device with the \hyperlink{le__gnss__interface_8h_add90639835a531c4b9d15554e4f3ba16}{le\+\_\+gnss\+\_\+\+Start()} / \hyperlink{le__gnss__interface_8h_a93d63fdc76dbced071956b87de2abff7}{le\+\_\+gnss\+\_\+\+Stop()} functions. The default \char`\"{}\+H\+O\+T\char`\"{} start condition is applied and all assistance data are used. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_StartingMode}{}\subsubsection{Starting mode}\label{c_gnss_le_gnss_StartingMode}
Starting modes are used only for test purposes and allow start performance measurement. \begin{DoxyNote}{Note}
For more information about start performances, please refer to your specific platform documentation.
\end{DoxyNote}
\hypertarget{c_gnss_le_gnss_Data}{}\paragraph{G\+N\+S\+S data}\label{c_gnss_le_gnss_Data}
The following table describes the {\bfseries minimum} required data for those starting modes\+:

\begin{TabularC}{5}
\hline
\rowcolor{lightgray}{\bf G\+N\+S\+S Data / Starting mode }&{\bf H\+O\+T }&{\bf W\+A\+R\+M }&{\bf C\+O\+L\+D }&{\bf F\+A\+C\+T\+O\+R\+Y  }\\\cline{1-5}
Broadcasted Ephemeris &Used &&&\\\cline{1-5}
Extended Ephemeris &Used(1) &Used(2) &Used(2) &Removed (3) \\\cline{1-5}
Approximate Time and Position &Used &Used &&\\\cline{1-5}
Almanac &Used &Used &Used &Used (Factory) \\\cline{1-5}
\end{TabularC}
For example, a requested H\+O\+T start without valid broadcasted ephemeris will be treated as a W\+A\+R\+M start.

\begin{DoxyNote}{Note}
(1) Extended Ephemeris can be used if Broadcasted Ephemeris are not valid. The Extended Ephemeris could be loaded using the \hyperlink{le__gnss__interface_8h_aea1811e39dfae1516b08404adfbaec22}{le\+\_\+gnss\+\_\+\+Load\+Extended\+Ephemeris\+File()} function. 

(2) Extended Ephemeris is used if the Extended Ephemeris file is loaded and valid. 

(3) Extended Ephemeris are removed when a F\+A\+C\+T\+O\+R\+Y start is requested. The Extended Ephemeris could be loaded again using the \hyperlink{le__gnss__interface_8h_aea1811e39dfae1516b08404adfbaec22}{le\+\_\+gnss\+\_\+\+Load\+Extended\+Ephemeris\+File()} function.
\end{DoxyNote}
\hypertarget{c_gnss_le_gnss_TTFF}{}\paragraph{Time To First Fix (\+T\+T\+F\+F)}\label{c_gnss_le_gnss_TTFF}
The \hyperlink{le__gnss__interface_8h_a6b2fbb3902c9fd3336b5940b2abacb12}{le\+\_\+gnss\+\_\+\+Get\+Ttff()} function provides the T\+T\+F\+F (first between 2-\/\+Dimensional or 3-\/\+Dimensional Position Fix) of the last position fix. Please refer to \hyperlink{c_gnss_le_gnss_APIcallsRequirements}{A\+P\+I calls Requirements}. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_ForceHotRestart}{}\paragraph{Force H\+O\+T restart}\label{c_gnss_le_gnss_ForceHotRestart}
The \hyperlink{le__gnss__interface_8h_a29ff5b1e5bada1a9d15d19b3a0d2d4d1}{le\+\_\+gnss\+\_\+\+Force\+Hot\+Restart()} function performs a \char`\"{}\+H\+O\+T\char`\"{} restart of the G\+N\+S\+S device. The current G\+N\+S\+S session is stopped, then started using the available \hyperlink{c_gnss_le_gnss_Data}{G\+N\+S\+S data}. Please refer to \hyperlink{c_gnss_le_gnss_APIcallsRequirements}{A\+P\+I calls Requirements}. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_ForceWarmRestart}{}\paragraph{Force W\+A\+R\+M restart}\label{c_gnss_le_gnss_ForceWarmRestart}
The \hyperlink{le__gnss__interface_8h_a1f5b3008db50d34c7962fb73c306f3d1}{le\+\_\+gnss\+\_\+\+Force\+Warm\+Restart()} function performs a \char`\"{}\+W\+A\+R\+M\char`\"{} restart of the G\+N\+S\+S device. The current G\+N\+S\+S session is stopped, then started using the available \hyperlink{c_gnss_le_gnss_Data}{G\+N\+S\+S data}. Please refer to \hyperlink{c_gnss_le_gnss_APIcallsRequirements}{A\+P\+I calls Requirements}. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_ForceColdRestart}{}\paragraph{Force C\+O\+L\+D restart}\label{c_gnss_le_gnss_ForceColdRestart}
The \hyperlink{le__gnss__interface_8h_aa702703bbeebbefd65dd51b1f9fd4ce5}{le\+\_\+gnss\+\_\+\+Force\+Cold\+Restart()} function performs a \char`\"{}\+C\+O\+L\+D\char`\"{} restart of the G\+N\+S\+S device. The current G\+N\+S\+S session is stopped, then started using the available \hyperlink{c_gnss_le_gnss_Data}{G\+N\+S\+S data}. Please refer to \hyperlink{c_gnss_le_gnss_APIcallsRequirements}{A\+P\+I calls Requirements}. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_ForceFactoryRestart}{}\paragraph{Force F\+A\+C\+T\+O\+R\+Y restart}\label{c_gnss_le_gnss_ForceFactoryRestart}
The \hyperlink{le__gnss__interface_8h_a18219097f3e8c8e6e613462a5467f546}{le\+\_\+gnss\+\_\+\+Force\+Factory\+Restart()} function performs a \char`\"{}\+F\+A\+C\+T\+O\+R\+Y\char`\"{} restart of the G\+N\+S\+S device. The current G\+N\+S\+S session is stopped, then started using the available \hyperlink{c_gnss_le_gnss_Data}{G\+N\+S\+S data}. Please refer to \hyperlink{c_gnss_le_gnss_APIcallsRequirements}{A\+P\+I calls Requirements}. Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.\hypertarget{c_gnss_le_gnss_SetGetConstellation}{}\subsubsection{G\+N\+S\+S constellation selection}\label{c_gnss_le_gnss_SetGetConstellation}
The \hyperlink{le__gnss__interface_8h_a6dbdc58f23e480e65ea16c583ef5340f}{le\+\_\+gnss\+\_\+\+Set\+Constellation()} function selects the G\+N\+S\+S constellation(s) used in solution. If all G\+N\+S\+S constellations are disabled, the G\+N\+S\+S engine is disabled.

\begin{DoxyWarning}{Warning}
Your platform may require a reboot to take into account this change. Please refer to your platform documentation for further details.
\end{DoxyWarning}
The following configurations are currently supported\+:
\begin{DoxyItemize}
\item G\+P\+S
\item G\+P\+S + G\+L\+O\+N\+A\+S\+S
\end{DoxyItemize}

All supported G\+N\+S\+S constellations are enabled by default. The \hyperlink{le__gnss__interface_8h_a150835481ab3751e3ab1821362e34e84}{le\+\_\+gnss\+\_\+\+Get\+Constellation()} function gets the G\+N\+S\+S constellation(s) enabled to be used in solution.\hypertarget{c_gnss_le_gnss_Assisted_GNSS}{}\subsubsection{Assisted G\+N\+S\+S}\label{c_gnss_le_gnss_Assisted_GNSS}
\hyperlink{c_gnss_le_gnss_Assisted_GNSS_EE}{Server based Extended Ephemeris} ~\newline
 \hyperlink{c_gnss_le_gnss_Assisted_GNSS_UP}{3\+G\+P\+P User Plane (O\+M\+A S\+U\+P\+L)}\hypertarget{c_gnss_le_gnss_Assisted_GNSS_EE}{}\paragraph{Server based Extended Ephemeris}\label{c_gnss_le_gnss_Assisted_GNSS_EE}
With \hyperlink{le__gnss__interface_8h_aea1811e39dfae1516b08404adfbaec22}{le\+\_\+gnss\+\_\+\+Load\+Extended\+Ephemeris\+File()} , you can load an \textquotesingle{}Extended Ephemeris\textquotesingle{} file into the G\+N\+S\+S device from the filesystem. You have to download the file before loading it. \begin{DoxyWarning}{Warning}
Ensure to check that the downloaded file is supported for your specific platform.
\end{DoxyWarning}
With \hyperlink{le__gnss__interface_8h_a1fbfc55e9e7585646fb312d7017061ff}{le\+\_\+gnss\+\_\+\+Get\+Extended\+Ephemeris\+Validity()}, you will to get the validity of the last injected Extended Ephemeris.

You can enable/disable the use of the \textquotesingle{}Extended Ephemeris\textquotesingle{} file into the G\+N\+S\+S device with \hyperlink{le__gnss__interface_8h_a3474bb912febeca6e258c6039144f39f}{le\+\_\+gnss\+\_\+\+Enable\+Extended\+Ephemeris\+File()}/le\+\_\+gnss\+\_\+\+Disable\+Extended\+Ephemeris\+File() functions.

Example\+:


\begin{DoxyCode}
\textcolor{preprocessor}{#define EXT\_EPH\_PATH     "/tmp/ext\_eph.bin"}

\hyperlink{structle__clk___time__t}{le\_clk\_Time\_t} start,stop;
\textcolor{keywordtype}{char} startTime[100] = \{0\};
\textcolor{keywordtype}{char} StopTime[100] = \{0\};
int32\_t fd;

\textcolor{comment}{// Download file into EXT\_EPH\_PATH using for example the "wget" system command}
DownloadExtendedEphemerisFile(EXT\_EPH\_PATH);

\textcolor{keywordflow}{if} ((fd=open(EXT\_EPH\_PATH, O\_RDONLY)) == -1)
\{
    \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"Open file %s failure: errno.%d (%s)"},  EXT\_EPH\_PATH, errno, strerror(errno));
\}
\textcolor{keywordflow}{else}
\{
    \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Open file %s with fd.%d"},  EXT\_EPH\_PATH, fd);
\}

\textcolor{keywordflow}{if} ( \hyperlink{le__gnss__interface_8h_aea1811e39dfae1516b08404adfbaec22}{le\_gnss\_LoadExtendedEphemerisFile}(EXT\_EPH\_PATH) != 
      \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK} )
\{
   \hyperlink{le__log_8h_a0201b2f60ee0e945479f91e181bf04b6}{LE\_WARN}(\textcolor{stringliteral}{"Could not load '%s'"},EXT\_EPH\_PATH);
\}

\textcolor{keywordflow}{if} ( \hyperlink{le__gnss__interface_8h_a1fbfc55e9e7585646fb312d7017061ff}{le\_gnss\_GetExtendedEphemerisValidity}(&start,&stop) != 
      \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK} )
\{
   \hyperlink{le__log_8h_a0201b2f60ee0e945479f91e181bf04b6}{LE\_WARN}(\textcolor{stringliteral}{"Could get the validity"});
\}

\textcolor{keywordflow}{if} ( \hyperlink{le__clock_8h_ae06285727609683956c22f6af2937f64}{le\_clk\_ConvertToUTCString}(start,
                               \hyperlink{le__clock_8h_af9a6489508554d27a4f927227e2eeb7c}{LE\_CLK\_STRING\_FORMAT\_DATE\_TIME},
                               startTime,
                               \textcolor{keyword}{sizeof}(startTime),
                               NULL) != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK} )
\{
    \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Could not convert start time"});
\}
\textcolor{keywordflow}{if} ( \hyperlink{le__clock_8h_ae06285727609683956c22f6af2937f64}{le\_clk\_ConvertToUTCString}(stop,
                               \hyperlink{le__clock_8h_af9a6489508554d27a4f927227e2eeb7c}{LE\_CLK\_STRING\_FORMAT\_DATE\_TIME},
                               StopTime,
                               \textcolor{keyword}{sizeof}(StopTime),
                               NULL) != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK} )
\{
    \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Could not convert stop time"});
\}

\hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Validity Start time  %s"},startTime);
\hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Validity Stop time %s"},StopTime);

close (fd);
\end{DoxyCode}
\hypertarget{c_gnss_le_gnss_Assisted_GNSS_UP}{}\paragraph{3\+G\+P\+P User Plane (\+O\+M\+A S\+U\+P\+L)}\label{c_gnss_le_gnss_Assisted_GNSS_UP}
That 3\+G\+P\+P User Plane A-\/\+G\+N\+S\+S (Assisted G\+N\+S\+S) protocol is defined by two different standardization bodies, 3\+G\+P\+P and Open Mobile Alliance (O\+M\+A). For more information, please refer to the standard.

Both M\+S-\/\+Assisted and M\+S-\/\+Based position determination methods are supported in the User Plane.

In M\+S-\/\+Assisted mode, the M\+S (Mobile Station) measures the signals from the G\+N\+S\+S satellites , then returns the retrieved G\+N\+S\+S data to the S\+U\+P\+L (Secure User Plan Location) server, where the position calculation is performed.

In M\+S-\/\+Based mode, the M\+S gets the assistance data from the S\+U\+P\+L (Secure User Plan Location) server. The M\+S measures the signals from the G\+N\+S\+S satellites and makes the position calculation.

The data transport over User Plan is done using the T\+C\+P/\+I\+P protocol.

The Assisted-\/\+G\+N\+S\+S mode can be configured thru the \hyperlink{le__gnss__interface_8h_a5d74c2ad91a504a1d0ac35b4f4f2c382}{le\+\_\+gnss\+\_\+\+Set\+Supl\+Assisted\+Mode()} function.

The supported modes are the following\+:
\begin{DoxyItemize}
\item Standalone mode\+: That 3\+G\+P\+P User Plane A-\/\+G\+N\+S\+S feature is deactivated.
\item M\+S-\/\+Based mode
\item M\+S-\/\+Assisted mode
\end{DoxyItemize}

Moreover, the \hyperlink{le__gnss__interface_8h_a2b5eb5e1efbc31683e717dd7181ff1d3}{le\+\_\+gnss\+\_\+\+Get\+Supl\+Assisted\+Mode()} function reads the configured Assisted-\/\+G\+N\+S\+S mode.

The S\+U\+P\+L server is configured using the \hyperlink{le__gnss__interface_8h_abff6d8ae251972df157b5b38829230ed}{le\+\_\+gnss\+\_\+\+Set\+Supl\+Server\+Url()} function. That function sets the S\+U\+P\+L server U\+R\+L and optionally the port number.

The S\+U\+P\+L certificate to be used in A-\/\+G\+N\+S\+S sessions is injected through the \hyperlink{le__gnss__interface_8h_a3bd8f5067d4bba2e7ed5fce95c2c1a74}{le\+\_\+gnss\+\_\+\+Inject\+Supl\+Certificate()} function and deleted through the \hyperlink{le__gnss__interface_8h_aec8d50c209ce21a979b7e9f552353aec}{le\+\_\+gnss\+\_\+\+Delete\+Supl\+Certificate()} function.\hypertarget{c_gnss_le_gnss_APIcallsRequirements}{}\subsubsection{A\+P\+I calls Requirements}\label{c_gnss_le_gnss_APIcallsRequirements}
The following table shows the pre-\/requisites when using the G\+N\+S\+S service A\+P\+I function set. \textquotesingle{}\textquotesingle{}L\+E\+\_\+\+O\+K or error code\textquotesingle{}\textquotesingle{} means the function is authorized in the corresponding state, the request is performed and the result is returned; otherwise the returned error is indicated for each state\begin{TabularC}{5}
\hline
\rowcolor{lightgray}{\bf Function / G\+N\+S\+S state }&{\bf U\+N\+I\+N\+I\+T\+I\+A\+L\+I\+Z\+E\+D }&{\bf R\+E\+A\+D\+Y }&{\bf A\+C\+T\+I\+V\+E }&{\bf D\+I\+S\+A\+B\+L\+E\+D  }\\\cline{1-5}
\hyperlink{le__gnss__interface_8h_add90639835a531c4b9d15554e4f3ba16}{le\+\_\+gnss\+\_\+\+Start()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a93d63fdc76dbced071956b87de2abff7}{le\+\_\+gnss\+\_\+\+Stop()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a29ff5b1e5bada1a9d15d19b3a0d2d4d1}{le\+\_\+gnss\+\_\+\+Force\+Hot\+Restart()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a1f5b3008db50d34c7962fb73c306f3d1}{le\+\_\+gnss\+\_\+\+Force\+Warm\+Restart()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_aa702703bbeebbefd65dd51b1f9fd4ce5}{le\+\_\+gnss\+\_\+\+Force\+Cold\+Restart()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a18219097f3e8c8e6e613462a5467f546}{le\+\_\+gnss\+\_\+\+Force\+Factory\+Restart()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_aa2cd87c616f968370e9e2113570437ea}{le\+\_\+gnss\+\_\+\+Disable()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a8e1d96b1b64055b298a74cad1acfbbf8}{le\+\_\+gnss\+\_\+\+Enable()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E &L\+E\+\_\+\+D\+U\+P\+L\+I\+C\+A\+T\+E &L\+E\+\_\+\+O\+K or error code \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a6dbdc58f23e480e65ea16c583ef5340f}{le\+\_\+gnss\+\_\+\+Set\+Constellation()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\hyperlink{le__gnss__interface_8h_a6b2fbb3902c9fd3336b5940b2abacb12}{le\+\_\+gnss\+\_\+\+Get\+Ttff()} &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+O\+K or error code &L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D \\\cline{1-5}
\end{TabularC}
Also see \hyperlink{howToGNSS}{Manage G\+N\+S\+S}.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_pos}{}\subsection{Positioning}\label{c_pos}
\hyperlink{le__pos__interface_8h}{A\+P\+I Reference} ~\newline
 \hyperlink{c_posCtrl}{Positioning Control Reference}





This A\+P\+I provides access to the device\textquotesingle{}s physical position and movement information.

\begin{DoxyNote}{Note}
Enabling and disabling the positioning system is a privileged operation available only through the \hyperlink{c_posCtrl}{Positioning Control A\+P\+I}.
\end{DoxyNote}
\hypertarget{c_pos_le_pos_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_pos_le_pos_binding}
All the functions of this A\+P\+I are provided by the {\bfseries positioning\+Service} application service.

Here\textquotesingle{}s a code sample binding to Positioning services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_pos -> positioningService.le_pos
}
\end{DoxyVerb}
\hypertarget{c_pos_le_pos_fix}{}\subsubsection{Fix On Demand}\label{c_pos_le_pos_fix}
The {\ttfamily \hyperlink{le__pos__interface_8h_a0aefc90df207f2e20286ea1be88e70d4}{le\+\_\+pos\+\_\+\+Get2\+D\+Location()}} function gets the last updated latitude, longitude and the horizontal accuracy values\+:


\begin{DoxyItemize}
\item latitude is in degrees, positive North.
\item longitude is in degrees, positive East.
\item horizontal accuracy is in metres.
\end{DoxyItemize}

The latitude and longitude are given in degrees with 6 decimal places like\+:
\begin{DoxyItemize}
\item Latitude +48858300 = 48.\+858300 degrees North
\item Longitude +2294400 = 2.\+294400 degrees East
\end{DoxyItemize}

The {\ttfamily \hyperlink{le__pos__interface_8h_ad2e96a853c9e3d4daa351494ff2070ba}{le\+\_\+pos\+\_\+\+Get3\+D\+Location()}} function gets the last updated latitude, longitude, altitude and their associated accuracy values.
\begin{DoxyItemize}
\item altitude is in metres, above Mean Sea Level, with 3 decimal places (3047 = 3.\+047 metres).
\item horizontal and vertical accuracies are in metres.
\end{DoxyItemize}

The {\ttfamily \hyperlink{le__pos__interface_8h_a7f8c37ad14a3375eb9b5d6954916be41}{le\+\_\+pos\+\_\+\+Get\+Time()}} function gets the time of last updated position\+:
\begin{DoxyItemize}
\item Hours into the day \mbox{[}range 0..23\mbox{]}.
\item Minutes into the hour \mbox{[}range 0..59\mbox{]}.
\item Seconds into the minute \mbox{[}range 0..59\mbox{]}.
\item Milliseconds into the second \mbox{[}range 0..999\mbox{]}.
\end{DoxyItemize}

The {\ttfamily \hyperlink{le__pos__interface_8h_a190d242995bb06518b5a064df5578c85}{le\+\_\+pos\+\_\+\+Get\+Date()}} function gets the date of last updated position\+:
\begin{DoxyItemize}
\item Year A.\+D. \mbox{[}e.\+g. 2014\mbox{]}.
\item Month into the year \mbox{[}range 1...12\mbox{]}.
\item Days into the month \mbox{[}range 1...31\mbox{]}.
\end{DoxyItemize}

The {\ttfamily \hyperlink{le__pos__interface_8h_a5b483fdcd812f4da7bdda284e9bb18b6}{le\+\_\+pos\+\_\+\+Get\+Motion()}} function gets the last updated horizontal and vertical speed values and the associated accuracy values\+:
\begin{DoxyItemize}
\item horizontal speed is in m/sec.
\item vertical speed is in m/sec, positive up.
\end{DoxyItemize}

The {\ttfamily \hyperlink{le__pos__interface_8h_ae06eaad71c152ade96d9b3f2e87a2053}{le\+\_\+pos\+\_\+\+Get\+Heading()}} function gets the last updated heading value in degrees (where 0 is True North) and its associated accuracy value. Heading is the direction that the vehicle/person is facing.

The {\ttfamily \hyperlink{le__pos__interface_8h_a2b5b4e4ce66c4f1653d6f0982bbd5feb}{le\+\_\+pos\+\_\+\+Get\+Direction()}} function gets the last updated direction value in degrees (where 0 is True North) and its associated accuracy value. Direction of movement is the direction that the vehicle/person is actually moving.\hypertarget{c_pos_le_pos_navigation}{}\subsubsection{Navigation}\label{c_pos_le_pos_navigation}
To be notified when the device is in motion, you must register an handler function to get the new position\textquotesingle{}s data. The {\ttfamily \hyperlink{le__pos__interface_8h_a17e99072772110c1609c53247d663ed3}{le\+\_\+pos\+\_\+\+Add\+Movement\+Handler()}} A\+P\+I registers that handler. The horizontal and vertical change is measured in metres so only movement over the threshhold will trigger notification (0 means we don\textquotesingle{}t care about changes).

The handler will give a reference to the position sample object that has triggered the notification. You can then access parameters using accessor functions, and release the object when done with it.

The accessor functions are\+:
\begin{DoxyItemize}
\item \hyperlink{le__pos__interface_8h_ae7b3b16601465b663b468f12c63ea485}{le\+\_\+pos\+\_\+sample\+\_\+\+Get2\+D\+Location()}
\item \hyperlink{le__pos__interface_8h_a8249f20e9d5020aaa23e54ccf6bbeb9d}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Date()}
\item \hyperlink{le__pos__interface_8h_a47171bf14bf4f249d3b76a8ed204f13c}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Time()}
\item \hyperlink{le__pos__interface_8h_ac6c6868fdc51ce14492adfcd0d7274c0}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Altitude()}
\item \hyperlink{le__pos__interface_8h_a0bb7a30675f1dd7891b22c7753d7caec}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Horizontal\+Speed()}
\item \hyperlink{le__pos__interface_8h_a18162e15ad9a61696312745ec0bec1fd}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Vertical\+Speed()}
\item \hyperlink{le__pos__interface_8h_a181f453d46f8b5440d91f2af1b4ebbfb}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Heading()}
\item \hyperlink{le__pos__interface_8h_ae42d09bb5146b52dd1f628a93611bc31}{le\+\_\+pos\+\_\+sample\+\_\+\+Get\+Direction()}
\end{DoxyItemize}

{\ttfamily \hyperlink{le__pos__interface_8h_af2999e2e4f7eca899b2af1125547e3ea}{le\+\_\+pos\+\_\+sample\+\_\+\+Release()}} releases the object.

You can uninstall the handler function by calling the \hyperlink{le__pos__interface_8h_a3c1b616489fc29fc578e58c6b570f14b}{le\+\_\+pos\+\_\+\+Remove\+Movement\+Handler()} A\+P\+I. \begin{DoxyNote}{Note}
The \hyperlink{le__pos__interface_8h_a3c1b616489fc29fc578e58c6b570f14b}{le\+\_\+pos\+\_\+\+Remove\+Movement\+Handler()} A\+P\+I does not delete the Position Object. The caller has to delete it by calling the \hyperlink{le__pos__interface_8h_af2999e2e4f7eca899b2af1125547e3ea}{le\+\_\+pos\+\_\+sample\+\_\+\+Release()} function.
\end{DoxyNote}
In the following code sample, the function Install\+Geo\+Fence\+Handler() installs an handler function that triggers an alarm if the device leaves a designated location.


\begin{DoxyCode}
\textcolor{preprocessor}{#define GEOFENCE\_CENTRE\_LATITUDE            +48070380  // Latitude 48.070380 degrees North}
\textcolor{preprocessor}{#define GEOFENCE\_CENTRE\_LONGITUDE           -11310000  // Longitude 11.310000 degrees West}
\textcolor{preprocessor}{#define MAX\_METRES\_FROM\_GEOFENCE\_CENTRE     150}

\textcolor{keyword}{static} \hyperlink{le__event_loop_8h_ae7ab96b8e3441b3d484fcf52aa7a9dad}{le\_event\_HandlerRef\_t} GeoFenceHandlerRef;

\textcolor{keywordtype}{void} InstallGeoFenceHandler()
\{
    \textcolor{comment}{// I set my home latitude and longitude where my device is located}
    SetHomeLocation(HOME\_LATITUDE, HOME\_LONGITUDE);

    MyPositionUpdateHandlerRef = \hyperlink{le__pos__interface_8h_a17e99072772110c1609c53247d663ed3}{le\_pos\_AddMovementHandler}(50, \textcolor{comment}{// 50 metres}
                                                           0,  \textcolor{comment}{// I don't care about changes of altitude.}
                                                           MyPositionUpdateHandler,
                                                           NULL);
\}


\textcolor{keyword}{static} \textcolor{keywordtype}{void} MyPositionUpdateHandler
(
    \hyperlink{le__pos__interface_8h_a69a38f7e650f581bb5e2b5ce7e339202}{le\_pos\_SampleRef\_t}     positionSampleRef,
    \textcolor{keywordtype}{void}*                  contextPtr
)
\{
    int32\_t metresFromCentre;

    int32\_t accuracyMetres;
    int32\_t latitude;
    int32\_t longitude;

    \hyperlink{le__pos__interface_8h_ae7b3b16601465b663b468f12c63ea485}{le\_pos\_sample\_Get2DLocation}(positionSampleRef, &latitude, &longitude, &
      accuracyMetres);

    metresFromCentre = le\_pos\_ComputeDistance(GEOFENCE\_CENTRE\_LATITUDE, GEOFENCE\_CENTRE\_LONGITUDE
                                              latitude, longitude);

    \textcolor{keywordflow}{if} (metresFromCentre > MAX\_METRES\_FROM\_GEOFENCE\_CENTRE)
    \{
        \textcolor{comment}{// Check it doesn't just look like we are outside the fence because of bad accuracy.}
        \textcolor{keywordflow}{if} (  (accuracyMetres > metresFromCentre) ||
              ((metresFromCentre - accuracyMetres) < MAX\_METRES\_FROM\_GEOFENCE\_CENTRE)  )
        \{
            \textcolor{comment}{// Could be outside the fence, but we also could be inside the fence.}
        \}
        \textcolor{keywordflow}{else}
        \{
            \textcolor{comment}{// Definitely outside the fence!}
            RaiseAlarm(positionSampleRef);
        \}
    \}

    \hyperlink{le__pos__interface_8h_af2999e2e4f7eca899b2af1125547e3ea}{le\_pos\_sample\_Release}(positionSampleRef);
\}
\end{DoxyCode}
\hypertarget{c_pos_le_pos_configdb}{}\subsubsection{Positioning configuration tree}\label{c_pos_le_pos_configdb}
The configuration database path for Positioning is\+: \begin{DoxyVerb}/
    positioning/
        acquisitionRate<int> == 5
\end{DoxyVerb}



\begin{DoxyItemize}
\item \textquotesingle{}acquisition\+Rate\textquotesingle{} is the fix acquisition rate in seconds.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
If there is no configuration for \textquotesingle{}acquisition\+Rate\textquotesingle{}, it will be automatically set to 5 seconds.
\end{DoxyNote}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_posCtrl}{}\subsubsection{Positioning Control A\+P\+I}\label{c_posCtrl}
\hyperlink{le__pos_ctrl__interface_8h}{A\+P\+I Reference}





This A\+P\+I is used to enable and disable the positioning service.

All other positioning functionality is provided by the \hyperlink{c_pos}{Positioning}.\hypertarget{c_pos_ctrl_le_posCtrl_binding}{}\paragraph{I\+P\+C interfaces binding}\label{c_pos_ctrl_le_posCtrl_binding}
All the functions of this A\+P\+I are provided by the {\bfseries positioning\+Service} application service.

Here\textquotesingle{}s a code sample binding to Positioning services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_posCtrl -> positioningService.le_posCtrl
}
\end{DoxyVerb}
\hypertarget{c_pos_ctrl_le_posCtrl_ctrl}{}\paragraph{Positioning control}\label{c_pos_ctrl_le_posCtrl_ctrl}
To request that the positioning service be activated, call \hyperlink{le__pos_ctrl__interface_8h_ab0522cfb23a7b34863b7bd9475d38255}{le\+\_\+pos\+Ctrl\+\_\+\+Request()}.

To release the positioning service when finished with it, call \hyperlink{le__pos_ctrl__interface_8h_a5dfa743e5d134b265b883f7106846428}{le\+\_\+pos\+Ctrl\+\_\+\+Release()}.

If the positioning service is already active when \hyperlink{le__pos_ctrl__interface_8h_ab0522cfb23a7b34863b7bd9475d38255}{le\+\_\+pos\+Ctrl\+\_\+\+Request()} is called, it will remain active. This happens if another application has already requested that the positioning service be activated and not yet released the positioning service.

The positioning service (and associated devices) will not necessarily be switched off when an application calls \hyperlink{le__pos_ctrl__interface_8h_a5dfa743e5d134b265b883f7106846428}{le\+\_\+pos\+Ctrl\+\_\+\+Release()}. The positioning service will be switched off only after all applications that have requested that the positioning service be active have also released the positioning service.

\begin{DoxyNote}{Note}
Control of the positioning service is done through a separate A\+P\+I than the retrieval of positioning information to allow access to positioning information by less-\/trusted applications, while only allowing control of the positioning system by more-\/trusted applications.
\end{DoxyNote}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_pm}{}\section{Power Manager}\label{c_pm}
\hyperlink{le__pm__interface_8h}{A\+P\+I Reference}





Components need access to the Power Manager to control the system\textquotesingle{}s wake-\/up state. Operations that need fast response times (e.\+g., maintaining call state or playing/recording a media stream) result in high interrupt rates; keeping the system awake results in better performance and power efficiency.

Power Manager uses kernel wakeup sources to keep the system awake when at least one of the registered components requests a wakeup source to be held. When all wakeup sources are released, the system may enter a suspend state depending on the status of other (unrelated) wakeup sources.\hypertarget{c_pm_le_pm_binding}{}\subsection{I\+P\+C interfaces binding}\label{c_pm_le_pm_binding}
All the functions of this A\+P\+I are provided by the {\bfseries power\+Mgr} service.

Here\textquotesingle{}s a code sample binding to Power Manager services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_pm -> powerMgr.le_pm
}
\end{DoxyVerb}
\hypertarget{c_pm_le_pm_request}{}\subsection{Requesting and releasing a wakeup source}\label{c_pm_le_pm_request}
The Power Manager service provides basic A\+P\+I for requesting and releasing a wakeup source. Power Manager\textquotesingle{}s clients call {\ttfamily \hyperlink{le__pm__interface_8h_a85038248bcddc8963f7280ffa53acf62}{le\+\_\+pm\+\_\+\+New\+Wakeup\+Source()}} to create a wakeup source. This function returns a \hyperlink{le__pm__interface_8h_af959045ad2b6c98fa2bbeb456c7bb9f5}{le\+\_\+pm\+\_\+\+Wakeup\+Source\+Ref\+\_\+t} type that can later be used to acquire and release a wakeup source through {\ttfamily \hyperlink{le__pm__interface_8h_a6be9b6c443c506b0ce29da79e53e2534}{le\+\_\+pm\+\_\+\+Stay\+Awake()}} and \hyperlink{le__pm__interface_8h_a2ffb1fb0d165604226a9df35360080ea}{le\+\_\+pm\+\_\+\+Relax()}, respectively. Wakeup sources are not reference-\/counted, which means multiple calls to \hyperlink{le__pm__interface_8h_a6be9b6c443c506b0ce29da79e53e2534}{le\+\_\+pm\+\_\+\+Stay\+Awake()} can be canceled by a single call to \hyperlink{le__pm__interface_8h_a2ffb1fb0d165604226a9df35360080ea}{le\+\_\+pm\+\_\+\+Relax()}.

Power Manager service will automatically release and delete all wakeup sources held on behalf of an exiting or disconnecting client.

For deterministic behaviour, clients requesting services of Power Manager should have C\+A\+P\+\_\+\+E\+P\+O\+L\+L\+W\+A\+K\+E\+U\+P (or C\+A\+P\+\_\+\+B\+L\+O\+C\+K\+\_\+\+S\+U\+S\+P\+E\+N\+D) capability assigned.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_secStore}{}\section{Secure Storage}\label{c_secStore}
\hyperlink{le__sec_store__interface_8h}{A\+P\+I Reference}





A\+P\+I for accessing secure storage.

Secure storage can be used to store sensitive information like passwords, keys, certificates, etc. All data in the secure storage is in an encrypted format. Each app using this A\+P\+I only has access to its own secure data.

App\textquotesingle{}s items in secure storage have a name and a value. The item name is used to access the item\textquotesingle{}s value and can be maximum 255 characters. The overall maximum storage available is platform dependent (see \hyperlink{platformConstraintsSecStorage}{Secure Storage}).

To create or update an item, use \hyperlink{le__sec_store__interface_8h_acb8b225d19e1bd1ebde45cddcd962edc}{le\+\_\+sec\+Store\+\_\+\+Write()} to specify the item\textquotesingle{}s name and value. If the item doesn\textquotesingle{}t exist, it\textquotesingle{}ll be created. Each item can be maximum 8192 bytes. If it\textquotesingle{}s larger, \hyperlink{le__sec_store__interface_8h_acb8b225d19e1bd1ebde45cddcd962edc}{le\+\_\+sec\+Store\+\_\+\+Write()} will fail.

To read an item, use \hyperlink{le__sec_store__interface_8h_aa09cc29c6c645ae272583c1e23a3c33c}{le\+\_\+sec\+Store\+\_\+\+Read()}, and specify the item\textquotesingle{}s name. To delete and item, use \hyperlink{le__sec_store__interface_8h_a8d6a2676272cca0a26e9e5d634a39cce}{le\+\_\+sec\+Store\+\_\+\+Delete()}.

All the functions in this A\+P\+I are provided by the {\bfseries sec\+Store} service.

Here\textquotesingle{}s a code sample binding to this service\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_secStore -> secStore.le_secStore
}
\end{DoxyVerb}






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesSMS}{}\section{S\+M\+S}\label{legatoServicesSMS}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{c_sms}{S\+M\+S} &S\+M\+S messaging &\PBS\centering \\\cline{1-3}
\hyperlink{c_smsInbox}{S\+M\+S Inbox Service} &S\+M\+S Inbox Service &\PBS\centering  \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_sms}{}\subsection{S\+M\+S}\label{c_sms}
\hyperlink{le__sms__interface_8h}{A\+P\+I Reference}





This file contains data structures and prototypes definitions for high level S\+M\+S A\+P\+Is.

S\+M\+S is a common way to communicate in the M2\+M world.

It\textquotesingle{}s an easy, fast way to send a small amount of data (e.\+g., sensor values for gas telemetry). Usually, the radio module requests small power resources to send or receive a message. It\textquotesingle{}s often a good way to wake-\/up a device that was disconnected from the network or that was operating in low power mode.\hypertarget{c_sms_le_sms_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_sms_le_sms_binding}
All the functions of this A\+P\+I are provided by the {\bfseries modem\+Service}.

Here\textquotesingle{}s a code sample binding to modem services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_sms -> modemService.le_sms
}
\end{DoxyVerb}
\hypertarget{c_sms_le_sms_ops_creating_msg}{}\subsubsection{Creating a Message object}\label{c_sms_le_sms_ops_creating_msg}
There are 3 kinds of supported messages\+: text messages, binary messages, and P\+D\+U messages.

You must create a Message object by calling {\ttfamily \hyperlink{le__sms__interface_8h_a668abcbcff2f1f3c5cdf799315a81058}{le\+\_\+sms\+\_\+\+Create()}} before using the message A\+P\+Is. It automatically allocates needed resources for the Message object, which is referenced by {\ttfamily le\+\_\+sms\+\_\+\+Msg\+Ref\+\_\+t} type.

When the Message object is no longer needed, call {\ttfamily \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\+\_\+sms\+\_\+\+Delete()}} to free all allocated resources associated with the object.\hypertarget{c_sms_le_sms_ops_deleting_msg}{}\subsubsection{Deleting a Message object}\label{c_sms_le_sms_ops_deleting_msg}
To delete a Message object, call \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\+\_\+sms\+\_\+\+Delete()}. This frees all the resources allocated for the Message object. If several users own the Message object (e.\+g., several handler functions registered for S\+M\+S message reception), the Message object will be deleted only after the last user deletes the Message object.\hypertarget{c_sms_le_sms_ops_sending}{}\subsubsection{Sending a message}\label{c_sms_le_sms_ops_sending}
To send a message, create an {\ttfamily le\+\_\+sms\+\_\+\+Msg\+Ref\+\_\+t} object by calling the {\ttfamily \hyperlink{le__sms__interface_8h_a668abcbcff2f1f3c5cdf799315a81058}{le\+\_\+sms\+\_\+\+Create()}} function. Then, set all the needed parameters for the message\+:
\begin{DoxyItemize}
\item Destination telephone number with \hyperlink{le__sms__interface_8h_a145d3215f5601b88ef80b2674a9df226}{le\+\_\+sms\+\_\+\+Set\+Destination()};
\item Text content with \hyperlink{le__sms__interface_8h_a34dc999430c46530d6c9067f800c5d72}{le\+\_\+sms\+\_\+\+Set\+Text()}, the total length are set as well with this A\+P\+I, maximum 160 characters as only the 7-\/bit alphabet is supported.
\item Binary content with \hyperlink{le__sms__interface_8h_a2abf46b6d57c473bb06caf701a04183e}{le\+\_\+sms\+\_\+\+Set\+Binary()}, total length is set with this A\+P\+I, maximum 140 bytes.
\item P\+D\+U content with \hyperlink{le__sms__interface_8h_ab7295e1cdf2adb865135d657ec8bde09}{le\+\_\+sms\+\_\+\+Set\+P\+D\+U()}, total length is set with this A\+P\+I, max 36 (header) + 140 (payload) bytes long.
\item A specific timeout value can be used with \hyperlink{le__sms__interface_8h_a2b14febf0e2285b0b3c2dbcd1c2bb7b0}{le\+\_\+sms\+\_\+\+Set\+Timeout()} A\+P\+I.
\end{DoxyItemize}

After the Msg object is ready, call {\ttfamily \hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\+\_\+sms\+\_\+\+Send()}}.

{\ttfamily \hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\+\_\+sms\+\_\+\+Send()}} is a blocking function, it will return once the Modem has given back a positive or negative answer to the sending operation. The return of {\ttfamily \hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\+\_\+sms\+\_\+\+Send()}} A\+P\+I provides definitive status of the sending operation.

When a message sending has failed and returned L\+E\+\_\+\+F\+A\+U\+L\+T, call \hyperlink{le__sms__interface_8h_a9ee511af99c91383344debf532fae1ae}{le\+\_\+sms\+\_\+\+Get\+Error\+Code()} to retrieve the 3\+G\+P\+P message error code or \hyperlink{le__sms__interface_8h_a46afe91bbded617ad444ea29a9dd910a}{le\+\_\+sms\+\_\+\+Get3\+G\+P\+P2\+Error\+Code()} to retrieve the 3\+G\+P\+P2 message error code. If L\+E\+\_\+\+S\+M\+S\+\_\+\+E\+R\+R\+O\+R\+\_\+3\+G\+P\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+P\+E\+C\+I\+F\+I\+C or L\+E\+\_\+\+S\+M\+S\+\_\+\+E\+R\+R\+O\+R\+\_\+3\+G\+P\+P2\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+P\+E\+C\+I\+F\+I\+C values is returned, call \hyperlink{le__sms__interface_8h_a9cfbc2131df38f99272a71bf05cb1254}{le\+\_\+sms\+\_\+\+Get\+Platform\+Specific\+Error\+Code()} to retrieve the platform specific error code.\hypertarget{c_sms_le_sms_ops_async_sending}{}\subsubsection{Sending asynchronously a message.}\label{c_sms_le_sms_ops_async_sending}
To send an asynchronous message, \hyperlink{le__sms__interface_8h_a0ba61dcf10157e9982702373577c6b45}{le\+\_\+sms\+\_\+\+Send\+Async()} A\+P\+I can be called instead of \hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\+\_\+sms\+\_\+\+Send()} and a specific timeout value can be used with \hyperlink{le__sms__interface_8h_a2b14febf0e2285b0b3c2dbcd1c2bb7b0}{le\+\_\+sms\+\_\+\+Set\+Timeout()} A\+P\+I.

A text message can be sent with one simple function\+: \hyperlink{le__sms__interface_8h_a4bf9a993afcf06f8e9927b534ef9861c}{le\+\_\+sms\+\_\+\+Send\+Text()}. You only have to pass the three following parameters\+:
\begin{DoxyItemize}
\item the destination telephone number.
\item the text message, the total length are set as well with this function, maximum 160 characters as only the 7-\/bit alphabet is supported.
\item the callback function to get a notification indicating the sending result\+: L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+T, L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+F\+A\+I\+L\+E\+D or L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+T\+I\+M\+E\+O\+U\+T.
\end{DoxyItemize}

A P\+D\+U message can be sent using the \hyperlink{le__sms__interface_8h_a8e6e66ff683717a8cd3eb20fc6efe6e0}{le\+\_\+sms\+\_\+\+Send\+Pdu()} functions. The parameters to give are\+:
\begin{DoxyItemize}
\item the P\+D\+U content, total length is set with this A\+P\+I, maximum 176 bytes long = 36 (header) + 140 (payload).
\item the callback function to get a notification indicating the sending result\+: L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+T, L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+F\+A\+I\+L\+E\+D or L\+E\+\_\+\+S\+M\+S\+\_\+\+S\+E\+N\+D\+I\+N\+G\+\_\+\+T\+I\+M\+E\+O\+U\+T.
\end{DoxyItemize}

When a message sending has failed, call \hyperlink{le__sms__interface_8h_a9ee511af99c91383344debf532fae1ae}{le\+\_\+sms\+\_\+\+Get\+Error\+Code()} to retrieve the 3\+G\+P\+P message error code or \hyperlink{le__sms__interface_8h_a46afe91bbded617ad444ea29a9dd910a}{le\+\_\+sms\+\_\+\+Get3\+G\+P\+P2\+Error\+Code()} to retrieve the 3\+G\+P\+P2 message error code. If L\+E\+\_\+\+S\+M\+S\+\_\+\+E\+R\+R\+O\+R\+\_\+3\+G\+P\+P\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+P\+E\+C\+I\+F\+I\+C or L\+E\+\_\+\+S\+M\+S\+\_\+\+E\+R\+R\+O\+R\+\_\+3\+G\+P\+P2\+\_\+\+P\+L\+A\+T\+F\+O\+R\+M\+\_\+\+S\+P\+E\+C\+I\+F\+I\+C values is returned, call \hyperlink{le__sms__interface_8h_a9cfbc2131df38f99272a71bf05cb1254}{le\+\_\+sms\+\_\+\+Get\+Platform\+Specific\+Error\+Code()} to retrieve the platform specific error code.

Message object is never deleted regardless of the sending result. Caller has to delete it.


\begin{DoxyCode}
[...]

\hyperlink{le__sms__interface_8h_a8eb2a15362fe26516fc68fd7a7d5e3e7}{le\_sms\_MsgRef\_t} myTextMsg;

\textcolor{comment}{// Create a Message Object}
myTextMsg = \hyperlink{le__sms__interface_8h_a668abcbcff2f1f3c5cdf799315a81058}{le\_sms\_Create}();

\textcolor{comment}{// Set the telephone number}
\hyperlink{le__sms__interface_8h_a145d3215f5601b88ef80b2674a9df226}{le\_sms\_SetDestination}(myTextMsg, \textcolor{stringliteral}{"+33606060708"});

\textcolor{comment}{// Set the message text}
\hyperlink{le__sms__interface_8h_a34dc999430c46530d6c9067f800c5d72}{le\_sms\_SetText}(myTextMsg, \textcolor{stringliteral}{"Hello, this is a Legato SMS message"});

\textcolor{comment}{// Send the message}
\hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\_sms\_Send}(myTextMsg);

\textcolor{comment}{// Delete the message}
\hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\_sms\_Delete}(myTextMsg);
\end{DoxyCode}
\hypertarget{c_sms_le_sms_ops_receiving}{}\subsubsection{Receiving a message}\label{c_sms_le_sms_ops_receiving}
To receive S\+M\+S messages, register a handler function to obtain incoming messages. Use {\ttfamily \hyperlink{le__sms__interface_8h_a844d595f3ae8d170b2fff80d854abb8d}{le\+\_\+sms\+\_\+\+Add\+Rx\+Message\+Handler()}} to register that handler.

The handler must satisfy the following prototype\+: {\ttfamily typedef} void ($\ast$le\+\_\+sms\+\_\+\+Rx\+Message\+Handler\+Func\+\_\+t)(le\+\_\+sms\+\_\+\+Msg\+Ref\+\_\+t msg).

When a new incoming message is received, a Message object is automatically created and the handler is called. This Message object is Read-\/\+Only, any calls of a le\+\_\+sms\+\_\+\+Set\+X\+X\+X A\+P\+I will return a L\+E\+\_\+\+N\+O\+T\+\_\+\+P\+E\+R\+M\+I\+T\+T\+E\+D error.

Use the following A\+P\+Is to retrieve message information and data from the Message object\+:
\begin{DoxyItemize}
\item \hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\+\_\+sms\+\_\+\+Get\+Format()} -\/ determine if it is a binary or a text message.
\item \hyperlink{le__sms__interface_8h_a68bfd509a8a3fd4ae39bde7ac5c32d8d}{le\+\_\+sms\+\_\+\+Get\+Sender\+Tel()} -\/ get the sender\textquotesingle{}s Telephone number.
\item \hyperlink{le__sms__interface_8h_aca83e53998bd7105e14011af41ba6499}{le\+\_\+sms\+\_\+\+Get\+Time\+Stamp()} -\/ get the timestamp sets by the Service Center.
\item \hyperlink{le__sms__interface_8h_a6165464dd3502b3c76b79b32206ba10f}{le\+\_\+sms\+\_\+\+Get\+Userdata\+Len()} -\/ get the message content (text or binary) length.
\item \hyperlink{le__sms__interface_8h_abb89b302e564f3d55d604bb0c0dda022}{le\+\_\+sms\+\_\+\+Get\+P\+D\+U\+Len()} -\/ get the P\+D\+U message .
\item \hyperlink{le__sms__interface_8h_ac598dec158aed1e9fa134daf22c704db}{le\+\_\+sms\+\_\+\+Get\+Text()} -\/ get the message text.
\item \hyperlink{le__sms__interface_8h_a0de50069a9df99adac983385106d9c09}{le\+\_\+sms\+\_\+\+Get\+Binary()} -\/ get the message binary content.
\item \hyperlink{le__sms__interface_8h_ae4b284d427ab7ec637056a6208fdd89e}{le\+\_\+sms\+\_\+\+Get\+P\+D\+U()} -\/ get the message P\+D\+U data.
\item \hyperlink{le__sms__interface_8h_a2a63c6b5179025a80fb86c7f188e1eb7}{le\+\_\+sms\+\_\+\+Get\+Type()} -\/ get the message type.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
-\/ If two (or more) registered handler functions exist, they are all called and get a different message object reference.

-\/ For incoming S\+M\+S, format returned by le\+\_\+sms\+\_\+\+Get\+Format is never L\+E\+\_\+\+S\+M\+S\+\_\+\+F\+O\+R\+M\+A\+T\+\_\+\+P\+D\+U.

-\/ 16 bit U\+C\+S2 format is not supported.
\end{DoxyNote}
If a succession of messages is received, a new Message object is created for each, and the handler is called for each new message.

Uninstall the handler function by calling {\ttfamily \hyperlink{le__sms__interface_8h_a2f474706ba6d7a40083fe1f50f530101}{le\+\_\+sms\+\_\+\+Remove\+Rx\+Message\+Handler()}}. \begin{DoxyNote}{Note}
{\ttfamily \hyperlink{le__sms__interface_8h_a2f474706ba6d7a40083fe1f50f530101}{le\+\_\+sms\+\_\+\+Remove\+Rx\+Message\+Handler()}} A\+P\+I does not delete the Message Object. The caller has to delete it.
\end{DoxyNote}

\begin{DoxyCode}
[...]

\textcolor{comment}{// Handler function for message reception}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} myMsgHandler
(
     \hyperlink{le__sms__interface_8h_a8eb2a15362fe26516fc68fd7a7d5e3e7}{le\_sms\_MsgRef\_t} msgRef,
     \textcolor{keywordtype}{void}*           contextPtr*
)
\{
    \textcolor{keywordtype}{char}   tel[LE\_SMS\_TEL\_NMBR\_MAX\_BYTES];
    \textcolor{keywordtype}{char}   text[\hyperlink{le__sms__interface_8h_a0dc5c2cec7c1fb166c47393fbb07e43f}{LE\_SMS\_TEXT\_MAX\_BYTES}];

    \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a2a63c6b5179025a80fb86c7f188e1eb7}{le\_sms\_GetType}(msgRef) == \hyperlink{le__sms__interface_8h_a9001c5bc939bda5d5865e363bdf7662ca29050c2aa56f58a199d292d51be4fa01}{LE\_SMS\_TYPE\_RX})
    \{
        \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\_sms\_GetFormat}(msgRef) == \hyperlink{le__sms__interface_8h_a337778c44e63660c44fa2116699296c0a1bb6a0d76a622b1185ee879e1595dff8}{LE\_SMS\_FORMAT\_TEXT})
        \{
            \hyperlink{le__sms__interface_8h_a68bfd509a8a3fd4ae39bde7ac5c32d8d}{le\_sms\_GetSenderTel}(msgRef, tel, \textcolor{keyword}{sizeof}(tel));
            \hyperlink{le__sms__interface_8h_ac598dec158aed1e9fa134daf22c704db}{le\_sms\_GetText}(msgRef, text, \textcolor{keyword}{sizeof}(text));

            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{" A new text message has been received !"});
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{" From tel.%s, text: \(\backslash\)"%s\(\backslash\)""}, tel, text);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{" I support only text messages !"});
        \}
    \}
\}


[...]
\textcolor{comment}{// In the main function:}

\hyperlink{le__sms__interface_8h_a77d2607cc541bf0369e69bb2d105d4bf}{le\_sms\_RxMessageHandlerRef\_t} HdlrRef;

\textcolor{comment}{// Add an handler function to handle message reception}
HdlrRef=\hyperlink{le__sms__interface_8h_a844d595f3ae8d170b2fff80d854abb8d}{le\_sms\_AddRxMessageHandler}(myMsgHandler);

[...]

\textcolor{comment}{// Remove Handler entry}
\hyperlink{le__sms__interface_8h_a2f474706ba6d7a40083fe1f50f530101}{le\_sms\_RemoveRxMessageHandler}(HdlrRef);

[...]
\end{DoxyCode}
\hypertarget{c_sms_le_sms_ops_listing}{}\subsubsection{Listing  messages recorded in storage area}\label{c_sms_le_sms_ops_listing}
Call {\ttfamily \hyperlink{le__sms__interface_8h_aee4328f9e417108fa16794cc135073d0}{le\+\_\+sms\+\_\+\+Create\+Rx\+Msg\+List()}} to create a List object that lists the received messages present in the storage area, which is referenced by {\ttfamily le\+\_\+sms\+\_\+\+Msg\+List\+Ref\+\_\+t} type.

If messages are not present, the \hyperlink{le__sms__interface_8h_aee4328f9e417108fa16794cc135073d0}{le\+\_\+sms\+\_\+\+Create\+Rx\+Msg\+List()} returns N\+U\+L\+L.

Once the list is available, call {\ttfamily \hyperlink{le__sms__interface_8h_a934253dee33a6090656876cff853b2c6}{le\+\_\+sms\+\_\+\+Get\+First()}} to get the first message from the list, and then call {\ttfamily \hyperlink{le__sms__interface_8h_ac3b6a30a6d4e4f21749b536184b836ec}{le\+\_\+sms\+\_\+\+Get\+Next()}} A\+P\+I to get the next message.

Call {\ttfamily \hyperlink{le__sms__interface_8h_a4027c05c4ee7552ab0e081caa315c8a2}{le\+\_\+sms\+\_\+\+Delete\+List()}} to free all allocated resources associated with the List object.

Call {\ttfamily \hyperlink{le__sms__interface_8h_ae1843c72eca77cd6da94cb686e5c2ae8}{le\+\_\+sms\+\_\+\+Get\+Status()}} to read the status of a message (Received Read, Received Unread).

To finish, you can also modify the received status of a message with {\ttfamily \hyperlink{le__sms__interface_8h_a3dbd11952804520512fed270d183461d}{le\+\_\+sms\+\_\+\+Mark\+Read()}} and {\ttfamily \hyperlink{le__sms__interface_8h_a6ef04e331af6563b79e77bb51b28bc55}{le\+\_\+sms\+\_\+\+Mark\+Unread()}}.\hypertarget{c_sms_le_sms_ops_deleting}{}\subsubsection{Deleting a message from the storage area}\label{c_sms_le_sms_ops_deleting}
{\ttfamily \hyperlink{le__sms__interface_8h_aff755186b683b94ba2788b48e28284a3}{le\+\_\+sms\+\_\+\+Delete\+From\+Storage()}} deletes the message from the storage area. Message is identified with {\ttfamily le\+\_\+sms\+\_\+\+Msg\+Ref\+\_\+t} object. The A\+P\+I returns an error if the message is not found in the storage area.

\begin{DoxyNote}{Note}
If several users own the Message object on new reception (e.\+g., several handler functions registered for S\+M\+S message reception), the Message will be deleted from the storage area only after the last user deletes the Message object reference (not necessary from storage). A\+P\+I returns always L\+E\+\_\+\+O\+K in this case.

If one client creates a list and deletes all sms from storage, other clients won’t see sms stored If they have not created a sms list too. Sms List creation locks and delays sms deletion from storage until all references have been deleted.
\end{DoxyNote}
\hypertarget{c_sms_le_sms_ops_broadcast}{}\subsubsection{S\+M\+S Cell Broadcast}\label{c_sms_le_sms_ops_broadcast}
The Cell Broadcast service permits a number of unacknowledged general messages to be broadcast to all receivers within a particular region. Cell Broadcast messages are broadcast to defined geographical areas known as cell broadcast areas. These areas may comprise of one or more cells, or may comprise the entire P\+L\+M\+N.

G\+S\+M or U\+M\+T\+S S\+M\+S cell broadcast service can be activated or deactivated with \hyperlink{le__sms__interface_8h_a4607c63f325465d078514b5682347c7f}{le\+\_\+sms\+\_\+\+Activate\+Cell\+Broadcast()} and \hyperlink{le__sms__interface_8h_aa57c2f717c71b33e93f278673a7806e9}{le\+\_\+sms\+\_\+\+Deactivate\+Cell\+Broadcast()} A\+P\+Is.

C\+D\+M\+A cell broadcast service can be activated or deactivated with \hyperlink{le__sms__interface_8h_a45a160fea5a8f6cd195e3aff33830602}{le\+\_\+sms\+\_\+\+Activate\+Cdma\+Cell\+Broadcast()} and \hyperlink{le__sms__interface_8h_a26d43a50652431063e0a8e4d88fdba86}{le\+\_\+sms\+\_\+\+Deactivate\+Cdma\+Cell\+Broadcast()} A\+P\+Is.

Cell broadcast message receptions are notify by the S\+M\+S handler like a S\+M\+S message reception, but there are neither stored in S\+I\+M nor in the modem. So \hyperlink{le__sms__interface_8h_aff755186b683b94ba2788b48e28284a3}{le\+\_\+sms\+\_\+\+Delete\+From\+Storage()} can\textquotesingle{}t be used but the message reference shall be delete with \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\+\_\+sms\+\_\+\+Delete()}.


\begin{DoxyItemize}
\item \hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\+\_\+sms\+\_\+\+Get\+Format()} -\/ determine if it is a binary or a text message.
\item \hyperlink{le__sms__interface_8h_a6165464dd3502b3c76b79b32206ba10f}{le\+\_\+sms\+\_\+\+Get\+Userdata\+Len()} -\/ get the message content (text or binary) length.
\item \hyperlink{le__sms__interface_8h_abb89b302e564f3d55d604bb0c0dda022}{le\+\_\+sms\+\_\+\+Get\+P\+D\+U\+Len()} -\/ get the P\+D\+U message received.
\item \hyperlink{le__sms__interface_8h_ac598dec158aed1e9fa134daf22c704db}{le\+\_\+sms\+\_\+\+Get\+Text()} -\/ get the message text.
\item \hyperlink{le__sms__interface_8h_a0de50069a9df99adac983385106d9c09}{le\+\_\+sms\+\_\+\+Get\+Binary()} -\/ get the message binary content.
\item \hyperlink{le__sms__interface_8h_ae4b284d427ab7ec637056a6208fdd89e}{le\+\_\+sms\+\_\+\+Get\+P\+D\+U()} -\/ get the message P\+D\+U data received length.
\item \hyperlink{le__sms__interface_8h_aa28c1d04ff19b88100b766737610b128}{le\+\_\+sms\+\_\+\+Get\+Cell\+Broadcast\+Id()} -\/ get the message identifier received (3\+G\+P\+P 23.\+41).
\item \hyperlink{le__sms__interface_8h_aa3e075b4a9396b2e4af233e4543f40bd}{le\+\_\+sms\+\_\+\+Get\+Cell\+Broadcast\+Serial\+Number()} get the message Serial Number received (3\+G\+P\+P 23.\+41).
\end{DoxyItemize}

\begin{DoxyNote}{Note}
-\/ Format returned by le\+\_\+sms\+\_\+\+Get\+Format is never L\+E\+\_\+\+S\+M\+S\+\_\+\+F\+O\+R\+M\+A\+T\+\_\+\+P\+D\+U. 

-\/ 16 bit U\+C\+S2 format is not supported
\end{DoxyNote}
{\bfseries Serial} {\bfseries Number} 

Cell Broadcast Serial Number parameter is a 16-\/bit integer which identifies a particular C\+B\+S message from the source and type indicated by the Message Identifier and is altered every time the C\+B\+S message with a given Message Identifier is changed.

The two bytes of the Serial Number field are divided into a 2-\/bit Geographical Scope (G\+S) indicator, a 10-\/bit Message Code and a 4-\/bit Update Number as shown below\+:


\begin{DoxyItemize}
\item G\+S code (bit 14 and 15)\+: The Geographical Scope (G\+S) indicates the geographical area over which the Message Code is unique, and the display mode.
\item Message Code (bit 4 to 13) \+: The Message Code differentiates between C\+B\+S messages from the same source and type (i.\+e. with the same Message Identifier). Message Codes are for allocation by P\+L\+M\+N operators. The Message Code identifies different message themes. For example, let the value for the Message Identifier be \char`\"{}\+Automotive Association\char`\"{} (= source), \char`\"{}\+Traffic Reports\char`\"{} (= type). Then \char`\"{}\+Crash on A1 J5\char`\"{} could be one value for the message code, \char`\"{}\+Cow on A32 J4\char`\"{} could be another, and \char`\"{}\+Slow vehicle on M3 J3\char`\"{} yet another.
\item Update Number (bit 0 to 3) \+: The Update Number indicates a change of the message content of the same C\+B\+S message, i.\+e. the C\+B\+S message with the same Message Identifier, Geographical Scope, and Message Code.
\end{DoxyItemize}

Serial Number fields meaning are defined in the 3\+G\+P\+P 23.\+041 (9.\+4.\+1.\+2.\+1 Serial Number).

{\bfseries Message} {\bfseries Identifier} 

Message Identifier parameter identifies the source and type of the C\+B\+S message. For example, \char`\"{}\+Automotive Association\char`\"{} (= source), \char`\"{}\+Traffic Reports\char`\"{} (= type) could correspond to one value. A number of C\+B\+S messages may originate from the same source and/or be of the same type. These will be distinguished by the Serial Number.

Message identifier meaning ranges are defined in the 3\+G\+P\+P 23.\+041 (9.\+4.\+1.\+2.\+2 Message Identifier).


\begin{DoxyCode}
[...]

\textcolor{keyword}{static} \textcolor{keywordtype}{void} myMsgHandler
(
    \hyperlink{le__sms__interface_8h_a8eb2a15362fe26516fc68fd7a7d5e3e7}{le\_sms\_MsgRef\_t} msgRef,
    \textcolor{keywordtype}{void}* contextPtr
)
\{
    \textcolor{keywordtype}{char} text[\hyperlink{le__sms__interface_8h_a0dc5c2cec7c1fb166c47393fbb07e43f}{LE\_SMS\_TEXT\_MAX\_BYTES}];
    uin8\_t binary[\hyperlink{le__sms__interface_8h_a5bf62f998e950de37b56813d8c5d9b95}{LE\_SMS\_BINARY\_MAX\_BYTES}];
    uint16\_t messageId;

    \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a2a63c6b5179025a80fb86c7f188e1eb7}{le\_sms\_GetType}(msgRef) == \hyperlink{le__sms__interface_8h_a9001c5bc939bda5d5865e363bdf7662ca3dff7628faf85524d772f34f52699a47}{LE\_SMS\_TYPE\_BROADCAST\_RX})
    \{
        \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\_sms\_GetFormat}(msgRef) == \hyperlink{le__sms__interface_8h_a337778c44e63660c44fa2116699296c0a1bb6a0d76a622b1185ee879e1595dff8}{LE\_SMS\_FORMAT\_TEXT})
        \{
            \textcolor{comment}{// Get the message text}
            \hyperlink{le__sms__interface_8h_ac598dec158aed1e9fa134daf22c704db}{le\_sms\_GetText}(msgRef, text, \hyperlink{le__sms__interface_8h_a0dc5c2cec7c1fb166c47393fbb07e43f}{LE\_SMS\_TEXT\_MAX\_BYTES});
        \}
        \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\_sms\_GetFormat}(msgRef) == 
      \hyperlink{le__sms__interface_8h_a337778c44e63660c44fa2116699296c0ac70333fc9281ed10aa405d585689c000}{LE\_SMS\_FORMAT\_BINARY})
        \{
            \textcolor{comment}{// Get the message binary}
            \hyperlink{le__sms__interface_8h_a0de50069a9df99adac983385106d9c09}{le\_sms\_GetBinary}(msgRef, binary, 
      \hyperlink{le__sms__interface_8h_a5bf62f998e950de37b56813d8c5d9b95}{LE\_SMS\_BINARY\_MAX\_BYTES});
        \}

        \textcolor{comment}{// Get the message identifier to identify the message origin}
        \hyperlink{le__sms__interface_8h_aa28c1d04ff19b88100b766737610b128}{le\_sms\_GetCellBroadcastId}(msgRef,&messageId);

        \textcolor{comment}{// Delete the message}
        \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\_sms\_Delete}(msgRef);
    \}
    [...]
\}


[...]
\textcolor{comment}{// In the main function:}

\hyperlink{le__sms__interface_8h_a77d2607cc541bf0369e69bb2d105d4bf}{le\_sms\_RxMessageHandlerRef\_t} HdlrRef;

\textcolor{comment}{// Add an handler function to handle message reception}
HdlrRef=\hyperlink{le__sms__interface_8h_a844d595f3ae8d170b2fff80d854abb8d}{le\_sms\_AddRxMessageHandler}(myMsgHandler);

[...]

\textcolor{comment}{// Remove Handler entry}
\hyperlink{le__sms__interface_8h_a2f474706ba6d7a40083fe1f50f530101}{le\_sms\_RemoveRxMessageHandler}(HdlrRef);

[...]
\end{DoxyCode}
\hypertarget{c_sms_le_sms_ops_broadcast_configuration}{}\subsubsection{S\+M\+S Cell Broadcast configuration}\label{c_sms_le_sms_ops_broadcast_configuration}
G\+S\+M or U\+M\+T\+S Cell broadcast Message identifiers range can be added or removed with \hyperlink{le__sms__interface_8h_aae87dacecc438ea9182d370895e5cb3f}{le\+\_\+sms\+\_\+\+Add\+Cell\+Broadcast\+Ids()} and \hyperlink{le__sms__interface_8h_a656fefe815bb965e10087ee65b59faa0}{le\+\_\+sms\+\_\+\+Remove\+Cell\+Broadcast\+Ids()} A\+P\+Is. All Message identifiers can be removed with \hyperlink{le__sms__interface_8h_ae3333cbf700035067f2dae8ea0e564d0}{le\+\_\+sms\+\_\+\+Clear\+Cell\+Broadcast\+Ids()} A\+P\+I.

C\+D\+M\+A Cell broadcast Service categories can be added or removed with \hyperlink{le__sms__interface_8h_ad57196114a634f36b057a9cfbcb7d58a}{le\+\_\+sms\+\_\+\+Add\+Cdma\+Cell\+Broadcast\+Services()} and \hyperlink{le__sms__interface_8h_ae7c58d4ed9ff586d2403232b0cda99e7}{le\+\_\+sms\+\_\+\+Remove\+Cdma\+Cell\+Broadcast\+Services()} A\+P\+Is. All Service categories can be removed with \hyperlink{le__sms__interface_8h_ac737aaab68b6fa1d51a21b518ad112a9}{le\+\_\+sms\+\_\+\+Clear\+Cdma\+Cell\+Broadcast\+Services()} A\+P\+I.\hypertarget{c_sms_le_sms_ops_configuration}{}\subsubsection{S\+M\+S configuration}\label{c_sms_le_sms_ops_configuration}
Modem S\+M\+S Center Address can be set or get with \hyperlink{le__sms__interface_8h_a5df138c515944ce955dd54689593b5df}{le\+\_\+sms\+\_\+\+Set\+Sms\+Center\+Address()} and \hyperlink{le__sms__interface_8h_aeef8f1ac8d2aa3f512e15c054e024bea}{le\+\_\+sms\+\_\+\+Get\+Sms\+Center\+Address()} functions\hypertarget{c_sms_le_sms_ops_samples}{}\subsubsection{Sample codes}\label{c_sms_le_sms_ops_samples}
A sample code that implements a function for Mobile Originated S\+M\+S message can be found in {\bfseries sms\+M\+O.\+c} file (please refer to \hyperlink{c_smsSampleMO}{Sample code for Mobile Originated S\+M\+S message} page).

A sample code that implements a function for Mobile Terminated S\+M\+S message can be found in {\bfseries sms\+M\+T.\+c} file (please refer to \hyperlink{c_smsSampleMT}{Sample code for Mobile Terminated S\+M\+S message} page).

These two samples can be easily compiled and run into the {\bfseries sms} app, to install and use this app\+:

\begin{DoxyVerb}$ make ar7
$ bin/instapp  build/ar7/bin/samples/sms.ar7 <ipaddress>
\end{DoxyVerb}
 where ipaddress is the address of your target device.

Then on your target, just run\+: \begin{DoxyVerb}$ app start sms
\end{DoxyVerb}


The sample replies to the sender by the message \char`\"{}\+Message from $<$phone number$>$ received\char`\"{}. Where \char`\"{}phone number\char`\"{} is the sender\textquotesingle{}s phone number.

Sample code for that application can be seen in the following pages\+:
\begin{DoxyItemize}
\item \hyperlink{c_smsSampleMO}{Sample code for Mobile Originated S\+M\+S message} ~\newline

\item \hyperlink{c_smsSampleMT}{Sample code for Mobile Terminated S\+M\+S message}
\end{DoxyItemize}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_smsSampleMO}{}\subsubsection{Sample code for Mobile Originated S\+M\+S message}\label{c_smsSampleMO}

\begin{DoxyCodeInclude}

\textcolor{preprocessor}{#include "\hyperlink{legato_8h}{legato.h}"}
\textcolor{preprocessor}{#include "interfaces.h"}


\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\textcolor{comment}{}\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} smsmo\_SendMessage
(
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}*   destinationPtr, 
    \textcolor{keyword}{const} \textcolor{keywordtype}{char}*   textPtr         
)
\{
    \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t}           res;
    \hyperlink{le__sms__interface_8h_a8eb2a15362fe26516fc68fd7a7d5e3e7}{le\_sms\_MsgRef\_t}      myMsg;

    myMsg = \hyperlink{le__sms__interface_8h_a668abcbcff2f1f3c5cdf799315a81058}{le\_sms\_Create}();
    \textcolor{keywordflow}{if} (!myMsg)
    \{
        \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"SMS message creation has failed!"});
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    res = \hyperlink{le__sms__interface_8h_a145d3215f5601b88ef80b2674a9df226}{le\_sms\_SetDestination}(myMsg, destinationPtr);
    \textcolor{keywordflow}{if} (res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_SetDestination has failed (res.%d)!"}, res);
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    res = \hyperlink{le__sms__interface_8h_a34dc999430c46530d6c9067f800c5d72}{le\_sms\_SetText}(myMsg, textPtr);
    \textcolor{keywordflow}{if} (res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_SetText has failed (res.%d)!"}, res);
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}

    res = \hyperlink{le__sms__interface_8h_ab7dee7d2c74cfcadd9ea0d5fe1786dfc}{le\_sms\_Send}(myMsg);
    \textcolor{keywordflow}{if} (res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
        \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_Send has failed (res.%d)!"}, res);
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}
    \textcolor{keywordflow}{else}
    \{
        \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"\(\backslash\)"%s\(\backslash\)" has been successfully sent to %s."}, textPtr, destinationPtr);
    \}

    \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\_sms\_Delete}(myMsg);

    \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
\}

\end{DoxyCodeInclude}
 \hypertarget{c_smsSampleMT}{}\subsubsection{Sample code for Mobile Terminated S\+M\+S message}\label{c_smsSampleMT}

\begin{DoxyCodeInclude}

\textcolor{preprocessor}{#include "\hyperlink{legato_8h}{legato.h}"}
\textcolor{preprocessor}{#include "interfaces.h"}
\textcolor{preprocessor}{#include "smsSample.h"}

\textcolor{preprocessor}{#define  MESSAGE\_FEEDBACK "Message from %s received"}

\textcolor{keyword}{static} \hyperlink{le__sms__interface_8h_a77d2607cc541bf0369e69bb2d105d4bf}{le\_sms\_RxMessageHandlerRef\_t} HdlrRef;


\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\textcolor{comment}{}\textcolor{comment}{//--------------------- -----------------------------------------------------------------------------}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} RxMessageHandler
(
    \hyperlink{le__sms__interface_8h_a8eb2a15362fe26516fc68fd7a7d5e3e7}{le\_sms\_MsgRef\_t} msgRef,
    \textcolor{keywordtype}{void}*            contextPtr
)
\{
    \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t}  res;
    \textcolor{keywordtype}{char}         tel[\hyperlink{le__mdm_defs__interface_8h_ae6d4a4c7892f14d1e340f8df083d479f}{LE\_MDMDEFS\_PHONE\_NUM\_MAX\_BYTES}];
    \textcolor{keywordtype}{char}         timestamp[\hyperlink{le__sms__interface_8h_a9844280f515fbc2b393844e63aa83075}{LE\_SMS\_TIMESTAMP\_MAX\_BYTES}] = \{0\};
    \textcolor{keywordtype}{char}         text[\hyperlink{le__sms__interface_8h_a0dc5c2cec7c1fb166c47393fbb07e43f}{LE\_SMS\_TEXT\_MAX\_BYTES}] = \{0\};
    \textcolor{keywordtype}{char}         textReturn[\hyperlink{le__sms__interface_8h_a0dc5c2cec7c1fb166c47393fbb07e43f}{LE\_SMS\_TEXT\_MAX\_BYTES}] = \{0\};

    \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"A New SMS message is received with ref.%p"}, msgRef);

    \textcolor{keywordflow}{if} (\hyperlink{le__sms__interface_8h_a5c2b8ce7043b4732c7b0ede7c5d7118c}{le\_sms\_GetFormat}(msgRef) == \hyperlink{le__sms__interface_8h_a337778c44e63660c44fa2116699296c0a1bb6a0d76a622b1185ee879e1595dff8}{LE\_SMS\_FORMAT\_TEXT})
    \{
        res = \hyperlink{le__sms__interface_8h_a68bfd509a8a3fd4ae39bde7ac5c32d8d}{le\_sms\_GetSenderTel}(msgRef, tel, \textcolor{keyword}{sizeof}(tel));
        \textcolor{keywordflow}{if}(res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
        \{
            \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_GetSenderTel has failed (res.%d)!"}, res);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Message is received from %s."}, tel);
        \}

        res = \hyperlink{le__sms__interface_8h_aca83e53998bd7105e14011af41ba6499}{le\_sms\_GetTimeStamp}(msgRef, timestamp, \textcolor{keyword}{sizeof}(timestamp));
        \textcolor{keywordflow}{if}(res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
        \{
            \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_GetTimeStamp has failed (res.%d)!"}, res);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Message timestamp is %s."}, timestamp);
        \}

        res = \hyperlink{le__sms__interface_8h_ac598dec158aed1e9fa134daf22c704db}{le\_sms\_GetText}(msgRef, text, \textcolor{keyword}{sizeof}(text));
        \textcolor{keywordflow}{if}(res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
        \{
            \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_GetText has failed (res.%d)!"}, res);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"Message content: \(\backslash\)"%s\(\backslash\)""}, text);
        \}

        snprintf(textReturn, \textcolor{keyword}{sizeof}(textReturn), MESSAGE\_FEEDBACK, tel);

        \textcolor{comment}{// Return a message to sender with phone number include (see smsMO.c file)}
        res = smsmo\_SendMessage(tel, textReturn);
        \textcolor{keywordflow}{if} (res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
        \{
            \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"SmsMoMessage has failed (res.%d)!"}, res);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"the message has been successfully sent."});
        \}

        res = \hyperlink{le__sms__interface_8h_aff755186b683b94ba2788b48e28284a3}{le\_sms\_DeleteFromStorage}(msgRef);
        \textcolor{keywordflow}{if}(res != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
        \{
            \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_DeleteFromStorage has failed (res.%d)!"}, res);
        \}
        \textcolor{keywordflow}{else}
        \{
            \hyperlink{le__log_8h_a23e6d206faa64f612045d688cdde5808}{LE\_INFO}(\textcolor{stringliteral}{"the message has been successfully deleted from storage."});
        \}
    \}
    \textcolor{keywordflow}{else}
    \{
        \hyperlink{le__log_8h_a0201b2f60ee0e945479f91e181bf04b6}{LE\_WARN}(\textcolor{stringliteral}{"Warning! I read only Text messages!"});
    \}

    \hyperlink{le__sms__interface_8h_aca1691010c88995cb47225f2889910fa}{le\_sms\_Delete}(msgRef);
\}


\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\textcolor{comment}{}\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} smsmt\_Receiver
(
    \textcolor{keywordtype}{void}
)
\{
    HdlrRef = \hyperlink{le__sms__interface_8h_a844d595f3ae8d170b2fff80d854abb8d}{le\_sms\_AddRxMessageHandler}(RxMessageHandler, NULL);
    \textcolor{keywordflow}{if} (!HdlrRef)
    \{
        \hyperlink{le__log_8h_a353590f91b3143a7ba3a416ae5a50c3d}{LE\_ERROR}(\textcolor{stringliteral}{"le\_sms\_AddRxMessageHandler has failed!"});
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86cac409634423b6b1ef09643529f6224798}{LE\_FAULT};
    \}
    \textcolor{keywordflow}{else}
    \{
        \textcolor{keywordflow}{return} \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK};
    \}
\}


\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\textcolor{comment}{}\textcolor{comment}{//--------------------------------------------------------------------------------------------------}
\textcolor{keywordtype}{void} smsmt\_HandlerRemover
(
    \textcolor{keywordtype}{void}
)
\{
    \hyperlink{le__sms__interface_8h_a2f474706ba6d7a40083fe1f50f530101}{le\_sms\_RemoveRxMessageHandler}(HdlrRef);
\}
\end{DoxyCodeInclude}
 \hypertarget{c_smsInbox}{}\subsection{S\+M\+S Inbox Service}\label{c_smsInbox}
\hyperlink{le__sms_inbox1__interface_8h}{A\+P\+I Reference}





3rd-\/party customer applications need to access to S\+M\+S messages at anytime without worrying how the resources are managed.

Legato provides an S\+M\+S Inbox service to allow apps to receive S\+M\+S messages through their own, private message box, without\+:
\begin{DoxyItemize}
\item having to manage S\+I\+M or modem memory;
\item conflicting with other applications that also receive S\+M\+S messages;
\item missing messages while being updated or restarted.
\end{DoxyItemize}

The S\+M\+S Inbox Service handles the resource arbitration for the user app\+: the message reception is always guaranteed, for example the user app doesn\textquotesingle{}t have to worried about freeing space in the S\+I\+M (or device\textquotesingle{}s storage area) when it is full.

In fact, at device\textquotesingle{}s startup or when a S\+I\+M is inserted, the S\+I\+M content is copied into the \char`\"{}\+Inbox
\+Message Storage\char`\"{} folder allocated in the root file system of the device. Then, the process frees automatically the S\+I\+M content. Moreover, every new received S\+M\+S message is automatically copied into the \char`\"{}\+Inbox
\+Message Storage\char`\"{} folder and deleted from the S\+I\+M. This mechanism keeps the S\+I\+M always empty in order to guarantee the reception of S\+M\+S messages.

This process is the same when the S\+M\+S message storage is the device\textquotesingle{}s storage area (M\+E -\/ Mobile Equipment).

The message box is a persistent storage area. All files are saved into the file system in the directory /mnt/flash/sms\+Inbox.

The creation of S\+M\+S inboxes is done based on the message box configuration settings (cf. \hyperlink{c_sms_inbox_le_smsInbox_configdb}{Configuration tree} section). This way, the message box contents will be kept up to date automatically by the S\+M\+S Inbox Service, even when the user app is slow to start, is stopped while it is being updated, or is being restarted to recover from a fault.

A message box works as a circular buffer, when the message box is filled, the older messages are deleted to free space for new messages. But, the application can also explicitly delete messages if it doesn\textquotesingle{}t need them anymore.\hypertarget{c_sms_inbox_le_smsInbox_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_sms_inbox_le_smsInbox_binding}
All the functions of this A\+P\+I are provided by the {\bfseries sms\+Inbox\+Service} application service.

Here\textquotesingle{}s a code sample binding to S\+M\+S Inbox services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_smsInbox1 -> smsInboxService.le_smsInbox1
}
\end{DoxyVerb}


\begin{DoxyNote}{Note}
By default, sms\+Inbox\+Service starts manually. To start it automatically, the user can remove the option from the sms\+Inbox\+Service.\+adef file.
\end{DoxyNote}
A second message box (named le\+\_\+sms\+Inbox2) can be used by another application. These 2 message boxes are used independently. All functions of this second message box are prefixed by le\+\_\+sms\+Inbox2 (instead of le\+\_\+msm\+Inbox1). The user can implement other message boxes based on le\+\_\+sms\+Inbox1 and le\+\_\+sms\+Inbox2 model.\hypertarget{c_sms_inbox_le_smsInbox_init}{}\subsubsection{Initialise a message box}\label{c_sms_inbox_le_smsInbox_init}
Use the A\+P\+I \hyperlink{le__sms_inbox1__interface_8h_ab5c07622b824f8af32de8a7c6f6aaf53}{le\+\_\+sms\+Inbox1\+\_\+\+Open()} to open a message box for access.\hypertarget{c_sms_inbox_le_smsInbox_receiving}{}\subsubsection{Receiving a message}\label{c_sms_inbox_le_smsInbox_receiving}
To receive messages, register a handler function to obtain incoming messages. Use \hyperlink{le__sms_inbox1__interface_8h_ad1921790ff294865477be5508fc46f87}{le\+\_\+sms\+Inbox1\+\_\+\+Add\+Rx\+Message\+Handler()} to register that handler.

The handler must satisfy the following prototype\+: 
\begin{DoxyCode}
\textcolor{keyword}{typedef} void (*\hyperlink{le__sms_inbox1__interface_8h_a19b58278c1549e54f5af6ff2542c3458}{le\_smsInbox1\_RxMessageHandlerFunc\_t})
(
  uint32\_t msgId,
  \textcolor{keywordtype}{void}*    contextPtr
)
\end{DoxyCode}


If a succession of messages is received, a new Message reference is created for each, and the handler is called for each new message.

Uninstall the handler function by calling \hyperlink{le__sms_inbox1__interface_8h_a58587948e7bf5612bcb38164edfa4fee}{le\+\_\+sms\+Inbox1\+\_\+\+Remove\+Rx\+Message\+Handler()}.

\begin{DoxyNote}{Note}
\hyperlink{le__sms_inbox1__interface_8h_a58587948e7bf5612bcb38164edfa4fee}{le\+\_\+sms\+Inbox1\+\_\+\+Remove\+Rx\+Message\+Handler()} function does not delete the Message Object. The caller has to delete it with \hyperlink{le__sms_inbox1__interface_8h_a2a426505848863678403f5b14c2ce16c}{le\+\_\+sms\+Inbox1\+\_\+\+Delete\+Msg()}.
\end{DoxyNote}
Use the following A\+P\+Is to retrieve message information and data from the message object\+:
\begin{DoxyItemize}
\item \hyperlink{le__sms_inbox1__interface_8h_a47b7188457df57060544353824a722e5}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Imsi()} -\/ get the I\+M\+S\+I of the message receiver S\+I\+M if it applies.
\item \hyperlink{le__sms_inbox1__interface_8h_a7daf191029452574c2f73be31745ddd5}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Format()} -\/ determine if it is a binary or a text message.
\item \hyperlink{le__sms_inbox1__interface_8h_a526785c35a6dcaabaff01b3959b25eb4}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Sender\+Tel()} -\/ get the sender\textquotesingle{}s Telephone number.
\item \hyperlink{le__sms_inbox1__interface_8h_aea859f08a7d8115d4839a59ce1be987c}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Time\+Stamp()} -\/ get the timestamp sets by the Service Center.
\item \hyperlink{le__sms_inbox1__interface_8h_a99ac3b4b8d886a2c797c221a00f01bd6}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Msg\+Len()} -\/ get the message content length.
\item \hyperlink{le__sms_inbox1__interface_8h_aa35b73bd6e76889b4ab93e021e14c7a6}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Text()} -\/ get the message text.
\item \hyperlink{le__sms_inbox1__interface_8h_a74a7caad34f457e0c3fb5a741f5089ae}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Binary()} -\/ get the message binary content.
\item \hyperlink{le__sms_inbox1__interface_8h_ac1f8f65a60e406752394499ee3d60883}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Pdu()} -\/ get the P\+D\+U message content.
\end{DoxyItemize}

\begin{DoxyNote}{Note}
For incoming S\+M\+S Inbox, format returned by \hyperlink{le__sms_inbox1__interface_8h_a7daf191029452574c2f73be31745ddd5}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Format()} is never L\+E\+\_\+\+S\+M\+S\+I\+N\+B\+O\+X1\+\_\+\+F\+O\+R\+M\+A\+T\+\_\+\+P\+D\+U.
\end{DoxyNote}
\hypertarget{c_sms_inbox_le_smsInbox_listing}{}\subsubsection{Getting received messages}\label{c_sms_inbox_le_smsInbox_listing}
Call \hyperlink{le__sms_inbox1__interface_8h_ae63652bebbdb65a29212bb7d5636b025}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+First()} to get the first message from the inbox folder, and then call \hyperlink{le__sms_inbox1__interface_8h_a605986f7e80b0686841e9b3b5e9b2802}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Next()} to get the next message.

Call \hyperlink{le__sms_inbox1__interface_8h_a9f7be15b8e499a305efdcbed8a009255}{le\+\_\+sms\+Inbox1\+\_\+\+Is\+Unread()} to know whether the message has been read or not. The message is marked as \char`\"{}read\char`\"{} when one of those A\+P\+Is is called\+: \hyperlink{le__sms_inbox1__interface_8h_a47b7188457df57060544353824a722e5}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Imsi()}, \hyperlink{le__sms_inbox1__interface_8h_a7daf191029452574c2f73be31745ddd5}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Format()}, \hyperlink{le__sms_inbox1__interface_8h_a526785c35a6dcaabaff01b3959b25eb4}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Sender\+Tel()}, \hyperlink{le__sms_inbox1__interface_8h_aea859f08a7d8115d4839a59ce1be987c}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Time\+Stamp()}, \hyperlink{le__sms_inbox1__interface_8h_a99ac3b4b8d886a2c797c221a00f01bd6}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Msg\+Len()}, \hyperlink{le__sms_inbox1__interface_8h_aa35b73bd6e76889b4ab93e021e14c7a6}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Text()}, \hyperlink{le__sms_inbox1__interface_8h_a74a7caad34f457e0c3fb5a741f5089ae}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Binary()}, \hyperlink{le__sms_inbox1__interface_8h_ac1f8f65a60e406752394499ee3d60883}{le\+\_\+sms\+Inbox1\+\_\+\+Get\+Pdu()}.

To finish, you can also modify the received status of a message with \hyperlink{le__sms_inbox1__interface_8h_a19c1e0e3e27a2d44374a1774b582b1ff}{le\+\_\+sms\+Inbox1\+\_\+\+Mark\+Read()} and \hyperlink{le__sms_inbox1__interface_8h_a82ad6e7eb4ced962f6205acb87a8f62a}{le\+\_\+sms\+Inbox1\+\_\+\+Mark\+Unread()}.

\begin{DoxyNote}{Note}
The message status is tied to the client app.
\end{DoxyNote}
\hypertarget{c_sms_inbox_le_smsInbox1_deleting}{}\subsubsection{Deleting a message}\label{c_sms_inbox_le_smsInbox1_deleting}
\hyperlink{le__sms_inbox1__interface_8h_a2a426505848863678403f5b14c2ce16c}{le\+\_\+sms\+Inbox1\+\_\+\+Delete\+Msg()} deletes the message from the folder. Message is identified with le\+\_\+sms\+Inbox1\+\_\+\+Msg\+Ref\+\_\+t object. The function returns an error if the message is not found.\hypertarget{c_sms_inbox_le_smsInbox_end}{}\subsubsection{Close a message box}\label{c_sms_inbox_le_smsInbox_end}
Use the A\+P\+I \hyperlink{le__sms_inbox1__interface_8h_a2c3b0118016949b77df6bab31c3a986e}{le\+\_\+sms\+Inbox1\+\_\+\+Close()} to close a message box (the message box is still exist and can be re-\/opened and retrieve later all the messages).\hypertarget{c_sms_inbox_le_smsInbox_configdb}{}\subsubsection{Configuration tree}\label{c_sms_inbox_le_smsInbox_configdb}
The configuration database path for the S\+M\+S Inbox Service is\+: \begin{DoxyVerb}/
    smsInbox/
        apps/
            appA<uint> = <# of messages>
            appB<uint> = <# of messages>
\end{DoxyVerb}


Each app have its own inbox, containing its own list of messages. The maximum number of messages is specified for each inbox. If the message box is not configured, a default number of 10 messages is applied (only for message boxes configured in le\+\_\+sms\+Inbox\+\_\+mbox\+Name\mbox{[}\mbox{]} area).

The application name is given by the A\+P\+I name provided into the Components.\+cdef, both must be the same.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesSupervisor}{}\section{Supervisor}\label{legatoServicesSupervisor}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{legatoServicesSupervisorMonitoring}{Supervisor Monitoring} &Monitor and control apps &\PBS\centering  \\\cline{1-3}
\hyperlink{c_appInfo}{Application Information A\+P\+I} &Application information retrieval &\PBS\centering \\\cline{1-3}
\hyperlink{c_wdog}{Watchdog Service} &Kickable timeout &\PBS\centering  \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesSupervisorMonitoring}{}\subsection{Supervisor Monitoring}\label{legatoServicesSupervisorMonitoring}
Supervisor A\+P\+Is provide services to monitor and/or control apps. These A\+P\+Is are available\+:

\hyperlink{c_sup_ctrl}{Supervisor Control A\+P\+I} ~\newline
 \hyperlink{c_appInfo}{Application Information A\+P\+I} ~\newline


\begin{DoxyWarning}{Warning}
Beware of the security risks associated with granting an app access to these services. Apps that can control the state of other apps can seriously interfere with system operation. Sometimes, even knowledge about which apps are running can reveal a vulnerability.
\end{DoxyWarning}




Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_sup_ctrl}{}\subsubsection{Supervisor Control A\+P\+I}\label{c_sup_ctrl}
\hyperlink{le__sup__ctrl__interface_8h}{A\+P\+I Reference}

Supervisor A\+P\+I for controlling the framework and applications. This A\+P\+I is only available to privileged users.\hypertarget{c_sup_ctrl_legatoServicesSupervisor_binding}{}\paragraph{Binding}\label{c_sup_ctrl_legatoServicesSupervisor_binding}
You can use a definition {\ttfamily }.adef file to bind your client-\/side app and component to the server-\/side Supervisor Control service.

This code sample shows how to bind an app to this service\+: 
\begin{DoxyCode}
bindings
\{
myExe.myComp.le\_sup\_ctrl -> <root>.le\_sup\_ctrl
\}
\end{DoxyCode}


See \hyperlink{defFilesAdef}{Application Definition .adef} for details.\hypertarget{c_sup_ctrl_legatoServicesSupervisor_start}{}\paragraph{Start App}\label{c_sup_ctrl_legatoServicesSupervisor_start}
Use \hyperlink{le__sup__ctrl__interface_8h_a87aad682024480d38eaf889182703d61}{le\+\_\+sup\+\_\+ctrl\+\_\+\+Start\+App()} (const char $\ast$ app\+Name) to automatically start an app.

The code sample shows how to use the Supervisor Control service to start an app\+:


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} result = \hyperlink{le__sup__ctrl__interface_8h_a87aad682024480d38eaf889182703d61}{le\_sup\_ctrl\_StartApp}(\textcolor{stringliteral}{"myApp"});
\end{DoxyCode}


where {\ttfamily my\+App} is the name of the app.\hypertarget{c_sup_ctrl_legatoServicesSupervisor_stop}{}\paragraph{Stop App}\label{c_sup_ctrl_legatoServicesSupervisor_stop}
Use \hyperlink{le__sup__ctrl__interface_8h_a468918cc7037de4641666cfa948f7216}{le\+\_\+sup\+\_\+ctrl\+\_\+\+Stop\+App()} to automatically stop an app.

This code sample shows how to use the Supervisor Control service to stop an app, where app\+Aplication.\+app is your app\textquotesingle{}s actual name\+:


\begin{DoxyCode}
\hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86c}{le\_result\_t} result = \hyperlink{le__sup__ctrl__interface_8h_a468918cc7037de4641666cfa948f7216}{le\_sup\_ctrl\_StopApp}(\textcolor{stringliteral}{"myApp"});
\end{DoxyCode}


where {\ttfamily my\+App} is the name of the app.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_appInfo}{}\subsection{Application Information A\+P\+I}\label{c_appInfo}
\hyperlink{le__app_info__interface_8h}{A\+P\+I Reference}

This A\+P\+I provides information about applications.

All the functions in this A\+P\+I are provided by the {\bfseries Supervisor}.

Here\textquotesingle{}s a code sample binding to this service\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_appInfo -> <root>.le_appInfo
}
\end{DoxyVerb}






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_wdog}{}\subsection{Watchdog Service}\label{c_wdog}
\hyperlink{le__wdog__interface_8h}{A\+P\+I Reference}





Simple watchdog service.

Provides a kickable watchdog with a timeout that can be configured in {\ttfamily  .adef} or specified at run time. If a kick is not received within the specified time, the supervisor will be signalled to perform the action specified in Watchdog\+Action.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{legatoServicesUpdate}{}\section{Update}\label{legatoServicesUpdate}
\begin{TabularC}{3}
\hline
\rowcolor{lightgray}{\bf Service }&{\bf Description }&\PBS\centering {\bf multi-\/app safe  }\\\cline{1-3}
\hyperlink{c_le_instStat}{Install Status A\+P\+I} &App install/uninstall notification &\PBS\centering  \\\cline{1-3}
\hyperlink{c_fwupdate}{Modem Firmware Update} &Firmware image updates &\PBS\centering \\\cline{1-3}
\hyperlink{c_update}{Software Update} &Control app and firmware updates &\PBS\centering \\\cline{1-3}
\end{TabularC}
~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_instStat}{}\subsection{Install Status A\+P\+I}\label{c_le_instStat}
\hyperlink{le__inst_stat__interface_8h}{A\+P\+I Reference}

This A\+P\+I provides notifications when apps are installed and uninstalled.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_fwupdate}{}\subsection{Modem Firmware Update}\label{c_fwupdate}
\hyperlink{le__fwupdate__interface_8h}{A\+P\+I Reference}





Firmware update allows the various firmware images to be updated from the application processor. This may include the modem bootloader, modem firmware, and linux image, where the linux image consists of the linux bootloader, linux kernel, and linux rootfs.

Firmware update is useful when the image comes from an alternative source, rather than as an over-\/the-\/air update through the Air\+Vantage service.\hypertarget{c_fwupdate_le_fwupdate_binding}{}\subsubsection{I\+P\+C interfaces binding}\label{c_fwupdate_le_fwupdate_binding}
All the functions of this A\+P\+I are provided by the {\bfseries le\+\_\+fwupdate} service.

Here\textquotesingle{}s a code sample binding to the le\+\_\+fwupdate service\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_fwupdate -> fwupdateService.le_fwupdate
}
\end{DoxyVerb}
\hypertarget{c_fwupdate_le_fwupdate_image}{}\subsubsection{Update Firmware Image}\label{c_fwupdate_le_fwupdate_image}
The firmware update process is started by calling \hyperlink{le__fwupdate__interface_8h_ab68f3a7c5d4284306468e888bf6a8796}{le\+\_\+fwupdate\+\_\+\+Download()}. This function takes a file descriptor, rather than a file, to provide flexibility in the source of the image. In particular, this can be used to stream the image, rather than having to save it on the file system before doing the update.

If the image is successfully downloaded, a reset will occur in order to apply the update. This will reset all processors. After the application processor has restarted, the \hyperlink{c_info_le_info_version}{Query Firmware Version} A\+P\+Is can be used to determine whether the firmware has been updated to the new version.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_update}{}\subsection{Software Update}\label{c_update}
\hyperlink{le__update__interface_8h}{A\+P\+I Reference}





This A\+P\+I is used to control updates (install/remove) for the Legato application/firmware. Update package is combination of manifest and update data. Manifest contains metadata about the update task and all the update data are appended behind manifest. Update data means installation files (most likely tar ball), firmware files etc. Update package can be pictorially viewed as follows\+:


\begin{DoxyCode}
++++++++++++++++++++++
+                    +
+   Manifest         +
+                    +
+                    +
++++++++++++++++++++++
+                    +
+   Update\_data1     +
+                    +
+                    +
++++++++++++++++++++++
+                    +
+   Update\_data2     +
+                    +
+                    +
++++++++++++++++++++++
+                    +
+   Update\_data3     +
+                    +
+                    +
++++++++++++++++++++++
          .
          .
          .
          .
++++++++++++++++++++++
+                    +
+   Update\_dataN     +
+                    +
+                    +
++++++++++++++++++++++
\end{DoxyCode}


Update service provider follows the following state machine while doing an update\+: 
\begin{DoxyCode}
                      ------------------
            Create()  |                |            Delete()
            --------->|     NEW        |--------------------------------|
                      |                |                                |
                      ------------------                                |
                      Start() |                                         |
                              |                                         |
                              |                                         |
                              |                                         |
          |--------------     |                                         |
          |             |     |                                         |
 ALL\_ITEMS\_UNPACKED=NO  V     V                                         |
          |           ------------------                                |
          |           |                |   Delete()/Error*              |
          |           |   UNPACKING    |---------------------|          |
          ------------|                |                     |          |
                      ------------------                     V          V
                              |                          ------------------
                              |                          |                |
                      ALL\_ITEMS\_UNPACKED = YES           |      FAILED    |
                              |                          |                |
                              V                          ------------------
                      ------------------                          ^
                      |                |     Delete()/Error*      |
                |---->|    APPLYING    |--------------------------|
ALL\_ITEMS\_DONE = NO   |                |
                |     ------------------
                |         |    |
                |\_\_\_\_\_\_\_\_\_|    |
                          ALL\_ITEMS\_DONE = YES
                               |
                               V
                      ------------------
                      |                |
                      |    SUCCESS     |
                      |                |
                      ------------------
Error:  Any kind of error occurred during update.
\end{DoxyCode}
\hypertarget{c_update_API_Usage_Guideline}{}\subsubsection{A\+P\+I Usage Guideline}\label{c_update_API_Usage_Guideline}
This is the typical sequence of calling update A\+P\+I\+:


\begin{DoxyItemize}
\item \mbox{[}M\+A\+N\+D\+A\+T\+O\+R\+Y\mbox{]} Client will provide update file descriptor (where manifest string is prepended at the beginning) via \hyperlink{le__update__interface_8h_a10d047c2901fcd00c6f4b4785ba76284}{le\+\_\+update\+\_\+\+Create()} api. Update service provider returns a handle on success.
\item \mbox{[}O\+P\+T\+I\+O\+N\+A\+L\mbox{]} Client may register any callback function for status update. It\textquotesingle{}s highly recommended to register callback function as client can only know its requested update status via callback function.
\item \mbox{[}M\+A\+N\+D\+A\+T\+O\+R\+Y\mbox{]} Client can call \hyperlink{le__update__interface_8h_a7b300c8944da0fe9a919bc6bb14157dd}{le\+\_\+update\+\_\+\+Start()} to start update task. It\textquotesingle{}s an asynchronous A\+P\+I. It returns after the update process(reading/parsing manifest, calling appropriate installation or removal tool as per manifest command etc) has started, but doesn\textquotesingle{}t verify if it finished). Update service provider will notify the status of update task to client via callback function. If no callback is registered, the client won\textquotesingle{}t get any notification.
\item \mbox{[}O\+P\+T\+I\+O\+N\+A\+L\mbox{]} Client may call \hyperlink{le__update__interface_8h_a09df8a83ae1fe0b57d34f2afca7ec008}{le\+\_\+update\+\_\+\+Get\+Error\+Code()} to get the errors that lead update to failed state. \hyperlink{le__update__interface_8h_a09df8a83ae1fe0b57d34f2afca7ec008}{le\+\_\+update\+\_\+\+Get\+Error\+Code()} will return L\+E\+\_\+\+U\+P\+D\+A\+T\+E\+\_\+\+E\+R\+R\+\_\+\+N\+O\+N\+E if update is in other state.
\item \mbox{[}M\+A\+N\+D\+A\+T\+O\+R\+Y\mbox{]} Client needs to call \hyperlink{le__update__interface_8h_a64e880b8225cd80571c3f277bbc33137}{le\+\_\+update\+\_\+\+Delete()} to deallocate resources. If \hyperlink{le__update__interface_8h_a64e880b8225cd80571c3f277bbc33137}{le\+\_\+update\+\_\+\+Delete()} is called in the middle of an update, update service provider will stop the update and deallocate resources if safe, otherwise the update service provider will deallocate resources after the current update task is finished. If the manifest contains multiple update items, all of the subsequent update items are deleted as part of deletion process. If the client disconnects before deleting the update handle, the update will automatically be deleted, and if the update is still in progress, it may be cancelled.
\end{DoxyItemize}\hypertarget{c_update_update_example}{}\subsubsection{Sample Code}\label{c_update_update_example}
This code sample calls an update service provider A\+P\+I to perform an update\+:


\begin{DoxyCode}
\textcolor{keywordtype}{void} SoftwareUpdate
(
    \textcolor{keywordtype}{void}
)
\{
    \textcolor{keywordtype}{int} fd = 0;  \textcolor{comment}{// Update data coming via STDIN}

    \hyperlink{le__update__interface_8h_a70c1de2e80807cdac13cec80456cc929}{le\_update\_HandleRef\_t} Handle;

    \textcolor{comment}{// Create an update handle.}
    \textcolor{keywordflow}{if} ((Handle = \hyperlink{le__update__interface_8h_a10d047c2901fcd00c6f4b4785ba76284}{le\_update\_Create}(fd)) == NULL)
    \{
         perror(\textcolor{stringliteral}{"Update failure, exiting."});
         exit(EXIT\_FAILURE);
    \}

    \textcolor{comment}{// Register callback function.}
    \textcolor{keywordflow}{if} (\hyperlink{le__update__interface_8h_acc7319e6d8e02dd1e4e06d800d76c235}{le\_update\_AddProgressHandler}(Handle, UpdateProgressHandler, NULL) == 
      NULL)
    \{
         perror(\textcolor{stringliteral}{"Can't register status handler"});
         exit(EXIT\_FAILURE);
    \}

    \textcolor{comment}{// Start update process(asynchronous). Completion will be notified via callback function.}
    \textcolor{keywordflow}{if} (\hyperlink{le__update__interface_8h_a7b300c8944da0fe9a919bc6bb14157dd}{le\_update\_Start}(Handle) != \hyperlink{le__basics_8h_a1cca095ed6ebab24b57a636382a6c86ca5066a4bcec691c6b67843b8f79656422}{LE\_OK})
    \{
         perror(\textcolor{stringliteral}{"Can't start update task !"});
         exit(EXIT\_FAILURE);
    \}
\}


\textcolor{comment}{// Sample callback function implementation.}
\textcolor{keyword}{static} \textcolor{keywordtype}{void} UpdateProgressHandler
(
    \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672}{le\_update\_State\_t} updateState,   

    uint percentDone,                

    \textcolor{keywordtype}{void}* contextPtr                 
)
\{

    \textcolor{keywordflow}{switch}(updateState)
    \{
        \textcolor{keywordflow}{case} \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672a789b71810ab23da9ec3b7d373c16ae08}{LE\_UPDATE\_STATE\_NEW}:
            \textcolor{comment}{// New update. Print this information.}
            fprintf(stdout, \textcolor{stringliteral}{"New update started\(\backslash\)n"});
            \textcolor{keywordflow}{break};

        \textcolor{keywordflow}{case} \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672a01cdf8340b000eb108dd8d9a350147db}{LE\_UPDATE\_STATE\_UNPACKING}:
            fprintf(stdout, \textcolor{stringliteral}{"Unpacking: %d \(\backslash\)n"}, percentDone);
            \textcolor{keywordflow}{break};

        \textcolor{keywordflow}{case} \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672ae950e649ac258bc23ba0c315904bca77}{LE\_UPDATE\_STATE\_APPLYING}:
            fprintf(stdout, \textcolor{stringliteral}{"Applying: %d \(\backslash\)n"}, percentDone);
            \textcolor{keywordflow}{break};

        \textcolor{keywordflow}{case} \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672ae18d6a3b4f86d5cbfc693cb054d91845}{LE\_UPDATE\_STATE\_SUCCESS}:
            \textcolor{comment}{//Successful update(install/remove) task.}
            fprintf(stdout, \textcolor{stringliteral}{"\(\backslash\)nSUCCESS\(\backslash\)n"});
            \hyperlink{le__update__interface_8h_a64e880b8225cd80571c3f277bbc33137}{le\_update\_Delete}(Handle);
            exit(EXIT\_SUCCESS);

        \textcolor{keywordflow}{case} \hyperlink{le__update__interface_8h_ae9758536ebaf1842cdaaddd6cf95a672a67f0990e9adccbc2cda0ad78ab98d894}{LE\_UPDATE\_STATE\_FAILED}:
            \textcolor{comment}{// Failure in update, exit with failure code.}
            fprintf(stderr, \textcolor{stringliteral}{"\(\backslash\)nFAILED, ErrorCode: %d\(\backslash\)n"}, \hyperlink{le__update__interface_8h_a09df8a83ae1fe0b57d34f2afca7ec008}{le\_update\_GetErrorCode}(
      Handle));
            \hyperlink{le__update__interface_8h_a64e880b8225cd80571c3f277bbc33137}{le\_update\_Delete}(Handle);
            exit(EXIT\_FAILURE);
    \}

\}
\end{DoxyCode}


Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{c_le_voicecall}{}\section{Voice Call Service}\label{c_le_voicecall}
\hyperlink{le__voicecall__interface_8h}{A\+P\+I Reference}





A voice call is needed for applications that want to establish a voice communication with a remote party. The voice call can be over a mobile network, or over Vo\+I\+P.\hypertarget{c_le_voicecall_le_voicecall_binding}{}\subsection{I\+P\+C interfaces binding}\label{c_le_voicecall_le_voicecall_binding}
All the functions of this A\+P\+I are provided by the {\bfseries voice\+Call\+Service} application service.

Here\textquotesingle{}s a code sample binding to Voice Call services\+: \begin{DoxyVerb}bindings:
{
   clientExe.clientComponent.le_voicecall -> voiceCallService.le_voicecall
}
\end{DoxyVerb}
\hypertarget{c_le_voicecall_c_le_voicecall_outgoing}{}\subsection{Starting a Voice call}\label{c_le_voicecall_c_le_voicecall_outgoing}
A voice call can be started using \hyperlink{le__voicecall__interface_8h_aac588cbf58e2ea5655b89b9f6e2fd883}{le\+\_\+voicecall\+\_\+\+Start()} with the destination identifier passed as a parameter.

\begin{DoxyNote}{Note}
Available interfaces depend on used platform.
\end{DoxyNote}
Before the voice call is started, an application registers a state handler using \hyperlink{le__voicecall__interface_8h_a54875833715ef1f81d78d74cb86d0562}{le\+\_\+voicecall\+\_\+\+Add\+State\+Handler()}. Once the voice call is established, the handler will be called indicating it\textquotesingle{}s now connected. If the state of the voice call changes, then the handler will be called with the new state. To release a voice call, an application can use \hyperlink{le__voicecall__interface_8h_aa4758e37f80ef9fd410ef0a9731d3797}{le\+\_\+voicecall\+\_\+\+End()}. Application should use \hyperlink{le__voicecall__interface_8h_adb9eeb5c2e344f72b934dc8b72d3db62}{le\+\_\+voicecall\+\_\+\+Delete()} to release \hyperlink{le__voicecall__interface_8h_a74c8b6a9f13f7a8ef47b6b1d57d8ab56}{le\+\_\+voicecall\+\_\+\+Call\+Ref\+\_\+t} voice call reference object.

If a voice call is already started when le\+\_\+voicecall\+\_\+\+Start is called(), a new voice call will not be established. Instead, \hyperlink{le__voicecall__interface_8h_a51066eb84677e4d4c5447aaf8dd18ff1ad3c8824924d684995308a9e45af95422}{L\+E\+\_\+\+V\+O\+I\+C\+E\+C\+A\+L\+L\+\_\+\+E\+V\+E\+N\+T\+\_\+\+R\+E\+S\+O\+U\+R\+C\+E\+\_\+\+B\+U\+S\+Y} event will be sent. This event means call was not processed, while a \hyperlink{le__voicecall__interface_8h_a51066eb84677e4d4c5447aaf8dd18ff1a55cdfb321f8b09d5037edeb1ec6b04e6}{L\+E\+\_\+\+V\+O\+I\+C\+E\+C\+A\+L\+L\+\_\+\+E\+V\+E\+N\+T\+\_\+\+T\+E\+R\+M\+I\+N\+A\+T\+E\+D} event means that the call was not processed and then terminated or failed.

Once an application makes a voice call request, it should monitor the establishment state reported to the registered state handler.

Once the \hyperlink{le__voicecall__interface_8h_a51066eb84677e4d4c5447aaf8dd18ff1ad3cd30048fd3957b80293e876712e79b}{L\+E\+\_\+\+V\+O\+I\+C\+E\+C\+A\+L\+L\+\_\+\+E\+V\+E\+N\+T\+\_\+\+C\+O\+N\+N\+E\+C\+T\+E\+D} voice call event is received by the application, it must get the Rx and Tx audio streams with \hyperlink{le__voicecall__interface_8h_afd7256c9caa5a1cb8ccca588c7913797}{le\+\_\+voicecall\+\_\+\+Get\+Rx\+Audio\+Stream()} and \hyperlink{le__voicecall__interface_8h_ab2dc17c9f027ed291576a1b6f6b6fed1}{le\+\_\+voicecall\+\_\+\+Get\+Tx\+Audio\+Stream()} functions in order to set up the audio path. The audio path can be set up thanks to the audio A\+P\+I (cf. \hyperlink{c_audio}{Audio}).

If a \hyperlink{le__voicecall__interface_8h_a51066eb84677e4d4c5447aaf8dd18ff1a55cdfb321f8b09d5037edeb1ec6b04e6}{L\+E\+\_\+\+V\+O\+I\+C\+E\+C\+A\+L\+L\+\_\+\+E\+V\+E\+N\+T\+\_\+\+T\+E\+R\+M\+I\+N\+A\+T\+E\+D} event is received, application can get the termination reason by using \hyperlink{le__voicecall__interface_8h_a1e04e5a857e17e67eb75cd1c6136f163}{le\+\_\+voicecall\+\_\+\+Get\+Termination\+Reason()}.

\begin{DoxyNote}{Note}
The voice call use the mobile network. Vo\+I\+P is not yet supported.
\end{DoxyNote}
\hypertarget{c_le_voicecall_c_le_voicecall_incoming}{}\subsection{Answering a Voice call}\label{c_le_voicecall_c_le_voicecall_incoming}
An Incoming voice call will be notified by an \hyperlink{le__voicecall__interface_8h_a51066eb84677e4d4c5447aaf8dd18ff1abeff6317fd3fa13e2ad42e20da589dc6}{L\+E\+\_\+\+V\+O\+I\+C\+E\+C\+A\+L\+L\+\_\+\+E\+V\+E\+N\+T\+\_\+\+I\+N\+C\+O\+M\+I\+N\+G} event on state handler with a Call reference \hyperlink{le__voicecall__interface_8h_a74c8b6a9f13f7a8ef47b6b1d57d8ab56}{le\+\_\+voicecall\+\_\+\+Call\+Ref\+\_\+t()}.

Application can answer the call by using \hyperlink{le__voicecall__interface_8h_a9dc899a059b3881edb7da244b8c9fbef}{le\+\_\+voicecall\+\_\+\+Answer()} or reject the call by using \hyperlink{le__voicecall__interface_8h_aa4758e37f80ef9fd410ef0a9731d3797}{le\+\_\+voicecall\+\_\+\+End()} passing the call reference \hyperlink{le__voicecall__interface_8h_a74c8b6a9f13f7a8ef47b6b1d57d8ab56}{le\+\_\+voicecall\+\_\+\+Call\+Ref\+\_\+t}. Application should use \hyperlink{le__voicecall__interface_8h_adb9eeb5c2e344f72b934dc8b72d3db62}{le\+\_\+voicecall\+\_\+\+Delete()} to release \hyperlink{le__voicecall__interface_8h_a74c8b6a9f13f7a8ef47b6b1d57d8ab56}{le\+\_\+voicecall\+\_\+\+Call\+Ref\+\_\+t} voice call reference object.\hypertarget{c_le_voicecall_c_le_voicecall_options}{}\subsection{Voice call Options}\label{c_le_voicecall_c_le_voicecall_options}
\begin{DoxyNote}{Note}
Following functionality described in this section is not currently implemented; this description is provided to outline future functionality.
\end{DoxyNote}
Some applications may have voice call requirements that are not met by the default voice call (e.\+g., use a least cost voice call link or disable roaming on mobile networks). You can do this by\+:
\begin{DoxyItemize}
\item creating a request object using le\+\_\+voicecall\+\_\+\+Create\+Call(),
\item setting optional values on that request object using le\+\_\+voicecall\+\_\+\+Select\+Least\+Cost() or le\+\_\+voicecall\+\_\+\+Disable\+Roaming(),
\item and then submitting that object to a voice call connection request using le\+\_\+voicecall\+\_\+\+Submit\+Call()
\end{DoxyItemize}

\hyperlink{le__voicecall__interface_8h_a54875833715ef1f81d78d74cb86d0562}{le\+\_\+voicecall\+\_\+\+Add\+State\+Handler()} , \hyperlink{le__voicecall__interface_8h_aa4758e37f80ef9fd410ef0a9731d3797}{le\+\_\+voicecall\+\_\+\+End()} and \hyperlink{le__voicecall__interface_8h_adb9eeb5c2e344f72b934dc8b72d3db62}{le\+\_\+voicecall\+\_\+\+Delete()} A\+P\+Is can continue to be used, as described above.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. 