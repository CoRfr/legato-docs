This section contains details about known platform constraints and advanced info about Yocto and Legato.





\hyperlink{platformConstraints}{Platform Constraints} ~\newline
 \hyperlink{yoctoMain}{Yocto Info} ~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{platformConstraints}{}\section{Platform Constraints}\label{platformConstraints}
The A\+R755x, A\+R8652, and W\+P8548 platforms have the following limitations\+:

\hyperlink{platformConstraintsAudio}{Audio} ~\newline
 \hyperlink{platformConstraintsSecStorage}{Secure Storage}





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{platformConstraintsAudio}{}\subsection{Audio}\label{platformConstraintsAudio}
Audio functions are constrained by the following platform limitations for A\+R755x, A\+R8652, and W\+P8548.

This table lists possible audio connections\+:

\begin{TabularC}{7}
\hline
\rowcolor{lightgray}{\bf Input stream }&\PBS\centering {\bf Spkr }&\PBS\centering {\bf U\+S\+B Tx }&\PBS\centering {\bf P\+C\+M Tx }&\PBS\centering {\bf I2\+S Tx }&\PBS\centering {\bf Mdm Tx }&\PBS\centering {\bf Rec  }\\\cline{1-7}
Mic &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X($\ast$) &\PBS\centering X($\ast$) \\\cline{1-7}
U\+S\+B Rx &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering \\\cline{1-7}
P\+C\+M Rx &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering \\\cline{1-7}
I2\+S Rx &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X \\\cline{1-7}
Mdm Rx &\PBS\centering X($\ast$) &\PBS\centering X &\PBS\centering X &\PBS\centering X &\PBS\centering &\PBS\centering X \\\cline{1-7}
Pb &\PBS\centering X($\ast$) &\PBS\centering X &\PBS\centering X &\PBS\centering X &\PBS\centering X &\PBS\centering \\\cline{1-7}
\end{TabularC}
($\ast$) A\+R platform only

Pb = file playback ~\newline
 Rec = file recording

Only 1 point to 1 point connection is possible except for Pb and Rec. Pb and Rec can be added to any active 1 point to 1 point connections or simply tied to 1 single stream.

\begin{TabularC}{9}
\hline
\rowcolor{lightgray}{\bf Function \textbackslash{} I\+F }&\PBS\centering {\bf I2\+S }&\PBS\centering {\bf P\+C\+M }&\PBS\centering {\bf U\+S\+B }&\PBS\centering {\bf Analog (Mic / Spkr) }&\PBS\centering {\bf Mdm Tx }&\PBS\centering {\bf Mdm Rx }&\PBS\centering {\bf Pb }&\PBS\centering {\bf Rec  }\\\cline{1-9}
Gain (Set / Get) &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X($\ast$) &\PBS\centering X &\PBS\centering X &\PBS\centering X &\PBS\centering \\\cline{1-9}
Mute / Unmute &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X($\ast$) &\PBS\centering X &\PBS\centering X &\PBS\centering X &\PBS\centering \\\cline{1-9}
N\+S &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering &\PBS\centering &\PBS\centering \\\cline{1-9}
E\+C &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering &\PBS\centering &\PBS\centering \\\cline{1-9}
I\+I\+R &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering X &\PBS\centering &\PBS\centering \\\cline{1-9}
F\+I\+R &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering &\PBS\centering X &\PBS\centering X &\PBS\centering &\PBS\centering \\\cline{1-9}
A\+G\+C &\PBS\centering Only Tx &\PBS\centering Only Tx &\PBS\centering Only Tx &\PBS\centering Only Spkr($\ast$) &\PBS\centering X &\PBS\centering X &\PBS\centering &\PBS\centering \\\cline{1-9}
\end{TabularC}
($\ast$) A\+R platform only

N\+S = Noise Suppressor ~\newline
 E\+C = Echo Canceller ~\newline
 I\+I\+R = Infinite Impulse Response filter ~\newline
 F\+I\+R = Finite Impulse Response filter ~\newline
 A\+G\+C = Automatic Gain Control

{\bfseries Playback and recording}

File playback supports these file types\+:
\begin{DoxyItemize}
\item .wav
\item .amr
\item .awb
\end{DoxyItemize}

File recording is only supported for {\bfseries }.wav file types.

One single file playback and one single file recording can be activated simultaneously.

Continuous playback of one file doesn\textquotesingle{}t work well.

{\bfseries P\+C\+M insertion/extraction}

Only supports 16-\/bit sampling resolution on the A\+R7 platform.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{platformConstraintsSecStorage}{}\subsection{Secure Storage}\label{platformConstraintsSecStorage}
The A\+R755x, A\+R8652, and W\+P8548 platforms maximum space available for secure storage is 256 K\+B.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{yoctoMain}{}\section{Yocto Info}\label{yoctoMain}
This is advanced-\/level info about Legato and Yocto\+:

\hyperlink{yoctoLegato}{Yocto Legato Builds} ~\newline
 \hyperlink{yoctoInstallNotes}{Yocto Install Notes} ~\newline






Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{yoctoLegato}{}\subsection{Yocto Legato Builds}\label{yoctoLegato}
The Yocto Project is an open source collaboration project that provides templates, tools and methods to help you create custom Linux-\/based systems for embedded products regardless of the hardware architecture.

Legato is compatible with Yocto 1.\+6.\+1\hypertarget{yocto_legato_getstartedYoctoLinux_yoctoDirectories}{}\subsubsection{Yocto Linux Directories}\label{yocto_legato_getstartedYoctoLinux_yoctoDirectories}
Untar the file {\bfseries Legato-\/\+Dist-\/\+Source-\/mdm9x15-\/15.\+05.\+tar.\+bz2} to a directory\+: 
\begin{DoxyCode}
$ cd <some directory>
$ tar xvjf Legato-Linux-Dist-mdm9x15-15.05.tar.bz2
\end{DoxyCode}


These file/directories will be extracted\+:
\begin{DoxyItemize}
\item {\bfseries linux-\/yocto-\/3.\+4.\+git} -\/ Linux kernel -\/ 14.\+1.\+0.\+Beta.\+rc2
\item {\bfseries Legato-\/\+Yocto1\+\_\+6} -\/ Sierra Wireless specific layers
\item {\bfseries meta-\/swi} -\/ Hardware adaptations
\item {\bfseries meta-\/swi-\/extras} -\/ Build scripts and proprietary code
\end{DoxyItemize}

Yocto uses a layered model for its build system. In Legato, device-\/specific layers are {\ttfamily meta-\/swi-\/}\mbox{[}target\mbox{]} and {\ttfamily meta-\/swi-\/bin}.

Yocto 1.\+6.\+1 and poky environment documentation is available at \href{https://www.yoctoproject.org/documentation/archived?keys=&field_version_tid=45}{\tt Yocto docs}\hypertarget{yocto_legato_getstartedYoctoLinux_prebuiltYoctoImages}{}\subsubsection{Pre-\/built Yocto Image}\label{yocto_legato_getstartedYoctoLinux_prebuiltYoctoImages}
The prebuilt directory contains a kernel and root file system that can be built using the command below. It\textquotesingle{}s the same as what\textquotesingle{}s flashed on the device, and can be used to return to a known state.


\begin{DoxyItemize}
\item {\bfseries kernel} -\/ kernel image
\item {\bfseries rootfs} -\/ smallish root file system ready for basic development.
\end{DoxyItemize}

Instructions on how to flash these images to the device are given in the file R\+E\+A\+D\+M\+E.\+bsp.\hypertarget{yocto_legato_getstartedYoctoLinux_rebuildYoctoImages}{}\subsubsection{Rebuild Yocto Image}\label{yocto_legato_getstartedYoctoLinux_rebuildYoctoImages}
Instructions for rebuilding the image are contained in the file Legato-\/\+Yocto1\+\_\+6/meta-\/swi-\/extras/\+R\+E\+A\+D\+M\+E.\+build

Running the build script with no arguments will print out the help message. There is also a file called {\ttfamily stdbuild.\+sh} to build the images with common options. This can take a long time the first time you run it. Once the build is complete, you\textquotesingle{}ll find new images in the directory\+: 
\begin{DoxyCode}
../build/tmp/deploy/images 
\end{DoxyCode}


Links are created at the end of the build to point to the latest kernel (kernel) and root file system (rootfs) \begin{DoxyWarning}{Warning}
You canâ€™t rebuild Yocto images on Ubuntu 13.\+10.
\end{DoxyWarning}
\hypertarget{yocto_legato_getstartedYoctoLinux_flashYoctoImagesLin}{}\subsubsection{Linux Flash Yocto}\label{yocto_legato_getstartedYoctoLinux_flashYoctoImagesLin}
You can flash the Yocto images on Linux;, the device must be in {\itshape fastboot} mode. From the shell prompt on the device run\+: 
\begin{DoxyCode}
root@swi-mdm9x15:~# sys\_reboot bootloader 
\end{DoxyCode}


After a few seconds, the device will enumerate as an Android Bootloader Device. You can test this on the development P\+C with\+:


\begin{DoxyCode}
 dave@devpc$ fastboot devices
MDM9615
\end{DoxyCode}


Then erase and rewrite the kernel and root filesystem partitions using the fastboot command (the partitions are called kernel and rootfs)\+:


\begin{DoxyCode}
dave@devpc $ fastboot erase kernel
...
dave@devpc $ fastboot erase rootfs
...
dave@devpc $ fastboot flash kernel kernel
...
dave@devpc $ fastboot flash rootfs rootfs
...
dave@devpc $ fastboot reboot
rebooting...
finished. total time: 0.001s
\end{DoxyCode}


\begin{DoxyNote}{Note}
You have to use the micro-\/\+U\+S\+B connection for fastboot
\end{DoxyNote}
\hypertarget{yocto_legato_getstartedYoctoLinux_custYoctoImages}{}\subsubsection{Custom Yocto Image}\label{yocto_legato_getstartedYoctoLinux_custYoctoImages}
Because the Legato image is a Yocto-\/compliant B\+S\+P, there are many options for customizing.

Here\textquotesingle{}s the easy way to add some packages to the rootfs\+:


\begin{DoxyCode}
meta-swi-extras/meta-swi-bin/recipes/images/9615-cdp-sierra-image.inc 
\end{DoxyCode}


For more complex customizations, refer to the Yocto documentation.





Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. \hypertarget{yoctoInstallNotes}{}\subsection{Yocto Install Notes}\label{yoctoInstallNotes}
Here are some helpful tips for Yocto Linux working with Sierra Wireless devices.\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoNoPwd}{}\subsubsection{Log on Without Password}\label{yocto_install_notes_getstartedInstallNotes_yoctoNoPwd}
To log onto the target through the serial interface, log on as {\bfseries root} with no password. This allows manual changes to other interfaces (e.\+g., U\+S\+B if you want to run C\+D\+C-\/\+E\+C\+M).\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoCDC}{}\subsubsection{C\+D\+C-\/\+E\+C\+M for I\+P vs Ethernet}\label{yocto_install_notes_getstartedInstallNotes_yoctoCDC}
Using C\+D\+C-\/\+E\+C\+M for I\+P connections will cause the M\+A\+C address to change every reboot because the kernel allocates software-\/defined M\+A\+C addresses to interfaces. This may cause new connections to be detected by your host every time you reboot the device. See \hyperlink{getstartedConfigIP}{Configure I\+P Address} and \hyperlink{toolsTarget_setNet}{set\+Net}\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoPrefIP}{}\subsubsection{Setup Preferred I\+P}\label{yocto_install_notes_getstartedInstallNotes_yoctoPrefIP}
Either boot with an Ethernet cable plugged in and let the device obtain an I\+P address using D\+H\+C\+P, or enable C\+D\+C-\/\+E\+C\+M and the micro-\/\+U\+S\+B cable. You can then determine the I\+P address using {\ttfamily ifconfig} on the console or provide a fixed I\+P from your D\+H\+C\+P server. Then use {\ttfamily ssh} and {\ttfamily scp} to access the device and transfer files.\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoDefUSB}{}\subsubsection{Change Default U\+S\+B Classes}\label{yocto_install_notes_getstartedInstallNotes_yoctoDefUSB}
During the boot sequence, startup scripts run the file {\ttfamily /etc/legato/usbsetup} that enumerates the U\+S\+B types listed in {\ttfamily /etc/legato/usbmode}.

You can easily override default types by creating your own {\ttfamily usbmode} file in {\ttfamily /mnt/flash/startup/usb}. The new file will take precedence over the old one. By default, the device will enumerate an E\+C\+M port, an A\+C\+M port for A\+T commands and U\+S\+B audio.\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoStaticIP}{}\subsubsection{Setup Target Static I\+P}\label{yocto_install_notes_getstartedInstallNotes_yoctoStaticIP}
You can configure your target and development P\+C so it doesn\textquotesingle{}t prompt for a password, run\+: {\bfseries bin/configtargetssh} 

It\textquotesingle{}ll look like this\+: \begin{DoxyVerb}dave@devbox:~/legato$ bin/configtargetssh 192.168.1.2
Generating new key pair... --->>> LEAVE THE PASSPHRASE EMPTY <<<---
Generating public/private rsa key pair.
Enter passphrase (empty for no passphrase):
Enter same passphrase again:
Your identification has been saved in /home/dave/.ssh/id_rsa.legatoTarget.
Your public key has been saved in /home/dave/.ssh/id_rsa.legatoTarget.pub.
The key fingerprint is:
af:c5:e4:8c:7d:53:b4:a4:72:c8:67:f3:88:9c:3f:67 dave's key for Legato
target devices.
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|                 |
|              o  |
|         . . + . |
|        S = * o  |
|         X B =   |
|        . @ + .  |
|         o o..E  |
|        .   .+   |
+-----------------+
/home/dave/.ssh/known_hosts updated.
Original contents retained as /home/dave/.ssh/known_hosts.old
Connecting to the target...  (ENTER TARGET'S ROOT PASSWORD WHENEVER
PROMPTED FOR A PASSWORD)
(press ENTER if your target doesn't have a root password)
The authenticity of host '192.168.1.2 (192.168.1.2)' can't be established.
RSA key fingerprint is f2:2f:66:a5:14:20:bd:46:8f:a2:02:b3:99:6f:72:24.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.2' (RSA) to the list of known hosts.
root@192.168.1.2's password:
dave@devpc:~/legato$
\end{DoxyVerb}
\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoReadWrite}{}\subsubsection{Read/\+Write rootfs}\label{yocto_install_notes_getstartedInstallNotes_yoctoReadWrite}
It\textquotesingle{}s convenient right now to enable r/w to rootfs, but it will be moving to a read-\/only model soon. If you change the rootfs (e.\+g., in /etc, /lib, /bin), you may cripple your device and have to re-\/install your rootfs.\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoNoDown}{}\subsubsection{Disable New Package Download}\label{yocto_install_notes_getstartedInstallNotes_yoctoNoDown}
The Yocto build defaults to disable new package downloads.

Enable downloading new packages over the Internet, modify\+:

{\ttfamily $<$build-\/dir$>$/conf/local}.conf value {\ttfamily B\+B\+\_\+\+N\+O\+\_\+\+N\+E\+T\+W\+O\+R\+K} to \char`\"{}0\char`\"{} . The file is only present after a build has run once.\hypertarget{yocto_install_notes_yoctoBSPTestReport}{}\subsubsection{Setup using B\+S\+P\+Test\+Report.\+xls}\label{yocto_install_notes_yoctoBSPTestReport}
The {\ttfamily B\+S\+P\+Test\+Report.\+xls} spreadsheet is used for instructions and reports to help set up different B\+S\+P features to test. Start with the Contents sheet.\hypertarget{yocto_install_notes_getstartedInstallNotes_yoctoNFSRoot}{}\subsubsection{Use nfs root}\label{yocto_install_notes_getstartedInstallNotes_yoctoNFSRoot}
The file {\bfseries meta-\/swi/meta-\/swi-\/mdm9x15/conf/machine/qcom-\/mdm9615.\+conf} contains examples if you need to include a lot of extra packages in your rootfs or if you build the debug version. See R\+E\+A\+D\+M\+E.\+bsp for details. Remember to untar the generated rootfs to an exported file system. The file pointed to by the rootfs link contains the most recent root file system. Thereâ€™s more info available at \href{https://www.kernel.org/doc/Documentation/filesystems/nfs/nfsroot.txt}{\tt kernel docs}. 



Copyright (C) Sierra Wireless Inc. Use of this work is subject to license. 